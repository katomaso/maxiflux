var nt=Object.defineProperty;var lt=(n,e,t)=>e in n?nt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var m=(n,e,t)=>(lt(n,typeof e!="symbol"?e+"":e,t),t),st=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var Ne=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var Se=(n,e,t)=>(st(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function x(){}function rt(n){return n&&typeof n=="object"&&typeof n.then=="function"}function Qe(n){return n()}function ze(){return Object.create(null)}function K(n){n.forEach(Qe)}function it(n){return typeof n=="function"}function re(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function ot(n){return Object.keys(n).length===0}function ct(n,...e){if(n==null)return x;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Ae(n,e,t){n.$$.on_destroy.push(ct(e,t))}function a(n,e){n.appendChild(e)}function $(n,e,t){n.insertBefore(e,t||null)}function k(n){n.parentNode.removeChild(n)}function ut(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function f(n){return document.createElement(n)}function S(n){return document.createTextNode(n)}function C(){return S(" ")}function P(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function fe(n){return function(e){return e.preventDefault(),n.call(this,e)}}function at(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function v(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function ft(n){return Array.from(n.childNodes)}function ee(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function Q(n,e){n.value=e==null?"":e}function dt(n,e,t,l){t===null?n.style.removeProperty(e):n.style.setProperty(e,t,l?"important":"")}let de;function W(n){de=n}function Xe(){if(!de)throw new Error("Function called outside component initialization");return de}function je(n){Xe().$$.on_mount.push(n)}const ce=[],Ve=[],ve=[],Be=[],_t=Promise.resolve();let xe=!1;function ht(){xe||(xe=!0,_t.then(Me))}function Pe(n){ve.push(n)}const Ce=new Set;let ge=0;function Me(){const n=de;do{for(;ge<ce.length;){const e=ce[ge];ge++,W(e),pt(e.$$)}for(W(null),ce.length=0,ge=0;Ve.length;)Ve.pop()();for(let e=0;e<ve.length;e+=1){const t=ve[e];Ce.has(t)||(Ce.add(t),t())}ve.length=0}while(ce.length);for(;Be.length;)Be.pop()();xe=!1,Ce.clear(),W(n)}function pt(n){if(n.fragment!==null){n.update(),K(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Pe)}}const ke=new Set;let ne;function we(){ne={r:0,c:[],p:ne}}function ye(){ne.r||K(ne.c),ne=ne.p}function z(n,e){n&&n.i&&(ke.delete(n),n.i(e))}function F(n,e,t,l){if(n&&n.o){if(ke.has(n))return;ke.add(n),ne.c.push(()=>{ke.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function mt(n,e){const t=e.token={};function l(s,r,i,o){if(e.token!==t)return;e.resolved=o;let c=e.ctx;i!==void 0&&(c=c.slice(),c[i]=o);const u=s&&(e.current=s)(c);let _=!1;e.block&&(e.blocks?e.blocks.forEach((d,g)=>{g!==r&&d&&(we(),F(d,1,1,()=>{e.blocks[g]===d&&(e.blocks[g]=null)}),ye())}):e.block.d(1),u.c(),z(u,1),u.m(e.mount(),e.anchor),_=!0),e.block=u,e.blocks&&(e.blocks[r]=u),_&&Me()}if(rt(n)){const s=Xe();if(n.then(r=>{W(s),l(e.then,1,e.value,r),W(null)},r=>{if(W(s),l(e.catch,2,e.error,r),W(null),!e.hasCatch)throw r}),e.current!==e.pending)return l(e.pending,0),!0}else{if(e.current!==e.then)return l(e.then,1,e.value,n),!0;e.resolved=n}}function he(n){n&&n.c()}function ie(n,e,t,l){const{fragment:s,on_mount:r,on_destroy:i,after_update:o}=n.$$;s&&s.m(e,t),l||Pe(()=>{const c=r.map(Qe).filter(it);i?i.push(...c):K(c),n.$$.on_mount=[]}),o.forEach(Pe)}function oe(n,e){const t=n.$$;t.fragment!==null&&(K(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function gt(n,e){n.$$.dirty[0]===-1&&(ce.push(n),ht(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function pe(n,e,t,l,s,r,i,o=[-1]){const c=de;W(n);const u=n.$$={fragment:null,ctx:null,props:r,update:x,not_equal:s,bound:ze(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:ze(),dirty:o,skip_bound:!1,root:e.target||c.$$.root};i&&i(u.root);let _=!1;if(u.ctx=t?t(n,e.props||{},(d,g,...w)=>{const b=w.length?w[0]:g;return u.ctx&&s(u.ctx[d],u.ctx[d]=b)&&(!u.skip_bound&&u.bound[d]&&u.bound[d](b),_&&gt(n,d)),g}):[],u.update(),_=!0,K(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const d=ft(e.target);u.fragment&&u.fragment.l(d),d.forEach(k)}else u.fragment&&u.fragment.c();e.intro&&z(n.$$.fragment),ie(n,e.target,e.anchor,e.customElement),Me()}W(c)}class me{$destroy(){oe(this,1),this.$destroy=x}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const s=l.indexOf(t);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!ot(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const se=[];function De(n,e=x){let t;const l=new Set;function s(o){if(re(n,o)&&(n=o,t)){const c=!se.length;for(const u of l)u[1](),se.push(u,n);if(c){for(let u=0;u<se.length;u+=2)se[u][0](se[u+1]);se.length=0}}}function r(o){s(o(n))}function i(o,c=x){const u=[o,c];return l.add(u),l.size===1&&(t=e(s)||x),o(n),()=>{l.delete(u),l.size===0&&(t(),t=null)}}return{set:s,update:r,subscribe:i}}const le=De(""),Ie=De({}),Ee=De(""),qe=De({});let Oe;le.subscribe(n=>{Oe=n,console.log("router.page changed to ",Oe)});let $e;Ee.subscribe(n=>{$e=n,console.log("router.next changed to ",$e)});let Re;qe.subscribe(n=>{Re=n,console.log("router._next_params changed to ",Re)});function ue(n,e){if($e){Ee.set(null),qe.set(null),Ie.set(Re),le.set($e);return}Ie.set(e),le.set(n)}function bt(n,e){Ee.set(Oe),qe.set(e),le.set(n)}let te=n=>n!=null?n.replace('"','\\"').replace("'","\\'"):null;class vt extends Error{}class kt extends Error{}class $t{constructor(){m(this,"url");m(this,"username");m(this,"connected",!1);m(this,"offline",!1);m(this,"authorization");m(this,"get",e=>this.request(e,null,"GET"));m(this,"put",(e,t)=>this.request(e,t,"PUT"));m(this,"post",(e,t)=>this.request(e,t,"POST"));m(this,"delete",e=>this.request(e,null,"DELETE"));m(this,"discover",e=>this.post("/v1/discover",`{"url":"${e}"}`));m(this,"feeds",()=>this.get("/v1/feeds"));m(this,"get_feed",e=>this.get(`/v1/feeds/${e}`));m(this,"get_feed_icon",e=>this.get(`/v1/feeds/${e}/icon`));m(this,"create_feed",(e,t)=>{let l=`{"feed_url": "${e}"`;return t!==0&&(l+=', "category_id": ',l+=t),l+="}",this.post("/v1/feeds",l)});m(this,"update_feed",(e,t,l)=>{if(t=te(t),t==null&&l==null)return new Promise((r,i)=>i("No title or category specified"));let s="{";return t!=null&&(s+=`"title": "${te(t)}"`),l!=null&&(t!=null&&(s+=","),s+=`"category": {"id": ${l}}`),s+="}",this.put(`/v1/feeds/${e}`,s)});m(this,"refresh_feed",e=>this.put(`/v1/feeds/${e}/refresh`));m(this,"remove_feed",e=>this.delete(`/v1/feeds/${e}`));m(this,"get_feed_entry",(e,t)=>this.get(`/v1/feeds/${e}/entries/${t}`));m(this,"get_entry",e=>this.get(`/v1/entries/${e}`));m(this,"get_feed_entries",(e,t)=>{let l=[];t!=null&&(t.status!=null&&l.push(`status=${t.status}`),t.offset!=null&&l.push(`offset=${t.offset}`),t.limit!=null&&l.push(`limit=${t.limit}`),t.direction!=null&&l.push(`direction=${t.direction}`),t.order!=null&&l.push(`order=${t.order}`));let s=`/v1/feeds/${e}/entries`;return l.length>0&&(s+="?",s+=l.join("&")),this.get(s)});m(this,"get_entries",e=>{let t=[];e!=null&&(e.status!=null&&t.push(`status=${e.status}`),e.offset!=null&&t.push(`offset=${e.offset}`),e.limit!=null&&t.push(`limit=${e.limit}`),e.direction!=null&&t.push(`direction=${e.direction}`),e.order!=null&&t.push(`order=${e.order}`));let l="/v1/entries";return t.length>0&&(l+="?",l+=t.join("&")),this.get(l)});m(this,"update_entries",(e,t)=>this.put("/v1/entries",`{"entry_ids": [${e.join(",")}], "status": "${te(t)}"}`));m(this,"toggle_bookmark",e=>this.put(`/v1/entries/${e}/bookmark`));m(this,"categories",()=>this.get("/v1/categories"));m(this,"create_category",e=>this.post("/v1/categories",`{"title": "${te(e)}"}`));m(this,"update_category",(e,t)=>this.put(`/v1/categories/${e}`,`{"title": "${te(t)}"}`));m(this,"delete_category",e=>this.delete(`/v1/categories/${e}`));m(this,"ompl_export",()=>this.get("/v1/export"));m(this,"create_user",(e,t,l)=>this.post("/v1/users",`{"username":"${te(e)}", "password:": "${te(t)}", "is_admin": ${l}}`));m(this,"update_user",(e,t)=>this.put(`/v1/users/${e}`,t));m(this,"users",()=>this.get("/v1/users"));m(this,"get_user",e=>this.get(`/v1/users/${e}`));m(this,"get_me",()=>this.get(`/v1/users/${this.username}`));m(this,"delete_user",e=>this.delete(`/v1/users/${e}`))}async connect(e,t,l){return this.connected?!0:(this.url=e,this.username=t,this.authorization=`Basic ${btoa(t+":"+l)}`,this.connected=await this.get_me().then(s=>s!=null),this.connected)}is_connected(){return this.connected}is_offline(){return this.offline}request(e,t=null,l="GET"){let s={method:l,headers:{Authorization:this.authorization}};return t!=null&&(typeof t=="object"&&(t=JSON.stringify(t)),s.body=t),fetch(new Request(this.url+e,s)).catch(r=>{throw this.offline=!0,new kt("you are offline")}).then(r=>{if(this.offline=!1,!r.ok)throw r.status==401?new vt("invalid credentials"):new Error(`${r.status}: ${r.statusText}`);return r.status==200||r.status==201?r.json():null})}}var X;(function(n){n.READ="read",n.UNREAD="unread",n.REMOVED="removed"})(X||(X={}));var Ge;(function(n){n.ID="id",n.STATUS="status",n.PUBLISHED_AT="published_at",n.CATEGORY_TITLE="category_title",n.CATEGORY_ID="category_id"})(Ge||(Ge={}));var Fe;(function(n){n.ASCENDING="asc",n.DESCENDING="desc"})(Fe||(Fe={}));var _e,Te;class wt{constructor(){Ne(this,_e);m(this,"miniflux");this.miniflux=new $t}async connect(e,t,l){return this.miniflux.connect(e,t,l)}get connected(){return this.miniflux.is_connected()}get offline(){return this.miniflux.is_offline()}mark_read(e){this.miniflux.update_entries([e],X.READ)}async query(e){return e.feed>0?this.miniflux.get_feed_entries(e.feed,Se(this,_e,Te).call(this,e)):this.miniflux.get_entries(Se(this,_e,Te).call(this,e))}async sync(e){let t=[],l=[];for(let s of e)s.status==X.READ&&t.push(s.id),s.status==X.REMOVED&&l.push(s.id);t.length>0&&await this.miniflux.update_entries(t,X.READ),l.length>0&&await this.miniflux.update_entries(l,X.REMOVED)}}_e=new WeakSet,Te=function(e){return{status:e.status,order:"published_at",direction:e.directionDesc?"desc":"asc",limit:100}};let ae=new wt;function Ue(n){let e,t,l;function s(o,c){return ae.offline?Dt:yt}let i=s()(n);return{c(){e=f("br"),t=f("em"),i.c(),l=f("br"),v(t,"class","error")},m(o,c){$(o,e,c),$(o,t,c),i.m(t,null),$(o,l,c)},p(o,c){i.p(o,c)},d(o){o&&k(e),o&&k(t),i.d(),o&&k(l)}}}function yt(n){let e;return{c(){e=S("Login failed")},m(t,l){$(t,e,l)},p:x,d(t){t&&k(e)}}}function Dt(n){let e,t,l,s;return{c(){e=S("You are offline "),t=f("button"),t.textContent="Go back"},m(r,i){$(r,e,i),$(r,t,i),l||(s=P(t,"click",n[10]),l=!0)},p:x,d(r){r&&k(e),r&&k(t),l=!1,s()}}}function Et(n){let e,t,l,s,r,i,o,c,u,_,d,g,w,b,D,R,G,A,T,j,V,N,y=n[4]&&Ue(n);return{c(){e=f("main"),t=f("form"),l=f("label"),l.textContent="Server",s=f("input"),r=f("br"),i=C(),o=f("label"),o.textContent="Username",c=f("input"),u=f("br"),_=C(),d=f("label"),d.textContent="Password",g=f("input"),w=f("br"),b=C(),y&&y.c(),D=C(),R=f("input"),G=C(),A=f("input"),T=S(`\xA0Zapamatovat heslo
        `),j=f("br"),v(l,"for","url"),v(l,"class","svelte-9inz0g"),v(s,"type","text"),v(s,"name","url"),v(o,"for","username"),v(o,"class","svelte-9inz0g"),v(c,"type","text"),v(c,"name","username"),v(d,"for","password"),v(d,"class","svelte-9inz0g"),v(g,"type","password"),v(g,"name","password"),v(R,"type","submit"),R.value="Connect",v(A,"type","checkbox"),v(A,"name","remember"),v(t,"method","POST")},m(E,M){$(E,e,M),a(e,t),a(t,l),a(t,s),Q(s,n[0]),a(t,r),a(t,i),a(t,o),a(t,c),Q(c,n[1]),a(t,u),a(t,_),a(t,d),a(t,g),Q(g,n[2]),a(t,w),a(t,b),y&&y.m(t,null),a(t,D),a(t,R),a(t,G),a(t,A),Q(A,n[3]),a(t,T),a(t,j),V||(N=[P(s,"input",n[7]),P(c,"input",n[8]),P(g,"input",n[9]),P(R,"click",at(fe(n[6]))),P(A,"change",n[11]),P(t,"submit",fe(n[6]))],V=!0)},p(E,[M]){M&1&&s.value!==E[0]&&Q(s,E[0]),M&2&&c.value!==E[1]&&Q(c,E[1]),M&4&&g.value!==E[2]&&Q(g,E[2]),E[4]?y?y.p(E,M):(y=Ue(E),y.c(),y.m(t,D)):y&&(y.d(1),y=null),M&8&&Q(A,E[3])},i:x,o:x,d(E){E&&k(e),y&&y.d(),V=!1,K(N)}}}function St(n,e,t){let l;Ae(n,Ee,D=>t(5,l=D));let s=localStorage.getItem("login_url")||"https://",r=localStorage.getItem("login_username"),i="",o=localStorage.getItem("login_remember")=="yes",c=null;async function u(D){if(s.startsWith("https://")||t(0,s="https://"+s),i==""&&(t(2,i=localStorage.getItem("login_password")),i==""))return;if(await ae.connect(s,r,i))return console.log("Successfuly logged in"),localStorage.setItem("login_last",new Date().toISOString()),localStorage.setItem("login_url",s),localStorage.setItem("login_username",r),o?(localStorage.setItem("login_remember","yes"),localStorage.setItem("login_password",i)):localStorage.setItem("login_remember","no"),le.set(l||"Articles");t(4,c=!0)}o&&je(u);function _(){s=this.value,t(0,s)}function d(){r=this.value,t(1,r)}function g(){i=this.value,t(2,i)}const w=()=>le.set(l||"Articles");function b(){o=this.value,t(3,o)}return[s,r,i,o,c,l,u,_,d,g,w,b]}class Ct extends me{constructor(e){super(),pe(this,e,St,Et,re,{})}}function Ye(n){return new Promise((e,t)=>{n.onsuccess=()=>{console.log("PromiseResult resolved: ",n.result),e(n.result)}})}class At{constructor(e){m(this,"dbPromise");m(this,"db",null);m(this,"status","unread");m(this,"index","status-age");m(this,"indexes",["status-age","feed-age"]);this.dbPromise=new Promise((t,l)=>{const s=indexedDB.open(e,1);s.onerror=r=>{},s.onupgradeneeded=r=>{const i=r.target.result,o=i.createObjectStore("articles",{keyPath:"id"});o.createIndex("status-age",["status","published_at"],{unique:!1}),o.createIndex("feed-age",["feed_id","published_at"],{unique:!1}),i.createObjectStore("feeds",{keyPath:"id"})},s.onsuccess=function(r){t(r.target.result),console.log(`Cache ${e} ready`)}})}async connect(){return this.dbPromise.then(e=>{this.db=e})}async query(e){return this.dbPromise.then(t=>{const l=t.transaction(["articles"]).objectStore("articles");let s="status-age",r=IDBKeyRange.bound([e.status,new Date(0)],[e.status,new Date]);return e.feed>0&&(s="feed-age",r=IDBKeyRange.bound([e.feed,new Date(0)],[e.feed,new Date])),new Promise((i,o)=>{let c=[];l.index(s).openCursor(r,e.directionDesc?"prev":"next").onsuccess=u=>{const _=u.target.result;_?(c.push(_.value),_.continue()):i(c)}})})}async get_entry(e){return Ye(this.db.transaction(["articles"]).objectStore("articles").get(e))}async mark(e,t){if(t!="READ"&&t!="REMOVED")throw new Error("Must be READ or REMOVED");return this.dbPromise.then(l=>{const s=l.transaction(["articles"],"readwrite").objectStore("articles"),r=s.get(e);return console.log(`Marking article ${e} as ${t}`),new Promise((i,o)=>{r.onsuccess=()=>{let c=r.result;c.status=X[t];let u=s.put(c);u.onsuccess=()=>{i()}}})})}async entries(){return this.dbPromise.then(e=>{const l=e.transaction(["articles"]).objectStore("articles").getAll();return new Promise((s,r)=>{l.onsuccess=()=>{s(l.result)}})})}async feeds(){return Ye(this.db.transaction(["feeds"]).objectStore("feeds").getAll())}async next_article(e,t){const l=await this.query(t);let s=!1;for(const r of l.entries){if(s)return r;s=r.id==e.id}return l.entries.at(-1)}async clear(){const t=(await this.dbPromise).transaction(["articles"],"readwrite").objectStore("articles");return new Promise((l,s)=>{t.clear().onsuccess=l,localStorage.removeItem("cache_updated"),console.log("Cache cleared")})}async update(e){const l=(await this.dbPromise).transaction(["articles"],"readwrite").objectStore("articles");console.log("Cache updated");function s(r){let i=r[0];for(let o=1;o<r.length;o++)r[o]>i&&(i=r[o]);return i}return e.map(r=>new Promise((i,o)=>{r.published_at=new Date(r.published_at),r.changed_at=s([new Date(r.published_at),new Date(r.changed_at),new Date(r.created_at),new Date(r.modified)]),l.add(r).onsuccess=()=>{localStorage.setItem("cache_updated",new Date().toISOString()),i()}}))}get age(){return localStorage.getItem("cache_updated")==null?null:new Date(localStorage.getItem("cache_updated"))}}const O=new At("maxiflux");class xt{constructor(){m(this,"_status","unread");m(this,"_feed",0);m(this,"_desc",!0)}setDirectionDesc(){this._desc=!0}setDirectionAsc(){this._desc=!1}setStatus(e){this._status=e}setFeed(e){this._feed=e}get feed(){return this._feed}get status(){return this._status}get directionDesc(){return this._desc}}let H=new xt;function Pt(n){let e,t,l,s,r,i,o;return{c(){e=f("main"),t=f("div"),l=f("button"),l.textContent="\u25B2",s=C(),r=f("button"),r.textContent="\u25BC",v(l,"class","svelte-118eg67"),v(r,"class","svelte-118eg67"),v(t,"class","svelte-118eg67")},m(c,u){$(c,e,u),a(e,t),a(t,l),a(t,s),a(t,r),i||(o=[P(l,"click",fe(n[0])),P(r,"click",fe(n[1]))],i=!0)},p:x,i:x,o:x,d(c){c&&k(e),i=!1,K(o)}}}function He(n="up"){let e=Math.round(window.window.visualViewport.height*.9);n=="up"?window.scroll(0,window.scrollY-e):window.scroll(0,window.scrollY+e)}function It(n){return[()=>He("up"),()=>He("down")]}class et extends me{constructor(e){super(),pe(this,e,It,Pt,re,{})}}function Ke(n,e,t){const l=n.slice();return l[11]=e[t],l}function Ot(n){let e,t;function l(i,o){return tt(O.age)>0?Tt:Rt}let r=l()(n);return{c(){e=S("Last sync: "),r.c(),t=S(" ago |")},m(i,o){$(i,e,o),r.m(i,o),$(i,t,o)},p(i,o){r.p(i,o)},d(i){i&&k(e),r.d(i),i&&k(t)}}}function Rt(n){let e;return{c(){e=S("a moment")},m(t,l){$(t,e,l)},p:x,d(t){t&&k(e)}}}function Tt(n){let e=tt(O.age)+"",t,l;return{c(){t=S(e),l=S(" days")},m(s,r){$(s,t,r),$(s,l,r)},p:x,d(s){s&&k(t),s&&k(l)}}}function Je(n){let e,t,l,s,r=n[0].length+"",i,o,c,u,_,d,g,w,b,D,R,G,A,T,j,V,N,y,E,M,I,q,Z,Y;e=new et({});let B={ctx:n,current:null,token:null,hasCatch:!1,pending:qt,then:Mt,catch:jt,value:14};mt(O.feeds(),B);let J=n[0],p=[];for(let h=0;h<J.length;h+=1)p[h]=We(Ke(n,J,h));return{c(){he(e.$$.fragment),t=C(),l=f("h1"),s=S("Articles ("),i=S(r),o=S(")"),c=C(),u=f("nav"),_=f("span"),d=f("button"),d.textContent="Read",g=S(`
            /
            `),w=f("button"),w.textContent="Unread",b=C(),D=f("span"),R=f("label"),R.textContent="Sort:",G=C(),A=f("select"),T=f("option"),T.textContent="Latest",j=f("option"),j.textContent="Oldest",V=S(`
            \xA0
            `),N=f("label"),N.textContent="Feed:",y=C(),E=f("select"),B.block.c(),M=C(),I=f("ul");for(let h=0;h<p.length;h+=1)p[h].c();v(R,"for","sort"),T.__value="latest",T.value=T.__value,j.__value="oldest",j.value=j.__value,v(A,"name","sort"),v(N,"for","sort"),v(E,"name","feed"),v(u,"class","svelte-dv9cn0"),v(I,"class","svelte-dv9cn0")},m(h,U){ie(e,h,U),$(h,t,U),$(h,l,U),a(l,s),a(l,i),a(l,o),$(h,c,U),$(h,u,U),a(u,_),a(_,d),a(_,g),a(_,w),a(u,b),a(u,D),a(D,R),a(D,G),a(D,A),a(A,T),a(A,j),a(D,V),a(D,N),a(D,y),a(D,E),B.block.m(E,B.anchor=null),B.mount=()=>E,B.anchor=null,$(h,M,U),$(h,I,U);for(let L=0;L<p.length;L+=1)p[L].m(I,null);q=!0,Z||(Y=[P(d,"click",n[4]),P(w,"click",n[5]),P(A,"change",n[6]),P(E,"change",n[7])],Z=!0)},p(h,U){if(n=h,(!q||U&1)&&r!==(r=n[0].length+"")&&ee(i,r),U&1){J=n[0];let L;for(L=0;L<J.length;L+=1){const Le=Ke(n,J,L);p[L]?p[L].p(Le,U):(p[L]=We(Le),p[L].c(),p[L].m(I,null))}for(;L<p.length;L+=1)p[L].d(1);p.length=J.length}},i(h){q||(z(e.$$.fragment,h),q=!0)},o(h){F(e.$$.fragment,h),q=!1},d(h){oe(e,h),h&&k(t),h&&k(l),h&&k(c),h&&k(u),B.block.d(),B.token=null,B=null,h&&k(M),h&&k(I),ut(p,h),Z=!1,K(Y)}}}function jt(n){return{c:x,m:x,d:x}}function Mt(n){let e;return{c(){e=f("option"),e.textContent="TODO",e.__value="1",e.value=e.__value},m(t,l){$(t,e,l)},d(t){t&&k(e)}}}function qt(n){return{c:x,m:x,d:x}}function We(n){let e,t,l,s,r,i=n[11].title+"",o,c,u,_,d=n[11].feed.title+"",g,w,b,D=be(n[11].published_at)+"",R,G,A=be(n[11].changed_at)+"",T,j,V,N,y;function E(...I){return n[8](n[11],...I)}function M(...I){return n[9](n[11],...I)}return{c(){e=f("li"),t=f("button"),t.textContent="x",l=C(),s=f("a"),r=f("h2"),o=S(i),c=C(),u=f("em"),_=S("From "),g=S(d),w=S(" published "),b=f("date"),R=S(D),G=S(", changed: "),T=S(A),V=C(),v(t,"class","close svelte-dv9cn0"),v(r,"class","svelte-dv9cn0"),v(u,"class","svelte-dv9cn0"),v(s,"href",j="article/"+n[11].id),v(s,"class","svelte-dv9cn0"),v(e,"class","svelte-dv9cn0")},m(I,q){$(I,e,q),a(e,t),a(e,l),a(e,s),a(s,r),a(r,o),a(s,c),a(s,u),a(u,_),a(u,g),a(u,w),a(u,b),a(b,R),a(b,G),a(b,T),a(e,V),N||(y=[P(t,"click",E),P(s,"click",fe(M))],N=!0)},p(I,q){n=I,q&1&&i!==(i=n[11].title+"")&&ee(o,i),q&1&&d!==(d=n[11].feed.title+"")&&ee(g,d),q&1&&D!==(D=be(n[11].published_at)+"")&&ee(R,D),q&1&&A!==(A=be(n[11].changed_at)+"")&&ee(T,A),q&1&&j!==(j="article/"+n[11].id)&&v(s,"href",j)},d(I){I&&k(e),N=!1,K(y)}}}function Lt(n){let e,t,l,s,r,i,o,c,u,_=O.age!=null&&Ot(n),d=n[0]&&Je(n);return{c(){e=f("main"),t=f("nav"),l=f("div"),_&&_.c(),s=C(),r=f("button"),r.textContent="\u{1F5D8}",i=C(),d&&d.c(),dt(t,"justify-content","flex-end"),v(t,"class","svelte-dv9cn0")},m(g,w){$(g,e,w),a(e,t),a(t,l),_&&_.m(l,null),a(l,s),a(l,r),a(e,i),d&&d.m(e,null),o=!0,c||(u=P(r,"click",n[3]),c=!0)},p(g,[w]){O.age!=null&&_.p(g,w),g[0]?d?(d.p(g,w),w&1&&z(d,1)):(d=Je(g),d.c(),z(d,1),d.m(e,null)):d&&(we(),F(d,1,1,()=>{d=null}),ye())},i(g){o||(z(d),o=!0)},o(g){F(d),o=!1},d(g){g&&k(e),_&&_.d(),d&&d.d(),c=!1,u()}}}function tt(n){return Math.round((new Date().getTime()-n.getTime())/1e3/3600/24)}function be(n){return n.toLocaleDateString("en-GB",{month:"short",day:"numeric",year:"numeric"})}function Nt(n,e,t){let l=null,{force_sync:s=!1}=e;async function r(){if(!ae.connected){console.log("Client not connected - cannot download new data"),bt("Connect",{force_sync:!0});return}await ae.sync(await O.entries());let b=await ae.query(H);await O.clear(),await O.update(b.entries)}async function i(b=!1){(O.age==null||b||s)&&await r(),t(0,l=await O.query(H))}je(async()=>{await O.connect(),i()});const o=()=>{i(!0)},c=b=>{H.setStatus("read"),i()},u=b=>{H.setStatus("unread"),i()},_=b=>{b.target.value=="latest"?H.setDirectionDesc():H.setDirectionAsc(),i()},d=b=>{H.setFeed(parseInt(b.target.value)),i()},g=(b,D)=>{O.mark(b.id,"REMOVED"),D.currentTarget.parentElement.remove()},w=(b,D)=>ue("Article",{id:b.id});return n.$$set=b=>{"force_sync"in b&&t(2,s=b.force_sync)},[l,i,s,o,c,u,_,d,g,w]}class zt extends me{constructor(e){super(),pe(this,e,Nt,Lt,re,{force_sync:2})}}function Ze(n){let e,t,l,s,r,i,o,c,u,_,d=n[1].title+"",g,w,b=n[1].status+"",D,R,G,A,T=n[1].content+"",j,V,N,y,E,M,I,q,Z,Y,B,J;return e=new et({}),{c(){he(e.$$.fragment),t=C(),l=f("nav"),s=f("button"),s.textContent="\u{1F519} Articles",r=C(),i=f("button"),i.textContent="\u{1F44B} Delete",o=C(),c=f("button"),c.textContent="Next \u{1F8A5}",u=C(),_=f("h1"),g=S(d),w=S(" ("),D=S(b),R=S(")"),G=C(),A=f("article"),j=C(),V=f("br"),N=C(),y=f("nav"),E=f("button"),E.textContent="\u{1F519} Articles",M=C(),I=f("button"),I.textContent="\u{1F44B} Delete",q=C(),Z=f("button"),Z.textContent="Next \u{1F8A5}",v(l,"class","svelte-10vigfk"),v(y,"id","nav-bottom"),v(y,"class","svelte-10vigfk")},m(p,h){ie(e,p,h),$(p,t,h),$(p,l,h),a(l,s),a(l,r),a(l,i),a(l,o),a(l,c),$(p,u,h),$(p,_,h),a(_,g),a(_,w),a(_,D),a(_,R),$(p,G,h),$(p,A,h),A.innerHTML=T,$(p,j,h),$(p,V,h),$(p,N,h),$(p,y,h),a(y,E),a(y,M),a(y,I),a(y,q),a(y,Z),Y=!0,B||(J=[P(s,"click",n[3]),P(i,"click",n[4]),P(c,"click",n[5]),P(E,"click",n[6]),P(I,"click",n[7]),P(Z,"click",n[8])],B=!0)},p(p,h){(!Y||h&2)&&d!==(d=p[1].title+"")&&ee(g,d),(!Y||h&2)&&b!==(b=p[1].status+"")&&ee(D,b),(!Y||h&2)&&T!==(T=p[1].content+"")&&(A.innerHTML=T)},i(p){Y||(z(e.$$.fragment,p),Y=!0)},o(p){F(e.$$.fragment,p),Y=!1},d(p){oe(e,p),p&&k(t),p&&k(l),p&&k(u),p&&k(_),p&&k(G),p&&k(A),p&&k(j),p&&k(V),p&&k(N),p&&k(y),B=!1,K(J)}}}function Vt(n){let e,t,l=n[1]&&Ze(n);return{c(){e=f("main"),l&&l.c()},m(s,r){$(s,e,r),l&&l.m(e,null),t=!0},p(s,[r]){s[1]?l?(l.p(s,r),r&2&&z(l,1)):(l=Ze(s),l.c(),z(l,1),l.m(e,null)):l&&(we(),F(l,1,1,()=>{l=null}),ye())},i(s){t||(z(l),t=!0)},o(s){F(l),t=!1},d(s){s&&k(e),l&&l.d()}}}function Bt(n,e,t){let{id:l}=e,s=null;async function r(){t(1,s=await O.get_entry(l))}function i(w){window.scroll(0,0),t(1,s=w)}je(r);const o=()=>ue("Articles"),c=()=>{O.mark(l,"REMOVED"),ue("Articles")},u=()=>{O.next_article(s,H).then(i)},_=()=>{O.mark(s.id,"READ"),ue("Articles")},d=()=>{O.mark(s.id,"REMOVED"),O.next_article(s,H).then(i)},g=()=>{O.mark(s.id,"READ"),O.next_article(s,H).then(i)};return n.$$set=w=>{"id"in w&&t(0,l=w.id)},[l,s,i,o,c,u,_,d,g]}class Gt extends me{constructor(e){super(),pe(this,e,Bt,Vt,re,{id:0})}}function Ft(n){let e,t;return{c(){e=S("Unknown page "),t=S(n[0])},m(l,s){$(l,e,s),$(l,t,s)},p(l,s){s&1&&ee(t,l[0])},i:x,o:x,d(l){l&&k(e),l&&k(t)}}}function Ut(n){let e,t;return e=new zt({}),{c(){he(e.$$.fragment)},m(l,s){ie(e,l,s),t=!0},p:x,i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){F(e.$$.fragment,l),t=!1},d(l){oe(e,l)}}}function Yt(n){let e,t;return e=new Gt({props:{id:n[1].id}}),{c(){he(e.$$.fragment)},m(l,s){ie(e,l,s),t=!0},p(l,s){const r={};s&2&&(r.id=l[1].id),e.$set(r)},i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){F(e.$$.fragment,l),t=!1},d(l){oe(e,l)}}}function Ht(n){let e,t;return e=new Ct({}),{c(){he(e.$$.fragment)},m(l,s){ie(e,l,s),t=!0},p:x,i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){F(e.$$.fragment,l),t=!1},d(l){oe(e,l)}}}function Kt(n){let e,t,l,s;const r=[Ht,Yt,Ut,Ft],i=[];function o(c,u){return c[0]=="Connect"?0:c[0]=="Article"?1:c[0]=="Articles"?2:3}return t=o(n),l=i[t]=r[t](n),{c(){e=f("main"),l.c()},m(c,u){$(c,e,u),i[t].m(e,null),s=!0},p(c,[u]){let _=t;t=o(c),t===_?i[t].p(c,u):(we(),F(i[_],1,1,()=>{i[_]=null}),ye(),l=i[t],l?l.p(c,u):(l=i[t]=r[t](c),l.c()),z(l,1),l.m(e,null))},i(c){s||(z(l),s=!0)},o(c){F(l),s=!1},d(c){c&&k(e),i[t].d()}}}function Jt(n,e,t){let l,s;return Ae(n,le,r=>t(0,l=r)),Ae(n,Ie,r=>t(1,s=r)),ue("Articles"),[l,s]}class Wt extends me{constructor(e){super(),pe(this,e,Jt,Kt,re,{})}}new Wt({target:document.getElementById("app")});
