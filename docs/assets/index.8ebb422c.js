var _t=Object.defineProperty;var pt=(n,e,t)=>e in n?_t(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var b=(n,e,t)=>(pt(n,typeof e!="symbol"?e+"":e,t),t),ht=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var Be=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var Ge=(n,e,t)=>(ht(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function y(){}function mt(n){return n&&typeof n=="object"&&typeof n.then=="function"}function rt(n){return n()}function Fe(){return Object.create(null)}function Z(n){n.forEach(rt)}function bt(n){return typeof n=="function"}function oe(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function gt(n){return Object.keys(n).length===0}function kt(n,...e){if(n==null)return y;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Ie(n,e,t){n.$$.on_destroy.push(kt(e,t))}function a(n,e){n.appendChild(e)}function g(n,e,t){n.insertBefore(e,t||null)}function m(n){n.parentNode.removeChild(n)}function st(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function d(n){return document.createElement(n)}function $(n){return document.createTextNode(n)}function A(){return $(" ")}function it(){return $("")}function q(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function _e(n){return function(e){return e.preventDefault(),n.call(this,e)}}function vt(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function w(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function wt(n){return Array.from(n.childNodes)}function Y(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function ee(n,e){n.value=e==null?"":e}let pe;function Q(n){pe=n}function ot(){if(!pe)throw new Error("Function called outside component initialization");return pe}function je(n){ot().$$.on_mount.push(n)}const ae=[],Ue=[],ye=[],Ye=[],yt=Promise.resolve();let qe=!1;function $t(){qe||(qe=!0,yt.then(Me))}function Oe(n){ye.push(n)}const Ae=new Set;let ve=0;function Me(){const n=pe;do{for(;ve<ae.length;){const e=ae[ve];ve++,Q(e),Dt(e.$$)}for(Q(null),ae.length=0,ve=0;Ue.length;)Ue.pop()();for(let e=0;e<ye.length;e+=1){const t=ye[e];Ae.has(t)||(Ae.add(t),t())}ye.length=0}while(ae.length);for(;Ye.length;)Ye.pop()();qe=!1,Ae.clear(),Q(n)}function Dt(n){if(n.fragment!==null){n.update(),Z(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Oe)}}const $e=new Set;let le;function Ne(){le={r:0,c:[],p:le}}function Le(){le.r||Z(le.c),le=le.p}function G(n,e){n&&n.i&&($e.delete(n),n.i(e))}function W(n,e,t,l){if(n&&n.o){if($e.has(n))return;$e.add(n),le.c.push(()=>{$e.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function ct(n,e){const t=e.token={};function l(r,s,i,u){if(e.token!==t)return;e.resolved=u;let c=e.ctx;i!==void 0&&(c=c.slice(),c[i]=u);const o=r&&(e.current=r)(c);let p=!1;e.block&&(e.blocks?e.blocks.forEach((f,_)=>{_!==s&&f&&(Ne(),W(f,1,1,()=>{e.blocks[_]===f&&(e.blocks[_]=null)}),Le())}):e.block.d(1),o.c(),G(o,1),o.m(e.mount(),e.anchor),p=!0),e.block=o,e.blocks&&(e.blocks[s]=o),p&&Me()}if(mt(n)){const r=ot();if(n.then(s=>{Q(r),l(e.then,1,e.value,s),Q(null)},s=>{if(Q(r),l(e.catch,2,e.error,s),Q(null),!e.hasCatch)throw s}),e.current!==e.pending)return l(e.pending,0),!0}else{if(e.current!==e.then)return l(e.then,1,e.value,n),!0;e.resolved=n}}function ut(n,e,t){const l=e.slice(),{resolved:r}=n;n.current===n.then&&(l[n.value]=r),n.current===n.catch&&(l[n.error]=r),n.block.p(l,t)}function he(n){n&&n.c()}function ce(n,e,t,l){const{fragment:r,on_mount:s,on_destroy:i,after_update:u}=n.$$;r&&r.m(e,t),l||Oe(()=>{const c=s.map(rt).filter(bt);i?i.push(...c):Z(c),n.$$.on_mount=[]}),u.forEach(Oe)}function ue(n,e){const t=n.$$;t.fragment!==null&&(Z(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function St(n,e){n.$$.dirty[0]===-1&&(ae.push(n),$t(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function me(n,e,t,l,r,s,i,u=[-1]){const c=pe;Q(n);const o=n.$$={fragment:null,ctx:null,props:s,update:y,not_equal:r,bound:Fe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Fe(),dirty:u,skip_bound:!1,root:e.target||c.$$.root};i&&i(o.root);let p=!1;if(o.ctx=t?t(n,e.props||{},(f,_,...D)=>{const v=D.length?D[0]:_;return o.ctx&&r(o.ctx[f],o.ctx[f]=v)&&(!o.skip_bound&&o.bound[f]&&o.bound[f](v),p&&St(n,f)),_}):[],o.update(),p=!0,Z(o.before_update),o.fragment=l?l(o.ctx):!1,e.target){if(e.hydrate){const f=wt(e.target);o.fragment&&o.fragment.l(f),f.forEach(m)}else o.fragment&&o.fragment.c();e.intro&&G(n.$$.fragment),ce(n,e.target,e.anchor,e.customElement),Me()}Q(c)}class be{$destroy(){ue(this,1),this.$destroy=y}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const r=l.indexOf(t);r!==-1&&l.splice(r,1)}}$set(e){this.$$set&&!gt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ie=[];function Ee(n,e=y){let t;const l=new Set;function r(u){if(oe(n,u)&&(n=u,t)){const c=!ie.length;for(const o of l)o[1](),ie.push(o,n);if(c){for(let o=0;o<ie.length;o+=2)ie[o][0](ie[o+1]);ie.length=0}}}function s(u){r(u(n))}function i(u,c=y){const o=[u,c];return l.add(o),l.size===1&&(t=e(r)||y),u(n),()=>{l.delete(o),l.size===0&&(t(),t=null)}}return{set:r,update:s,subscribe:i}}const re=Ee(""),xe=Ee({}),Ce=Ee(""),ze=Ee({});let Re;re.subscribe(n=>{Re=n,console.log("router.page changed to ",Re)});let De;Ce.subscribe(n=>{De=n,console.log("router.next changed to ",De)});let Te;ze.subscribe(n=>{Te=n,console.log("router._next_params changed to ",Te)});function fe(n,e){if(De){Ce.set(null),ze.set(null),xe.set(Te),re.set(De);return}xe.set(e),re.set(n)}function Et(n,e){Ce.set(Re),ze.set(e),re.set(n)}let ne=n=>n!=null?n.replace('"','\\"').replace("'","\\'"):null;class Ct extends Error{}class At extends Error{}class Pt{constructor(){b(this,"url");b(this,"username");b(this,"connected",!1);b(this,"offline",!1);b(this,"authorization");b(this,"get",e=>this.request(e,null,"GET"));b(this,"put",(e,t)=>this.request(e,t,"PUT"));b(this,"post",(e,t)=>this.request(e,t,"POST"));b(this,"delete",e=>this.request(e,null,"DELETE"));b(this,"discover",e=>this.post("/v1/discover",`{"url":"${e}"}`));b(this,"feeds",()=>this.get("/v1/feeds"));b(this,"get_feed",e=>this.get(`/v1/feeds/${e}`));b(this,"get_feed_icon",e=>this.get(`/v1/feeds/${e}/icon`));b(this,"create_feed",(e,t)=>{let l=`{"feed_url": "${e}"`;return t!==0&&(l+=', "category_id": ',l+=t),l+="}",this.post("/v1/feeds",l)});b(this,"update_feed",(e,t,l)=>{if(t=ne(t),t==null&&l==null)return new Promise((s,i)=>i("No title or category specified"));let r="{";return t!=null&&(r+=`"title": "${ne(t)}"`),l!=null&&(t!=null&&(r+=","),r+=`"category": {"id": ${l}}`),r+="}",this.put(`/v1/feeds/${e}`,r)});b(this,"refresh_feed",e=>this.put(`/v1/feeds/${e}/refresh`));b(this,"remove_feed",e=>this.delete(`/v1/feeds/${e}`));b(this,"get_feed_entry",(e,t)=>this.get(`/v1/feeds/${e}/entries/${t}`));b(this,"get_entry",e=>this.get(`/v1/entries/${e}`));b(this,"get_feed_entries",(e,t)=>{let l=[];t!=null&&(t.status!=null&&l.push(`status=${t.status}`),t.offset!=null&&l.push(`offset=${t.offset}`),t.limit!=null&&l.push(`limit=${t.limit}`),t.direction!=null&&l.push(`direction=${t.direction}`),t.order!=null&&l.push(`order=${t.order}`));let r=`/v1/feeds/${e}/entries`;return l.length>0&&(r+="?",r+=l.join("&")),this.get(r)});b(this,"get_entries",e=>{let t=[];e!=null&&(e.status!=null&&t.push(`status=${e.status}`),e.offset!=null&&t.push(`offset=${e.offset}`),e.limit!=null&&t.push(`limit=${e.limit}`),e.direction!=null&&t.push(`direction=${e.direction}`),e.order!=null&&t.push(`order=${e.order}`));let l="/v1/entries";return t.length>0&&(l+="?",l+=t.join("&")),this.get(l)});b(this,"update_entries",(e,t)=>this.put("/v1/entries",`{"entry_ids": [${e.join(",")}], "status": "${ne(t)}"}`));b(this,"toggle_bookmark",e=>this.put(`/v1/entries/${e}/bookmark`));b(this,"categories",()=>this.get("/v1/categories"));b(this,"create_category",e=>this.post("/v1/categories",`{"title": "${ne(e)}"}`));b(this,"update_category",(e,t)=>this.put(`/v1/categories/${e}`,`{"title": "${ne(t)}"}`));b(this,"delete_category",e=>this.delete(`/v1/categories/${e}`));b(this,"ompl_export",()=>this.get("/v1/export"));b(this,"create_user",(e,t,l)=>this.post("/v1/users",`{"username":"${ne(e)}", "password:": "${ne(t)}", "is_admin": ${l}}`));b(this,"update_user",(e,t)=>this.put(`/v1/users/${e}`,t));b(this,"users",()=>this.get("/v1/users"));b(this,"get_user",e=>this.get(`/v1/users/${e}`));b(this,"get_me",()=>this.get(`/v1/users/${this.username}`));b(this,"delete_user",e=>this.delete(`/v1/users/${e}`))}async connect(e,t,l){return this.connected?!0:(this.url=e,this.username=t,this.authorization=`Basic ${btoa(t+":"+l)}`,this.connected=await this.get_me().then(r=>r!=null),this.connected)}is_connected(){return this.connected}is_offline(){return this.offline}request(e,t=null,l="GET"){let r={method:l,headers:{Authorization:this.authorization}};return t!=null&&(typeof t=="object"&&(t=JSON.stringify(t)),r.body=t),fetch(new Request(this.url+e,r)).catch(s=>{throw this.offline=!0,new At("you are offline")}).then(s=>{if(this.offline=!1,!s.ok)throw s.status==401?new Ct("invalid credentials"):new Error(`${s.status}: ${s.statusText}`);return s.status==200||s.status==201?s.json():null})}}var te;(function(n){n.READ="read",n.UNREAD="unread",n.REMOVED="removed"})(te||(te={}));var He;(function(n){n.ID="id",n.STATUS="status",n.PUBLISHED_AT="published_at",n.CATEGORY_TITLE="category_title",n.CATEGORY_ID="category_id"})(He||(He={}));var Ke;(function(n){n.ASCENDING="asc",n.DESCENDING="desc"})(Ke||(Ke={}));var Se,at;class It{constructor(){Be(this,Se);b(this,"miniflux");this.miniflux=new Pt}async connect(e,t,l){return this.miniflux.connect(e,t,l)}get connected(){return this.miniflux.is_connected()}get offline(){return this.miniflux.is_offline()}mark_read(e){this.miniflux.update_entries([e],te.READ)}async query(e){return e.feed>0?this.miniflux.get_feed_entries(e.feed,{order:"published_at",direction:e.directionDesc?"desc":"asc",limit:100}):this.miniflux.get_entries(Ge(this,Se,at).call(this,e))}async sync(e){let t=[],l=[];for(let r of e)r.status==te.READ&&t.push(r.id),r.status==te.REMOVED&&l.push(r.id);t.length>0&&await this.miniflux.update_entries(t,te.READ),l.length>0&&await this.miniflux.update_entries(l,te.REMOVED)}async get_feeds(){return this.miniflux.feeds()}}Se=new WeakSet,at=function(e){return{status:e.status,order:"published_at",direction:e.directionDesc?"desc":"asc",limit:100}};let de=new It;function Je(n){let e,t,l;function r(u,c){return de.offline?Ot:qt}let i=r()(n);return{c(){e=d("br"),t=d("em"),i.c(),l=d("br"),w(t,"class","error")},m(u,c){g(u,e,c),g(u,t,c),i.m(t,null),g(u,l,c)},p(u,c){i.p(u,c)},d(u){u&&m(e),u&&m(t),i.d(),u&&m(l)}}}function qt(n){let e;return{c(){e=$("Login failed")},m(t,l){g(t,e,l)},p:y,d(t){t&&m(e)}}}function Ot(n){let e,t,l,r;return{c(){e=$("You are offline "),t=d("button"),t.textContent="Go back"},m(s,i){g(s,e,i),g(s,t,i),l||(r=q(t,"click",n[10]),l=!0)},p:y,d(s){s&&m(e),s&&m(t),l=!1,r()}}}function xt(n){let e,t,l,r,s,i,u,c,o,p,f,_,D,v,k,P,z,O,j,V,M,N,S=n[4]&&Je(n);return{c(){e=d("main"),t=d("form"),l=d("label"),l.textContent="Server",r=d("input"),s=d("br"),i=A(),u=d("label"),u.textContent="Username",c=d("input"),o=d("br"),p=A(),f=d("label"),f.textContent="Password",_=d("input"),D=d("br"),v=A(),S&&S.c(),k=A(),P=d("input"),z=A(),O=d("input"),j=$(`\xA0Zapamatovat heslo
        `),V=d("br"),w(l,"for","url"),w(l,"class","svelte-9inz0g"),w(r,"type","text"),w(r,"name","url"),w(u,"for","username"),w(u,"class","svelte-9inz0g"),w(c,"type","text"),w(c,"name","username"),w(f,"for","password"),w(f,"class","svelte-9inz0g"),w(_,"type","password"),w(_,"name","password"),w(P,"type","submit"),P.value="Connect",w(O,"type","checkbox"),w(O,"name","remember"),w(t,"method","POST")},m(C,E){g(C,e,E),a(e,t),a(t,l),a(t,r),ee(r,n[0]),a(t,s),a(t,i),a(t,u),a(t,c),ee(c,n[1]),a(t,o),a(t,p),a(t,f),a(t,_),ee(_,n[2]),a(t,D),a(t,v),S&&S.m(t,null),a(t,k),a(t,P),a(t,z),a(t,O),ee(O,n[3]),a(t,j),a(t,V),M||(N=[q(r,"input",n[7]),q(c,"input",n[8]),q(_,"input",n[9]),q(P,"click",vt(_e(n[6]))),q(O,"change",n[11]),q(t,"submit",_e(n[6]))],M=!0)},p(C,[E]){E&1&&r.value!==C[0]&&ee(r,C[0]),E&2&&c.value!==C[1]&&ee(c,C[1]),E&4&&_.value!==C[2]&&ee(_,C[2]),C[4]?S?S.p(C,E):(S=Je(C),S.c(),S.m(t,k)):S&&(S.d(1),S=null),E&8&&ee(O,C[3])},i:y,o:y,d(C){C&&m(e),S&&S.d(),M=!1,Z(N)}}}function Rt(n,e,t){let l;Ie(n,Ce,k=>t(5,l=k));let r=localStorage.getItem("login_url")||"https://",s=localStorage.getItem("login_username"),i="",u=localStorage.getItem("login_remember")=="yes",c=null;async function o(k){if(r.startsWith("https://")||t(0,r="https://"+r),i==""&&(t(2,i=localStorage.getItem("login_password")),i==""))return;if(await de.connect(r,s,i))return console.log("Successfuly logged in"),localStorage.setItem("login_last",new Date().toISOString()),localStorage.setItem("login_url",r),localStorage.setItem("login_username",s),u?(localStorage.setItem("login_remember","yes"),localStorage.setItem("login_password",i)):localStorage.setItem("login_remember","no"),re.set(l||"Articles");t(4,c=!0)}u&&je(o);function p(){r=this.value,t(0,r)}function f(){s=this.value,t(1,s)}function _(){i=this.value,t(2,i)}const D=()=>re.set(l||"Articles");function v(){u=this.value,t(3,u)}return[r,s,i,u,c,l,o,p,f,_,D,v]}class Tt extends be{constructor(e){super(),me(this,e,Rt,xt,oe,{})}}function Pe(n){return new Promise((e,t)=>{n.onsuccess=()=>{e(n.result)}})}class jt{constructor(e){b(this,"dbPromise");b(this,"db",null);b(this,"status","unread");b(this,"index","status-age");b(this,"indexes",["status-age","feed-age"]);this.dbPromise=new Promise((t,l)=>{const r=indexedDB.open(e,1);r.onerror=s=>{},r.onupgradeneeded=s=>{const i=s.target.result,u=i.createObjectStore("articles",{keyPath:"id"});i.createObjectStore("feeds",{keyPath:"id"}),u.createIndex("status-age",["status","published_at"],{unique:!1}),u.createIndex("feed-age",["feed_id","published_at"],{unique:!1}),u.createIndex("updated-age","updated_at",{unique:!1})},r.onsuccess=function(s){t(s.target.result),console.log(`Cache ${e} ready`)}})}async connect(){return this.dbPromise.then(e=>{this.db=e})}async query(e){return this.dbPromise.then(t=>{const l=t.transaction(["articles"]).objectStore("articles");let r="status-age",s=IDBKeyRange.bound([e.status,new Date(0)],[e.status,new Date]);return e.feed>0&&(r="feed-age",s=IDBKeyRange.bound([e.feed,new Date(0)],[e.feed,new Date])),new Promise((i,u)=>{let c=[];l.index(r).openCursor(s,e.directionDesc?"prev":"next").onsuccess=o=>{const p=o.target.result;p?(c.push(p.value),p.continue()):i(c)}})})}async get_entry(e){return Pe(this.db.transaction(["articles"]).objectStore("articles").get(e))}async mark(e,t){if(t!="READ"&&t!="REMOVED")throw new Error("Must be READ or REMOVED");return this.dbPromise.then(l=>{const r=l.transaction(["articles"],"readwrite").objectStore("articles"),s=r.get(e);return console.log(`Marking article ${e} as ${t}`),new Promise((i,u)=>{s.onsuccess=()=>{let c=s.result;c.status=te[t];let o=r.put(c);o.onsuccess=()=>{i()}}})})}async get_entries(){return this.dbPromise.then(e=>{const l=e.transaction(["articles"]).objectStore("articles").getAll();return new Promise((r,s)=>{l.onsuccess=()=>{r(l.result)}})})}async get_feeds(){return Pe(this.db.transaction(["feeds"]).objectStore("feeds").getAll())}async get_feed_categories(){let e=await this.get_feeds(),t={};for(let l of e)t[l.category.title]||(t[l.category.title]=[]),t[l.category.title].append(l);return t}async next_article(e,t){const l=await this.query(t);let r=!1;for(const s of l.entries){if(r)return s;r=s.id==e.id}return l.entries.at(-1)}async clear(){const t=(await this.dbPromise).transaction(["articles"],"readwrite").objectStore("articles");return new Promise((l,r)=>{t.clear().onsuccess=()=>{localStorage.removeItem("cache_updated"),console.log("Cache cleared")}})}async get_count(){return Pe(this.db.transaction(["articles"],"readwrite").objectStore("articles").count())}async update(e){const l=(await this.dbPromise).transaction(["articles"],"readwrite").objectStore("articles");console.log("Cache updating");function r(i){let u=i[0];for(let c=1;c<i.length;c++)i[c]>u&&(u=i[c]);return u}let s=new Date;return Promise.all(e.map(i=>new Promise((u,c)=>{i.published_at=new Date(i.published_at),i.changed_at=r([new Date(i.published_at),new Date(i.changed_at),new Date(i.created_at),new Date(i.modified)]),i.updated_at=s,l.add(i).onsuccess=()=>{u()}}))).then(i=>{console.log("Cache updated with",i.length,"records"),localStorage.setItem("cache_updated",s.toISOString())})}async update_feeds(e){const l=(await this.dbPromise).transaction(["feeds"],"readwrite").objectStore("feeds");return new Promise((r,s)=>{l.clear().onsuccess=r}).then(()=>Promise.all(e.map(r=>new Promise((s,i)=>{l.add(r).onsuccess=()=>{s()}})))).then(()=>localStorage.setItem("feeds_updated",new Date().toISOString()))}get age(){return localStorage.getItem("cache_updated")==null?null:new Date(localStorage.getItem("cache_updated"))}}const x=new jt("maxiflux");class Mt{constructor(){b(this,"_status","unread");b(this,"_feed",0);b(this,"_desc",!0)}setDirectionDesc(){this._desc=!0}setDirectionAsc(){this._desc=!1}setStatus(e){this._status=e}setFeed(e){this._feed=e}get feed(){return this._feed}get status(){return this._status}get directionDesc(){return this._desc}}let U=new Mt;function Nt(n){let e,t,l,r,s,i,u;return{c(){e=d("main"),t=d("div"),l=d("button"),l.textContent="\u25B2",r=A(),s=d("button"),s.textContent="\u25BC",w(l,"class","svelte-118eg67"),w(s,"class","svelte-118eg67"),w(t,"class","svelte-118eg67")},m(c,o){g(c,e,o),a(e,t),a(t,l),a(t,r),a(t,s),i||(u=[q(l,"click",_e(n[0])),q(s,"click",_e(n[1]))],i=!0)},p:y,i:y,o:y,d(c){c&&m(e),i=!1,Z(u)}}}function We(n="up"){let e=Math.round(window.window.visualViewport.height*.9);n=="up"?window.scroll(0,window.scrollY-e):window.scroll(0,window.scrollY+e)}function Lt(n){return[()=>We("up"),()=>We("down")]}class ft extends be{constructor(e){super(),me(this,e,Lt,Nt,oe,{})}}function Ze(n,e,t){const l=n.slice();return l[12]=e[t],l}function Qe(n,e,t){const l=n.slice();return l[16]=e[t],l}function zt(n){let e,t;function l(i,u){return dt(x.age)>0?Bt:Vt}let s=l()(n);return{c(){e=$("Last sync: "),s.c(),t=$(" ago |")},m(i,u){g(i,e,u),s.m(i,u),g(i,t,u)},p(i,u){s.p(i,u)},d(i){i&&m(e),s.d(i),i&&m(t)}}}function Vt(n){let e;return{c(){e=$("a moment")},m(t,l){g(t,e,l)},p:y,d(t){t&&m(e)}}}function Bt(n){let e=dt(x.age)+"",t,l;return{c(){t=$(e),l=$(" days")},m(r,s){g(r,t,s),g(r,l,s)},p:y,d(r){r&&m(t),r&&m(l)}}}function Xe(n){let e,t,l,r,s,i,u=n[1],c=[];for(let o=0;o<u.length;o+=1)c[o]=et(Qe(n,u,o));return{c(){e=d("label"),e.textContent="Feeds:",t=A(),l=d("select"),r=d("option"),r.textContent="All";for(let o=0;o<c.length;o+=1)c[o].c();w(e,"for","sort"),r.__value="0",r.value=r.__value,w(l,"name","feed"),w(l,"class","svelte-1qi545v")},m(o,p){g(o,e,p),g(o,t,p),g(o,l,p),a(l,r);for(let f=0;f<c.length;f+=1)c[f].m(l,null);s||(i=q(l,"change",n[5]),s=!0)},p(o,p){if(p&2){u=o[1];let f;for(f=0;f<u.length;f+=1){const _=Qe(o,u,f);c[f]?c[f].p(_,p):(c[f]=et(_),c[f].c(),c[f].m(l,null))}for(;f<c.length;f+=1)c[f].d(1);c.length=u.length}},d(o){o&&m(e),o&&m(t),o&&m(l),st(c,o),s=!1,i()}}}function Gt(n){let e,t=n[16].title+"",l,r;return{c(){e=d("option"),l=$(t),e.__value=r=n[16].id,e.value=e.__value},m(s,i){g(s,e,i),a(e,l)},p(s,i){i&2&&t!==(t=s[16].title+"")&&Y(l,t),i&2&&r!==(r=s[16].id)&&(e.__value=r,e.value=e.__value)},d(s){s&&m(e)}}}function Ft(n){let e,t=n[16].title+"",l,r;return{c(){e=d("option"),l=$(t),e.__value=r=n[16].id,e.value=e.__value,e.selected=!0},m(s,i){g(s,e,i),a(e,l)},p(s,i){i&2&&t!==(t=s[16].title+"")&&Y(l,t),i&2&&r!==(r=s[16].id)&&(e.__value=r,e.value=e.__value)},d(s){s&&m(e)}}}function et(n){let e;function t(s,i){return s[16].id==U.feed?Ft:Gt}let l=t(n),r=l(n);return{c(){r.c(),e=it()},m(s,i){r.m(s,i),g(s,e,i)},p(s,i){l===(l=t(s))&&r?r.p(s,i):(r.d(1),r=l(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&m(e)}}}function Ut(n){let e,t={ctx:n,current:null,token:null,hasCatch:!1,pending:Jt,then:Kt,catch:Ht,value:15};return ct(x.get_count(),t),{c(){e=it(),t.block.c()},m(l,r){g(l,e,r),t.block.m(l,t.anchor=r),t.mount=()=>e.parentNode,t.anchor=e},p(l,r){n=l,ut(t,n,r)},d(l){l&&m(e),t.block.d(l),t.token=null,t=null}}}function Yt(n){let e=n[0].length+"",t;return{c(){t=$(e)},m(l,r){g(l,t,r)},p(l,r){r&1&&e!==(e=l[0].length+"")&&Y(t,e)},d(l){l&&m(t)}}}function Ht(n){return{c:y,m:y,p:y,d:y}}function Kt(n){let e=n[15]+"",t;return{c(){t=$(e)},m(l,r){g(l,t,r)},p:y,d(l){l&&m(t)}}}function Jt(n){return{c:y,m:y,p:y,d:y}}function Wt(n){let e;return{c(){e=$("No data - please hit sync button")},m(t,l){g(t,e,l)},p:y,d(t){t&&m(e)}}}function Zt(n){let e,t,l=n[0].length+"",r,s,i,u,c,o={ctx:n,current:null,token:null,hasCatch:!1,pending:en,then:Xt,catch:Qt,value:15};ct(x.get_count(),o);let p=n[0],f=[];for(let _=0;_<p.length;_+=1)f[_]=nt(Ze(n,p,_));return{c(){e=d("em"),t=$("Showing "),r=$(l),s=$(" from "),o.block.c(),i=$(" cached records"),u=A(),c=d("ul");for(let _=0;_<f.length;_+=1)f[_].c();w(c,"class","svelte-1qi545v")},m(_,D){g(_,e,D),a(e,t),a(e,r),a(e,s),o.block.m(e,o.anchor=null),o.mount=()=>e,o.anchor=i,a(e,i),g(_,u,D),g(_,c,D);for(let v=0;v<f.length;v+=1)f[v].m(c,null)},p(_,D){if(n=_,D&1&&l!==(l=n[0].length+"")&&Y(r,l),ut(o,n,D),D&1){p=n[0];let v;for(v=0;v<p.length;v+=1){const k=Ze(n,p,v);f[v]?f[v].p(k,D):(f[v]=nt(k),f[v].c(),f[v].m(c,null))}for(;v<f.length;v+=1)f[v].d(1);f.length=p.length}},d(_){_&&m(e),o.block.d(),o.token=null,o=null,_&&m(u),_&&m(c),st(f,_)}}}function Qt(n){return{c:y,m:y,p:y,d:y}}function Xt(n){let e=n[15]+"",t;return{c(){t=$(e)},m(l,r){g(l,t,r)},p:y,d(l){l&&m(t)}}}function en(n){return{c:y,m:y,p:y,d:y}}function tt(n){let e;return{c(){e=$("\xA0(read)")},m(t,l){g(t,e,l)},d(t){t&&m(e)}}}function nt(n){let e,t,l,r,s,i=n[12].title+"",u,c,o,p,f=n[12].feed.title+"",_,D,v,k=we(n[12].published_at)+"",P,z,O=we(n[12].changed_at)+"",j,V,M,N,S;function C(...L){return n[9](n[12],...L)}let E=n[12].status=="read"&&tt();function B(...L){return n[10](n[12],...L)}return{c(){e=d("li"),t=d("button"),t.textContent="x",l=A(),r=d("a"),s=d("h2"),u=$(i),E&&E.c(),c=A(),o=d("em"),p=$("From "),_=$(f),D=$(" published "),v=d("date"),P=$(k),z=$(", changed: "),j=$(O),M=A(),w(t,"class","close svelte-1qi545v"),w(s,"class","svelte-1qi545v"),w(o,"class","svelte-1qi545v"),w(r,"href",V="article/"+n[12].id),w(r,"class","svelte-1qi545v"),w(e,"class","svelte-1qi545v")},m(L,T){g(L,e,T),a(e,t),a(e,l),a(e,r),a(r,s),a(s,u),E&&E.m(s,null),a(r,c),a(r,o),a(o,p),a(o,_),a(o,D),a(o,v),a(v,P),a(v,z),a(v,j),a(e,M),N||(S=[q(t,"click",C),q(r,"click",_e(B))],N=!0)},p(L,T){n=L,T&1&&i!==(i=n[12].title+"")&&Y(u,i),n[12].status=="read"?E||(E=tt(),E.c(),E.m(s,null)):E&&(E.d(1),E=null),T&1&&f!==(f=n[12].feed.title+"")&&Y(_,f),T&1&&k!==(k=we(n[12].published_at)+"")&&Y(P,k),T&1&&O!==(O=we(n[12].changed_at)+"")&&Y(j,O),T&1&&V!==(V="article/"+n[12].id)&&w(r,"href",V)},d(L){L&&m(e),E&&E.d(),N=!1,Z(S)}}}function tn(n){let e,t,l,r,s,i,u,c,o,p,f,_,D,v,k,P,z,O,j,V,M,N,S,C,E,B,L,T,F,se,H=x.age!=null&&zt(n),h=n[1]&&Xe(n);o=new ft({});function R(I,X){return I[0]?Yt:Ut}let ge=R(n),K=ge(n);function Ve(I,X){return I[0]?Zt:Wt}let ke=Ve(n),J=ke(n);return{c(){e=d("main"),t=d("nav"),l=d("span"),H&&H.c(),r=A(),s=d("button"),s.textContent="Sync \u2B73",i=A(),u=d("span"),h&&h.c(),c=A(),he(o.$$.fragment),p=A(),f=d("h1"),_=$("Articles ("),K.c(),D=$(")"),v=A(),k=d("nav"),P=d("span"),z=d("button"),z.textContent="Read",O=$(`
            /
            `),j=d("button"),j.textContent="Unread",V=A(),M=d("span"),N=d("label"),N.textContent="Sort:",S=A(),C=d("select"),E=d("option"),E.textContent="Latest",B=d("option"),B.textContent="Oldest",L=A(),J.c(),w(t,"class","svelte-1qi545v"),w(N,"for","sort"),E.__value="latest",E.value=E.__value,B.__value="oldest",B.value=B.__value,w(C,"name","sort"),w(C,"class","svelte-1qi545v"),w(k,"class","svelte-1qi545v")},m(I,X){g(I,e,X),a(e,t),a(t,l),H&&H.m(l,null),a(l,r),a(l,s),a(t,i),a(t,u),h&&h.m(u,null),a(e,c),ce(o,e,null),a(e,p),a(e,f),a(f,_),K.m(f,null),a(f,D),a(e,v),a(e,k),a(k,P),a(P,z),a(P,O),a(P,j),a(k,V),a(k,M),a(M,N),a(M,S),a(M,C),a(C,E),a(C,B),a(e,L),J.m(e,null),T=!0,F||(se=[q(s,"click",n[4]),q(z,"click",n[6]),q(j,"click",n[7]),q(C,"change",n[8])],F=!0)},p(I,[X]){x.age!=null&&H.p(I,X),I[1]?h?h.p(I,X):(h=Xe(I),h.c(),h.m(u,null)):h&&(h.d(1),h=null),ge===(ge=R(I))&&K?K.p(I,X):(K.d(1),K=ge(I),K&&(K.c(),K.m(f,D))),ke===(ke=Ve(I))&&J?J.p(I,X):(J.d(1),J=ke(I),J&&(J.c(),J.m(e,null)))},i(I){T||(G(o.$$.fragment,I),T=!0)},o(I){W(o.$$.fragment,I),T=!1},d(I){I&&m(e),H&&H.d(),h&&h.d(),ue(o),K.d(),J.d(),F=!1,Z(se)}}}function dt(n){return Math.round((new Date().getTime()-n.getTime())/1e3/3600/24)}function we(n){return n.toLocaleDateString("en-GB",{month:"short",day:"numeric",year:"numeric"})}function nn(n,e,t){let l=null,r=null,{force_sync:s=!1}=e;async function i(){if(!de.connected){console.log("Client not connected - redirecting to Connect"),Et("Connect",{force_sync:!0});return}let k=await x.get_entries();k&&await de.sync(k);let P=await de.query(U);return x.update(P.entries)}async function u(k=!1){(x.age==null||k||s)&&(t(3,s=!1),await i()),r||t(1,r=await x.get_feeds()),t(0,l=await x.query(U))}je(async()=>(await x.connect(),u()));const c=()=>{u(!0)},o=k=>{U.setFeed(parseInt(k.target.value)),u()},p=k=>{U.setStatus("read"),u()},f=k=>{U.setStatus("unread"),u()},_=k=>{k.target.value=="latest"?U.setDirectionDesc():U.setDirectionAsc(),u()},D=(k,P)=>{x.mark(k.id,"REMOVED"),P.currentTarget.parentElement.remove()},v=(k,P)=>fe("Article",{id:k.id});return n.$$set=k=>{"force_sync"in k&&t(3,s=k.force_sync)},[l,r,u,s,c,o,p,f,_,D,v]}class ln extends be{constructor(e){super(),me(this,e,nn,tn,oe,{force_sync:3})}}function lt(n){let e,t,l,r,s,i,u,c,o,p,f=n[1].title+"",_,D,v=n[1].status+"",k,P,z,O,j=n[1].content+"",V,M,N,S,C,E,B,L,T,F,se,H;return e=new ft({}),{c(){he(e.$$.fragment),t=A(),l=d("nav"),r=d("button"),r.textContent="\u{1F519} Articles",s=A(),i=d("button"),i.textContent="\u{1F44B} Delete",u=A(),c=d("button"),c.textContent="Next \u{1F8A5}",o=A(),p=d("h1"),_=$(f),D=$(" ("),k=$(v),P=$(")"),z=A(),O=d("article"),V=A(),M=d("br"),N=A(),S=d("nav"),C=d("button"),C.textContent="\u{1F519} Articles",E=A(),B=d("button"),B.textContent="\u{1F44B} Delete",L=A(),T=d("button"),T.textContent="Next \u{1F8A5}",w(l,"class","svelte-10vigfk"),w(S,"id","nav-bottom"),w(S,"class","svelte-10vigfk")},m(h,R){ce(e,h,R),g(h,t,R),g(h,l,R),a(l,r),a(l,s),a(l,i),a(l,u),a(l,c),g(h,o,R),g(h,p,R),a(p,_),a(p,D),a(p,k),a(p,P),g(h,z,R),g(h,O,R),O.innerHTML=j,g(h,V,R),g(h,M,R),g(h,N,R),g(h,S,R),a(S,C),a(S,E),a(S,B),a(S,L),a(S,T),F=!0,se||(H=[q(r,"click",n[3]),q(i,"click",n[4]),q(c,"click",n[5]),q(C,"click",n[6]),q(B,"click",n[7]),q(T,"click",n[8])],se=!0)},p(h,R){(!F||R&2)&&f!==(f=h[1].title+"")&&Y(_,f),(!F||R&2)&&v!==(v=h[1].status+"")&&Y(k,v),(!F||R&2)&&j!==(j=h[1].content+"")&&(O.innerHTML=j)},i(h){F||(G(e.$$.fragment,h),F=!0)},o(h){W(e.$$.fragment,h),F=!1},d(h){ue(e,h),h&&m(t),h&&m(l),h&&m(o),h&&m(p),h&&m(z),h&&m(O),h&&m(V),h&&m(M),h&&m(N),h&&m(S),se=!1,Z(H)}}}function rn(n){let e,t,l=n[1]&&lt(n);return{c(){e=d("main"),l&&l.c()},m(r,s){g(r,e,s),l&&l.m(e,null),t=!0},p(r,[s]){r[1]?l?(l.p(r,s),s&2&&G(l,1)):(l=lt(r),l.c(),G(l,1),l.m(e,null)):l&&(Ne(),W(l,1,1,()=>{l=null}),Le())},i(r){t||(G(l),t=!0)},o(r){W(l),t=!1},d(r){r&&m(e),l&&l.d()}}}function sn(n,e,t){let{id:l}=e,r=null;async function s(){t(1,r=await x.get_entry(l))}function i(D){window.scroll(0,0),t(1,r=D)}je(s);const u=()=>fe("Articles"),c=()=>{x.mark(l,"REMOVED"),fe("Articles")},o=()=>{x.next_article(r,U).then(i)},p=()=>{x.mark(r.id,"READ"),fe("Articles")},f=()=>{x.mark(r.id,"REMOVED"),x.next_article(r,U).then(i)},_=()=>{x.mark(r.id,"READ"),x.next_article(r,U).then(i)};return n.$$set=D=>{"id"in D&&t(0,l=D.id)},[l,r,i,u,c,o,p,f,_]}class on extends be{constructor(e){super(),me(this,e,sn,rn,oe,{id:0})}}function cn(n){let e,t;return{c(){e=$("Unknown page "),t=$(n[0])},m(l,r){g(l,e,r),g(l,t,r)},p(l,r){r&1&&Y(t,l[0])},i:y,o:y,d(l){l&&m(e),l&&m(t)}}}function un(n){let e,t;return e=new ln({}),{c(){he(e.$$.fragment)},m(l,r){ce(e,l,r),t=!0},p:y,i(l){t||(G(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){ue(e,l)}}}function an(n){let e,t;return e=new on({props:{id:n[1].id}}),{c(){he(e.$$.fragment)},m(l,r){ce(e,l,r),t=!0},p(l,r){const s={};r&2&&(s.id=l[1].id),e.$set(s)},i(l){t||(G(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){ue(e,l)}}}function fn(n){let e,t;return e=new Tt({}),{c(){he(e.$$.fragment)},m(l,r){ce(e,l,r),t=!0},p:y,i(l){t||(G(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){ue(e,l)}}}function dn(n){let e,t,l,r;const s=[fn,an,un,cn],i=[];function u(c,o){return c[0]=="Connect"?0:c[0]=="Article"?1:c[0]=="Articles"?2:3}return t=u(n),l=i[t]=s[t](n),{c(){e=d("main"),l.c()},m(c,o){g(c,e,o),i[t].m(e,null),r=!0},p(c,[o]){let p=t;t=u(c),t===p?i[t].p(c,o):(Ne(),W(i[p],1,1,()=>{i[p]=null}),Le(),l=i[t],l?l.p(c,o):(l=i[t]=s[t](c),l.c()),G(l,1),l.m(e,null))},i(c){r||(G(l),r=!0)},o(c){W(l),r=!1},d(c){c&&m(e),i[t].d()}}}function _n(n,e,t){let l,r;return Ie(n,re,s=>t(0,l=s)),Ie(n,xe,s=>t(1,r=s)),fe("Articles"),[l,r]}class pn extends be{constructor(e){super(),me(this,e,_n,dn,oe,{})}}new pn({target:document.getElementById("app")});
