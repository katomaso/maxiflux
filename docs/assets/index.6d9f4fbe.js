var et=Object.defineProperty;var tt=(n,e,t)=>e in n?et(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var g=(n,e,t)=>(tt(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function V(){}function Be(n){return n()}function Ie(){return Object.create(null)}function G(n){n.forEach(Be)}function nt(n){return typeof n=="function"}function ne(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function lt(n){return Object.keys(n).length===0}function st(n,...e){if(n==null)return V;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function ee(n,e,t){n.$$.on_destroy.push(st(e,t))}function Ne(n,e,t){return n.set(t),e}function u(n,e){n.appendChild(e)}function w(n,e,t){n.insertBefore(e,t||null)}function b(n){n.parentNode.removeChild(n)}function rt(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function f(n){return document.createElement(n)}function it(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function N(n){return document.createTextNode(n)}function O(){return N(" ")}function ot(){return N("")}function P(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function ae(n){return function(e){return e.preventDefault(),n.call(this,e)}}function ut(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function $(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function ct(n){return Array.from(n.childNodes)}function Z(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function B(n,e){n.value=e==null?"":e}class at{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,l=null){this.e||(this.is_svg?this.e=it(t.nodeName):this.e=f(t.nodeName),this.t=t,this.c(e)),this.i(l)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)w(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(b)}}let fe;function ue(n){fe=n}function He(){if(!fe)throw new Error("Function called outside component initialization");return fe}function Ae(n){He().$$.on_mount.push(n)}function ft(n){He().$$.after_update.push(n)}const ie=[],Re=[],me=[],Te=[],dt=Promise.resolve();let Ee=!1;function _t(){Ee||(Ee=!0,dt.then(Ye))}function Se(n){me.push(n)}const ke=new Set;let he=0;function Ye(){const n=fe;do{for(;he<ie.length;){const e=ie[he];he++,ue(e),pt(e.$$)}for(ue(null),ie.length=0,he=0;Re.length;)Re.pop()();for(let e=0;e<me.length;e+=1){const t=me[e];ke.has(t)||(ke.add(t),t())}me.length=0}while(ie.length);for(;Te.length;)Te.pop()();Ee=!1,ke.clear(),ue(n)}function pt(n){if(n.fragment!==null){n.update(),G(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Se)}}const ge=new Set;let W;function De(){W={r:0,c:[],p:W}}function Ce(){W.r||G(W.c),W=W.p}function x(n,e){n&&n.i&&(ge.delete(n),n.i(e))}function U(n,e,t,l){if(n&&n.o){if(ge.has(n))return;ge.add(n),W.c.push(()=>{ge.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function de(n){n&&n.c()}function le(n,e,t,l){const{fragment:s,on_mount:r,on_destroy:i,after_update:o}=n.$$;s&&s.m(e,t),l||Se(()=>{const c=r.map(Be).filter(nt);i?i.push(...c):G(c),n.$$.on_mount=[]}),o.forEach(Se)}function se(n,e){const t=n.$$;t.fragment!==null&&(G(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function ht(n,e){n.$$.dirty[0]===-1&&(ie.push(n),_t(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function _e(n,e,t,l,s,r,i,o=[-1]){const c=fe;ue(n);const a=n.$$={fragment:null,ctx:null,props:r,update:V,not_equal:s,bound:Ie(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Ie(),dirty:o,skip_bound:!1,root:e.target||c.$$.root};i&&i(a.root);let k=!1;if(a.ctx=t?t(n,e.props||{},(m,_,...S)=>{const E=S.length?S[0]:_;return a.ctx&&s(a.ctx[m],a.ctx[m]=E)&&(!a.skip_bound&&a.bound[m]&&a.bound[m](E),k&&ht(n,m)),_}):[],a.update(),k=!0,G(a.before_update),a.fragment=l?l(a.ctx):!1,e.target){if(e.hydrate){const m=ct(e.target);a.fragment&&a.fragment.l(m),m.forEach(b)}else a.fragment&&a.fragment.c();e.intro&&x(n.$$.fragment),le(n,e.target,e.anchor,e.customElement),Ye()}ue(c)}class pe{$destroy(){se(this,1),this.$destroy=V}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const s=l.indexOf(t);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!lt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const X=[];function $e(n,e=V){let t;const l=new Set;function s(o){if(ne(n,o)&&(n=o,t)){const c=!X.length;for(const a of l)a[1](),X.push(a,n);if(c){for(let a=0;a<X.length;a+=2)X[a][0](X[a+1]);X.length=0}}}function r(o){s(o(n))}function i(o,c=V){const a=[o,c];return l.add(a),l.size===1&&(t=e(s)||V),o(n),()=>{l.delete(a),l.size===0&&(t(),t=null)}}return{set:s,update:r,subscribe:i}}const Y=$e(""),te=$e(""),Ke=$e({});function oe(n,e,t){Ke.set(e),Y.set(n),t&&te.set(t)}function mt(n,e){te.set(e),Y.set(n)}let K=n=>n!=null?n.replace('"','\\"').replace("'","\\'"):null;class gt extends Error{}class Je extends Error{}class bt{constructor(){g(this,"url");g(this,"username");g(this,"connected",!1);g(this,"offline",!1);g(this,"authorization");g(this,"get",e=>this.request(e,null,"GET"));g(this,"put",(e,t)=>this.request(e,t,"PUT"));g(this,"post",(e,t)=>this.request(e,t,"POST"));g(this,"delete",e=>this.request(e,null,"DELETE"));g(this,"discover",e=>this.post("/v1/discover",`{"url":"${e}"}`));g(this,"feeds",()=>this.get("/v1/feeds"));g(this,"get_feed",e=>this.get(`/v1/feeds/${e}`));g(this,"get_feed_icon",e=>this.get(`/v1/feeds/${e}/icon`));g(this,"create_feed",(e,t)=>{let l=`{"feed_url": "${e}"`;return t!==0&&(l+=', "category_id": ',l+=t),l+="}",this.post("/v1/feeds",l)});g(this,"update_feed",(e,t,l)=>{if(t=K(t),t==null&&l==null)return new Promise((r,i)=>i("No title or category specified"));let s="{";return t!=null&&(s+=`"title": "${K(t)}"`),l!=null&&(t!=null&&(s+=","),s+=`"category": {"id": ${l}}`),s+="}",this.put(`/v1/feeds/${e}`,s)});g(this,"refresh_feed",e=>this.put(`/v1/feeds/${e}/refresh`));g(this,"remove_feed",e=>this.delete(`/v1/feeds/${e}`));g(this,"get_feed_entry",(e,t)=>this.get(`/v1/feeds/${e}/entries/${t}`));g(this,"get_entry",e=>this.get(`/v1/entries/${e}`));g(this,"get_feed_entries",(e,t)=>{let l=[];t!=null&&(t.status!=null&&l.push(`status=${t.status}`),t.offset!=null&&l.push(`offset=${t.offset}`),t.limit!=null&&l.push(`limit=${t.limit}`),t.direction!=null&&l.push(`direction=${t.direction}`),t.order!=null&&l.push(`order=${t.order}`));let s=`/v1/feeds/${e}/entries`;return l.length>0&&(s+="?",s+=l.join("&")),this.get(s)});g(this,"get_entries",e=>{let t=[];e!=null&&(e.status!=null&&t.push(`status=${e.status}`),e.offset!=null&&t.push(`offset=${e.offset}`),e.limit!=null&&t.push(`limit=${e.limit}`),e.direction!=null&&t.push(`direction=${e.direction}`),e.order!=null&&t.push(`order=${e.order}`));let l="/v1/entries";return t.length>0&&(l+="?",l+=t.join("&")),this.get(l)});g(this,"update_entries",(e,t)=>this.put("/v1/entries",`{"entry_ids": [${e.join(",")}], "status": "${K(t)}"}`));g(this,"toggle_bookmark",e=>this.put(`/v1/entries/${e}/bookmark`));g(this,"categories",()=>this.get("/v1/categories"));g(this,"create_category",e=>this.post("/v1/categories",`{"title": "${K(e)}"}`));g(this,"update_category",(e,t)=>this.put(`/v1/categories/${e}`,`{"title": "${K(t)}"}`));g(this,"delete_category",e=>this.delete(`/v1/categories/${e}`));g(this,"ompl_export",()=>this.get("/v1/export"));g(this,"create_user",(e,t,l)=>this.post("/v1/users",`{"username":"${K(e)}", "password:": "${K(t)}", "is_admin": ${l}}`));g(this,"update_user",(e,t)=>this.put(`/v1/users/${e}`,t));g(this,"users",()=>this.get("/v1/users"));g(this,"get_user",e=>this.get(`/v1/users/${e}`));g(this,"get_me",()=>this.get(`/v1/users/${this.username}`));g(this,"delete_user",e=>this.delete(`/v1/users/${e}`))}async connect(e,t,l){return this.connected?!0:(this.url=e,this.username=t,this.authorization=`Basic ${btoa(t+":"+l)}`,this.connected=await this.get_me().then(s=>s!=null),this.connected)}is_connected(){return this.connected}is_offline(){return this.offline}request(e,t=null,l="GET"){let s={method:l,headers:{Authorization:this.authorization}};return t!=null&&(typeof t=="object"&&(t=JSON.stringify(t)),s.body=t),fetch(new Request(this.url+e,s)).catch(r=>{throw this.offline=!0,new Je("you are offline")}).then(r=>{if(this.offline=!1,!r.ok)throw r.status==401?new gt("invalid credentials"):new Error(`${r.status}: ${r.statusText}`);return r.json()})}}var H;(function(n){n.READ="read",n.UNREAD="unread",n.REMOVED="removed"})(H||(H={}));var Pe;(function(n){n.ID="id",n.STATUS="status",n.PUBLISHED_AT="published_at",n.CATEGORY_TITLE="category_title",n.CATEGORY_ID="category_id"})(Pe||(Pe={}));var je;(function(n){n.ASCENDING="asc",n.DESCENDING="desc"})(je||(je={}));const vt="maxiflux",re=new Promise((n,e)=>{const t=indexedDB.open(vt,1);t.onerror=l=>{},t.onupgradeneeded=l=>{const s=l.target.result;s.objectStoreNames.contains("articles")||s.createObjectStore("articles",{keyPath:"id"}).createIndex("status","status",{unique:!1})},t.onsuccess=function(l){n(l.target.result),console.log("Offline database ready")}});async function $t(){return re.then(n=>{const e=n.transaction(["articles"]).objectStore("articles");let t={total:0,entries:[],updated:new Date(localStorage.getItem("cache_updated"))};return new Promise((l,s)=>{e.openCursor().onsuccess=r=>{const i=r.target.result;i?(i.value.status!=H.REMOVED&&(t.entries.push(i.value),t.total+=1),i.continue()):l(t)}})})}async function We(n){return re.then(e=>{const l=e.transaction(["articles"]).objectStore("articles").get(n);return new Promise((s,r)=>{l.onsuccess=()=>{s(l.result)}})})}async function J(n,e){if(e!="READ"&&e!="REMOVED")throw new Error("Must be READ or REMOVED");return console.log(`Atempting to mark article ${n} as ${e}`),await We(n),re.then(t=>{const l=t.transaction(["articles"],"readwrite").objectStore("articles"),s=l.get(n);return new Promise((r,i)=>{s.onsuccess=()=>{let o=s.result;o.status=H[e];let c=l.put(o);c.onsuccess=()=>{r()}}})})}async function Ze(){return re.then(n=>{const t=n.transaction(["articles"]).objectStore("articles").getAll();return new Promise((l,s)=>{t.onsuccess=()=>{l(t.result)}})})}async function Le(n){const e=await Ze();let t=!1;for(const l of e){if(t)return l;t=l.id==n.id}return e.at(-1)}async function wt(){const e=(await re).transaction(["articles"],"readwrite").objectStore("articles");return new Promise((t,l)=>{e.clear().onsuccess=t,console.log("Cache cleared")})}async function kt(n){const t=(await re).transaction(["articles"],"readwrite").objectStore("articles");return console.log("Cache updated"),n.entries.map(l=>new Promise((s,r)=>{t.add(l).onsuccess=()=>{localStorage.setItem("cache_updated",new Date().toISOString()),s()}}))}function Qe(){return localStorage.getItem("cache_updated")==null?-1:Date.now()-new Date(localStorage.getItem("cache_updated")).getTime()}function yt(n){return Math.round(n/1e3/3600/24)}const be="ONLINE",Et="OFFLINE",we="NOT CONNECTED";let ce=$e(we),ve=new bt;function Me(){if(!ve.is_connected()){te.set("Article"),Y.set("Connect");return}return ve}async function St(n){var s,r;if(console.log(`Syncing cache to server? ${n==be}`),n!=be)return;let e=[],t=[];(await Ze()).forEach(i=>{i.status==H.READ&&e.push(i.id),i.status==H.REMOVED&&t.push(i.id)}),e.length>0&&((s=Me())==null||s.update_entries(e,H.READ)),t.length>0&&((r=Me())==null||r.update_entries(t,H.REMOVED))}ce.subscribe(St);function qe(n){let e,t,l,s,r;return{c(){e=f("br"),t=f("em"),l=N("Login failed with "),s=N(n[4]),r=f("br"),$(t,"class","error")},m(i,o){w(i,e,o),w(i,t,o),u(t,l),u(t,s),w(i,r,o)},p(i,o){o&16&&Z(s,i[4])},d(i){i&&b(e),i&&b(t),i&&b(r)}}}function At(n){let e,t,l,s,r,i,o,c,a,k,m,_,S,E,A,y,T,C,M,j,q,F,p=n[4]&&qe(n);return{c(){e=f("main"),t=f("form"),l=f("label"),l.textContent="Server",s=f("input"),r=f("br"),i=O(),o=f("label"),o.textContent="Username",c=f("input"),a=f("br"),k=O(),m=f("label"),m.textContent="Password",_=f("input"),S=f("br"),E=O(),p&&p.c(),A=O(),y=f("input"),T=O(),C=f("input"),M=N(`\xA0Zapamatovat heslo
        `),j=f("br"),$(l,"for","url"),$(s,"type","text"),$(s,"name","url"),$(o,"for","username"),$(c,"type","text"),$(c,"name","username"),$(m,"for","password"),$(_,"type","password"),$(_,"name","password"),$(y,"type","submit"),y.value="Connect",$(C,"type","checkbox"),$(C,"name","remember"),$(t,"method","POST")},m(h,L){w(h,e,L),u(e,t),u(t,l),u(t,s),B(s,n[0]),u(t,r),u(t,i),u(t,o),u(t,c),B(c,n[1]),u(t,a),u(t,k),u(t,m),u(t,_),B(_,n[2]),u(t,S),u(t,E),p&&p.m(t,null),u(t,A),u(t,y),u(t,T),u(t,C),B(C,n[3]),u(t,M),u(t,j),q||(F=[P(s,"input",n[6]),P(c,"input",n[7]),P(_,"input",n[8]),P(y,"click",ut(ae(n[5]))),P(C,"change",n[9]),P(t,"submit",ae(n[5]))],q=!0)},p(h,[L]){L&1&&s.value!==h[0]&&B(s,h[0]),L&2&&c.value!==h[1]&&B(c,h[1]),L&4&&_.value!==h[2]&&B(_,h[2]),h[4]?p?p.p(h,L):(p=qe(h),p.c(),p.m(t,A)):p&&(p.d(1),p=null),L&8&&B(C,h[3])},i:V,o:V,d(h){h&&b(e),p&&p.d(),q=!1,G(F)}}}function Dt(n,e,t){let l;ee(n,te,E=>t(10,l=E));let s=localStorage.getItem("login_url")||"https://",r=localStorage.getItem("login_username"),i="",o=localStorage.getItem("login_remember")=="yes",c=null;function a(E){return s.startsWith("https://")||t(0,s="https://"+s),i==""&&t(2,i=localStorage.getItem("login_password")),ve.connect(s,r,i).then(()=>{console.log("Successfuly logged in"),localStorage.setItem("login_last",new Date().toISOString()),localStorage.setItem("login_url",s),localStorage.setItem("login_username",r),o?(localStorage.setItem("login_remember","yes"),localStorage.setItem("login_password",i)):localStorage.setItem("login_remember","no"),ce.set(be),Y.set(l||"Articles")}).catch(A=>{A instanceof Je?(ce.set(Et),Y.set(l||"Articles")):ce.set(we),t(4,c=A)})}o&&Ae(a);function k(){s=this.value,t(0,s)}function m(){r=this.value,t(1,r)}function _(){i=this.value,t(2,i)}function S(){o=this.value,t(3,o)}return[s,r,i,o,c,a,k,m,_,S]}class Ct extends pe{constructor(e){super(),_e(this,e,Dt,At,ne,{})}}function Ot(n){let e,t,l,s,r,i,o;return{c(){e=f("main"),t=f("div"),l=f("button"),l.textContent="\u25B2",s=O(),r=f("button"),r.textContent="\u25BC",$(l,"class","svelte-ucp7z5"),$(r,"class","svelte-ucp7z5"),$(t,"class","svelte-ucp7z5")},m(c,a){w(c,e,a),u(e,t),u(t,l),u(t,s),u(t,r),i||(o=[P(l,"click",ae(n[0])),P(r,"click",ae(n[1]))],i=!0)},p:V,i:V,o:V,d(c){c&&b(e),i=!1,G(o)}}}function ze(n="up"){let e=Math.round(window.window.visualViewport.height*.9);n=="up"?window.scroll(0,window.scrollY-e):window.scroll(0,window.scrollY+e)}function It(n){return[()=>ze("up"),()=>ze("down")]}class Xe extends pe{constructor(e){super(),_e(this,e,It,Ot,ne,{})}}function Ve(n,e,t){const l=n.slice();return l[10]=e[t],l}function ye(n){const e=n.slice(),t=yt(Qe());return e[9]=t,e}function xe(n){let e,t,l,s,r,i,o=n[0].total+"",c,a,k,m,_,S,E,A,y,T,C,M,j,q;e=new Xe({});function F(d,I){return d[1]==we?Rt:Nt}let p=F(n),h=p(n),L=n[0].entries.filter(Ue),R=[];for(let d=0;d<L.length;d+=1)R[d]=Fe(Ve(n,L,d));return{c(){de(e.$$.fragment),t=O(),l=f("nav"),h.c(),s=O(),r=f("h1"),i=N("Articles ("),c=N(o),a=N(")"),k=O(),m=f("nav"),_=f("span"),_.innerHTML="<button>Read</button>/<button>Unread</button>",S=O(),E=f("select"),A=f("option"),A.textContent="-- sort by --",y=f("option"),y.textContent="Newest",T=f("option"),T.textContent="Oldest",C=f("option"),C.textContent="Random",M=O(),j=f("ul");for(let d=0;d<R.length;d+=1)R[d].c();$(l,"class","svelte-iogv99"),A.__value="",A.value=A.__value,y.__value="-last_changed",y.value=y.__value,T.__value="+last_changed",T.value=T.__value,C.__value="random",C.value=C.__value,$(E,"name","sort"),$(m,"class","svelte-iogv99"),$(j,"class","svelte-iogv99")},m(d,I){le(e,d,I),w(d,t,I),w(d,l,I),h.m(l,null),w(d,s,I),w(d,r,I),u(r,i),u(r,c),u(r,a),w(d,k,I),w(d,m,I),u(m,_),u(m,S),u(m,E),u(E,A),u(E,y),u(E,T),u(E,C),w(d,M,I),w(d,j,I);for(let D=0;D<R.length;D+=1)R[D].m(j,null);q=!0},p(d,I){if(p===(p=F(d))&&h?h.p(d,I):(h.d(1),h=p(d),h&&(h.c(),h.m(l,null))),(!q||I&1)&&o!==(o=d[0].total+"")&&Z(c,o),I&5){L=d[0].entries.filter(Ue);let D;for(D=0;D<L.length;D+=1){const Q=Ve(d,L,D);R[D]?R[D].p(Q,I):(R[D]=Fe(Q),R[D].c(),R[D].m(j,null))}for(;D<R.length;D+=1)R[D].d(1);R.length=L.length}},i(d){q||(x(e.$$.fragment,d),q=!0)},o(d){U(e.$$.fragment,d),q=!1},d(d){se(e,d),d&&b(t),d&&b(l),h.d(),d&&b(s),d&&b(r),d&&b(k),d&&b(m),d&&b(M),d&&b(j),rt(R,d)}}}function Nt(n){let e,t,l,s,r=n[9]>0&&Tt(n);return{c(){e=f("button"),e.textContent="\u{1F504}",r&&r.c(),t=ot()},m(i,o){w(i,e,o),r&&r.m(i,o),w(i,t,o),l||(s=P(e,"click",n[4]),l=!0)},p(i,o){i[9]>0&&r.p(i,o)},d(i){i&&b(e),r&&r.d(i),i&&b(t),l=!1,s()}}}function Rt(n){let e,t,l;return{c(){e=f("button"),e.textContent="Connect"},m(s,r){w(s,e,r),t||(l=P(e,"click",n[3]),t=!0)},p:V,d(s){s&&b(e),t=!1,l()}}}function Tt(n){let e,t,l=n[9]+"",s,r;return{c(){e=f("em"),t=N("(last sync "),s=N(l),r=N(" days ago)")},m(i,o){w(i,e,o),u(e,t),u(e,s),u(e,r)},p:V,d(i){i&&b(e)}}}function Fe(n){let e,t,l,s,r,i=n[10].title+"",o,c,a,k,m=n[10].feed.title+"",_,S,E,A=new Date(n[10].changed_at).toLocaleDateString()+"",y,T,C,M,j;function q(...p){return n[5](n[10],...p)}function F(...p){return n[6](n[10],...p)}return{c(){e=f("li"),t=f("button"),t.textContent="x",l=O(),s=f("a"),r=f("h2"),o=N(i),c=O(),a=f("em"),k=N("From "),_=N(m),S=N(" on "),E=f("date"),y=N(A),C=O(),$(t,"class","close svelte-iogv99"),$(r,"class","svelte-iogv99"),$(a,"class","svelte-iogv99"),$(s,"href",T="article/"+n[10].id),$(s,"class","svelte-iogv99"),$(e,"class","svelte-iogv99")},m(p,h){w(p,e,h),u(e,t),u(e,l),u(e,s),u(s,r),u(r,o),u(s,c),u(s,a),u(a,k),u(a,_),u(a,S),u(a,E),u(E,y),u(e,C),M||(j=[P(t,"click",q),P(s,"click",ae(F))],M=!0)},p(p,h){n=p,h&1&&i!==(i=n[10].title+"")&&Z(o,i),h&1&&m!==(m=n[10].feed.title+"")&&Z(_,m),h&1&&A!==(A=new Date(n[10].changed_at).toLocaleDateString()+"")&&Z(y,A),h&1&&T!==(T="article/"+n[10].id)&&$(s,"href",T)},d(p){p&&b(e),M=!1,G(j)}}}function Pt(n){let e,t,l=n[0]&&xe(ye(n));return{c(){e=f("main"),l&&l.c()},m(s,r){w(s,e,r),l&&l.m(e,null),t=!0},p(s,[r]){s[0]?l?(l.p(ye(s),r),r&1&&x(l,1)):(l=xe(ye(s)),l.c(),x(l,1),l.m(e,null)):l&&(De(),U(l,1,1,()=>{l=null}),Ce())},i(s){t||(x(l),t=!0)},o(s){U(l),t=!1},d(s){s&&b(e),l&&l.d()}}}const Ue=n=>n.status=="unread";function jt(n,e,t){let l,s,r;ee(n,ce,_=>t(1,l=_)),ee(n,Y,_=>t(7,s=_)),ee(n,te,_=>t(8,r=_));let i=null;async function o(_){let S=Qe();l==we&&(S<0||_)?(Ne(te,r="Articles",r),Ne(Y,s="Connect",s)):l==be&&(_||S<0)?(console.log(`Refreshing data because force_refresh(${_}) or age(${S}) < 0`),t(0,i=await ve.get_entries()),await wt(),await kt(i)):t(0,i=await $t())}return Ae(()=>o(!1)),[i,l,o,_=>mt("Connect","Articles"),_=>o(!0),(_,S)=>{J(_.id,"REMOVED"),o()},(_,S)=>oe("Article",{id:_.id})]}class Lt extends pe{constructor(e){super(),_e(this,e,jt,Pt,ne,{})}}function Ge(n){let e,t,l,s,r,i,o,c,a,k,m=n[1].title+"",_,S,E=n[1].status+"",A,y,T,C,M=n[1].content+"",j,q,F,p,h,L,R,d,I,D,Q,Oe;return e=new Xe({}),{c(){de(e.$$.fragment),t=O(),l=f("nav"),s=f("button"),s.textContent="\u{1F519} Articles",r=O(),i=f("button"),i.textContent="\u{1F44B} Delete",o=O(),c=f("button"),c.textContent="Next \u{1F8A5}",a=O(),k=f("h1"),_=N(m),S=N(" ("),A=N(E),y=N(")"),T=O(),C=new at(!1),j=O(),q=f("br"),F=O(),p=f("nav"),h=f("button"),h.textContent="\u{1F519} Articles",L=O(),R=f("button"),R.textContent="\u{1F44B} Delete",d=O(),I=f("button"),I.textContent="Next \u{1F8A5}",$(l,"class","svelte-10vigfk"),C.a=j,$(p,"id","nav-bottom"),$(p,"class","svelte-10vigfk")},m(v,z){le(e,v,z),w(v,t,z),w(v,l,z),u(l,s),u(l,r),u(l,i),u(l,o),u(l,c),w(v,a,z),w(v,k,z),u(k,_),u(k,S),u(k,A),u(k,y),w(v,T,z),C.m(M,v,z),w(v,j,z),w(v,q,z),w(v,F,z),w(v,p,z),u(p,h),u(p,L),u(p,R),u(p,d),u(p,I),D=!0,Q||(Oe=[P(s,"click",n[3]),P(i,"click",n[4]),P(c,"click",n[5]),P(h,"click",n[6]),P(R,"click",n[7]),P(I,"click",n[8])],Q=!0)},p(v,z){(!D||z&2)&&m!==(m=v[1].title+"")&&Z(_,m),(!D||z&2)&&E!==(E=v[1].status+"")&&Z(A,E),(!D||z&2)&&M!==(M=v[1].content+"")&&C.p(M)},i(v){D||(x(e.$$.fragment,v),D=!0)},o(v){U(e.$$.fragment,v),D=!1},d(v){se(e,v),v&&b(t),v&&b(l),v&&b(a),v&&b(k),v&&b(T),v&&C.d(),v&&b(j),v&&b(q),v&&b(F),v&&b(p),Q=!1,G(Oe)}}}function Mt(n){let e,t,l=n[1]&&Ge(n);return{c(){e=f("main"),l&&l.c()},m(s,r){w(s,e,r),l&&l.m(e,null),t=!0},p(s,[r]){s[1]?l?(l.p(s,r),r&2&&x(l,1)):(l=Ge(s),l.c(),x(l,1),l.m(e,null)):l&&(De(),U(l,1,1,()=>{l=null}),Ce())},i(s){t||(x(l),t=!0)},o(s){U(l),t=!1},d(s){s&&b(e),l&&l.d()}}}function qt(n,e,t){let{id:l}=e,s,r=!0;async function i(){t(1,s=await We(l)),document.addEventListener("keydown",y=>console.log(y))}function o(y){window.scroll(0,0),r=!0,t(1,s=y)}let c=new IntersectionObserver(()=>{s&&r?r=!1:J(s.id,"READ")},{root:document.querySelector("#scrollArea"),rootMargin:"0px",threshold:1}),a=!1;Ae(i),ft(()=>{let y=document.querySelector("#nav-bottom");y&&!a&&(c.observe(y),a=!0),console.log("After update called"),r=!0});const k=()=>oe("Articles"),m=()=>{J(l,"REMOVED"),oe("Articles")},_=()=>{J(s.id,"READ"),Le(s).then(o)},S=()=>{J(s.id,"READ"),oe("Articles")},E=()=>{J(s.id,"REMOVED"),oe("Articles")},A=()=>{J(s.id,"READ"),Le(s).then(o)};return n.$$set=y=>{"id"in y&&t(0,l=y.id)},[l,s,o,k,m,_,S,E,A]}class zt extends pe{constructor(e){super(),_e(this,e,qt,Mt,ne,{id:0})}}function Vt(n){let e,t;return e=new Lt({}),{c(){de(e.$$.fragment)},m(l,s){le(e,l,s),t=!0},p:V,i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){U(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function xt(n){let e,t;return e=new zt({props:{id:n[1].id}}),{c(){de(e.$$.fragment)},m(l,s){le(e,l,s),t=!0},p(l,s){const r={};s&2&&(r.id=l[1].id),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){U(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function Ft(n){let e,t;return e=new Ct({}),{c(){de(e.$$.fragment)},m(l,s){le(e,l,s),t=!0},p:V,i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){U(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function Ut(n){let e,t,l,s;const r=[Ft,xt,Vt],i=[];function o(c,a){return c[0]=="Connect"?0:c[0]=="Article"?1:c[0]=="Articles"||c[0]==""?2:-1}return~(t=o(n))&&(l=i[t]=r[t](n)),{c(){e=f("main"),l&&l.c()},m(c,a){w(c,e,a),~t&&i[t].m(e,null),s=!0},p(c,[a]){let k=t;t=o(c),t===k?~t&&i[t].p(c,a):(l&&(De(),U(i[k],1,1,()=>{i[k]=null}),Ce()),~t?(l=i[t],l?l.p(c,a):(l=i[t]=r[t](c),l.c()),x(l,1),l.m(e,null)):l=null)},i(c){s||(x(l),s=!0)},o(c){U(l),s=!1},d(c){c&&b(e),~t&&i[t].d()}}}function Gt(n,e,t){let l,s;return ee(n,Y,r=>t(0,l=r)),ee(n,Ke,r=>t(1,s=r)),[l,s]}class Bt extends pe{constructor(e){super(),_e(this,e,Gt,Ut,ne,{})}}new Bt({target:document.getElementById("app")});
