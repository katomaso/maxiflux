var rt=Object.defineProperty;var ot=(n,e,t)=>e in n?rt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var p=(n,e,t)=>(ot(n,typeof e!="symbol"?e+"":e,t),t),ut=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var Oe=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var Re=(n,e,t)=>(ut(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function O(){}function Qe(n){return n()}function Te(){return Object.create(null)}function K(n){n.forEach(Qe)}function ct(n){return typeof n=="function"}function ie(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function at(n){return Object.keys(n).length===0}function ft(n,...e){if(n==null)return O;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Ee(n,e,t){n.$$.on_destroy.push(ft(e,t))}function a(n,e){n.appendChild(e)}function g(n,e,t){n.insertBefore(e,t||null)}function m(n){n.parentNode.removeChild(n)}function Xe(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function f(n){return document.createElement(n)}function $(n){return document.createTextNode(n)}function A(){return $(" ")}function dt(){return $("")}function q(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function fe(n){return function(e){return e.preventDefault(),n.call(this,e)}}function _t(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function b(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function pt(n){return Array.from(n.childNodes)}function H(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function Z(n,e){n.value=e==null?"":e}let de;function ce(n){de=n}function mt(){if(!de)throw new Error("Function called outside component initialization");return de}function qe(n){mt().$$.on_mount.push(n)}const ue=[],je=[],be=[],Me=[],ht=Promise.resolve();let Se=!1;function gt(){Se||(Se=!0,ht.then(et))}function Ae(n){be.push(n)}const De=new Set;let he=0;function et(){const n=de;do{for(;he<ue.length;){const e=ue[he];he++,ce(e),bt(e.$$)}for(ce(null),ue.length=0,he=0;je.length;)je.pop()();for(let e=0;e<be.length;e+=1){const t=be[e];De.has(t)||(De.add(t),t())}be.length=0}while(ue.length);for(;Me.length;)Me.pop()();Se=!1,De.clear(),ce(n)}function bt(n){if(n.fragment!==null){n.update(),K(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Ae)}}const ve=new Set;let ee;function tt(){ee={r:0,c:[],p:ee}}function nt(){ee.r||K(ee.c),ee=ee.p}function U(n,e){n&&n.i&&(ve.delete(n),n.i(e))}function W(n,e,t,l){if(n&&n.o){if(ve.has(n))return;ve.add(n),ee.c.push(()=>{ve.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function _e(n){n&&n.c()}function re(n,e,t,l){const{fragment:s,on_mount:i,on_destroy:r,after_update:o}=n.$$;s&&s.m(e,t),l||Ae(()=>{const u=i.map(Qe).filter(ct);r?r.push(...u):K(u),n.$$.on_mount=[]}),o.forEach(Ae)}function oe(n,e){const t=n.$$;t.fragment!==null&&(K(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function vt(n,e){n.$$.dirty[0]===-1&&(ue.push(n),gt(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function pe(n,e,t,l,s,i,r,o=[-1]){const u=de;ce(n);const c=n.$$={fragment:null,ctx:null,props:i,update:O,not_equal:s,bound:Te(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:Te(),dirty:o,skip_bound:!1,root:e.target||u.$$.root};r&&r(c.root);let h=!1;if(c.ctx=t?t(n,e.props||{},(d,k,...C)=>{const S=C.length?C[0]:k;return c.ctx&&s(c.ctx[d],c.ctx[d]=S)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](S),h&&vt(n,d)),k}):[],c.update(),h=!0,K(c.before_update),c.fragment=l?l(c.ctx):!1,e.target){if(e.hydrate){const d=pt(e.target);c.fragment&&c.fragment.l(d),d.forEach(m)}else c.fragment&&c.fragment.c();e.intro&&U(n.$$.fragment),re(n,e.target,e.anchor,e.customElement),et()}ce(u)}class me{$destroy(){oe(this,1),this.$destroy=O}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const s=l.indexOf(t);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!at(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const le=[];function ye(n,e=O){let t;const l=new Set;function s(o){if(ie(n,o)&&(n=o,t)){const u=!le.length;for(const c of l)c[1](),le.push(c,n);if(u){for(let c=0;c<le.length;c+=2)le[c][0](le[c+1]);le.length=0}}}function i(o){s(o(n))}function r(o,u=O){const c=[o,u];return l.add(c),l.size===1&&(t=e(s)||O),o(n),()=>{l.delete(c),l.size===0&&(t(),t=null)}}return{set:s,update:i,subscribe:r}}const te=ye(""),Ce=ye({}),$e=ye(""),xe=ye({});let Pe;te.subscribe(n=>{Pe=n,console.log("router.page changed to ",Pe)});let we;$e.subscribe(n=>{we=n,console.log("router.next changed to ",we)});let Ie;xe.subscribe(n=>{Ie=n,console.log("router._next_params changed to ",Ie)});function ae(n,e){if(we){$e.set(null),xe.set(null),Ce.set(Ie),te.set(we);return}Ce.set(e),te.set(n)}function wt(n,e){$e.set(Pe),xe.set(e),te.set(n)}let X=n=>n!=null?n.replace('"','\\"').replace("'","\\'"):null;class kt extends Error{}class yt extends Error{}class $t{constructor(){p(this,"url");p(this,"username");p(this,"connected",!1);p(this,"offline",!1);p(this,"authorization");p(this,"get",e=>this.request(e,null,"GET"));p(this,"put",(e,t)=>this.request(e,t,"PUT"));p(this,"post",(e,t)=>this.request(e,t,"POST"));p(this,"delete",e=>this.request(e,null,"DELETE"));p(this,"discover",e=>this.post("/v1/discover",`{"url":"${e}"}`));p(this,"feeds",()=>this.get("/v1/feeds"));p(this,"get_feed",e=>this.get(`/v1/feeds/${e}`));p(this,"get_feed_icon",e=>this.get(`/v1/feeds/${e}/icon`));p(this,"create_feed",(e,t)=>{let l=`{"feed_url": "${e}"`;return t!==0&&(l+=', "category_id": ',l+=t),l+="}",this.post("/v1/feeds",l)});p(this,"update_feed",(e,t,l)=>{if(t=X(t),t==null&&l==null)return new Promise((i,r)=>r("No title or category specified"));let s="{";return t!=null&&(s+=`"title": "${X(t)}"`),l!=null&&(t!=null&&(s+=","),s+=`"category": {"id": ${l}}`),s+="}",this.put(`/v1/feeds/${e}`,s)});p(this,"refresh_feed",e=>this.put(`/v1/feeds/${e}/refresh`));p(this,"remove_feed",e=>this.delete(`/v1/feeds/${e}`));p(this,"get_feed_entry",(e,t)=>this.get(`/v1/feeds/${e}/entries/${t}`));p(this,"get_entry",e=>this.get(`/v1/entries/${e}`));p(this,"get_feed_entries",(e,t)=>{let l=[];t!=null&&(t.status!=null&&l.push(`status=${t.status}`),t.offset!=null&&l.push(`offset=${t.offset}`),t.limit!=null&&l.push(`limit=${t.limit}`),t.direction!=null&&l.push(`direction=${t.direction}`),t.order!=null&&l.push(`order=${t.order}`));let s=`/v1/feeds/${e}/entries`;return l.length>0&&(s+="?",s+=l.join("&")),this.get(s)});p(this,"get_entries",e=>{let t=[];e!=null&&(e.status!=null&&t.push(`status=${e.status}`),e.offset!=null&&t.push(`offset=${e.offset}`),e.limit!=null&&t.push(`limit=${e.limit}`),e.direction!=null&&t.push(`direction=${e.direction}`),e.order!=null&&t.push(`order=${e.order}`));let l="/v1/entries";return t.length>0&&(l+="?",l+=t.join("&")),this.get(l)});p(this,"update_entries",(e,t)=>this.put("/v1/entries",`{"entry_ids": [${e.join(",")}], "status": "${X(t)}"}`));p(this,"toggle_bookmark",e=>this.put(`/v1/entries/${e}/bookmark`));p(this,"categories",()=>this.get("/v1/categories"));p(this,"create_category",e=>this.post("/v1/categories",`{"title": "${X(e)}"}`));p(this,"update_category",(e,t)=>this.put(`/v1/categories/${e}`,`{"title": "${X(t)}"}`));p(this,"delete_category",e=>this.delete(`/v1/categories/${e}`));p(this,"ompl_export",()=>this.get("/v1/export"));p(this,"create_user",(e,t,l)=>this.post("/v1/users",`{"username":"${X(e)}", "password:": "${X(t)}", "is_admin": ${l}}`));p(this,"update_user",(e,t)=>this.put(`/v1/users/${e}`,t));p(this,"users",()=>this.get("/v1/users"));p(this,"get_user",e=>this.get(`/v1/users/${e}`));p(this,"get_me",()=>this.get(`/v1/users/${this.username}`));p(this,"delete_user",e=>this.delete(`/v1/users/${e}`))}async connect(e,t,l){return this.connected?!0:(this.url=e,this.username=t,this.authorization=`Basic ${btoa(t+":"+l)}`,this.connected=await this.get_me().then(s=>s!=null),this.connected)}is_connected(){return this.connected}is_offline(){return this.offline}request(e,t=null,l="GET"){let s={method:l,headers:{Authorization:this.authorization}};return t!=null&&(typeof t=="object"&&(t=JSON.stringify(t)),s.body=t),fetch(new Request(this.url+e,s)).catch(i=>{throw this.offline=!0,new yt("you are offline")}).then(i=>{if(this.offline=!1,!i.ok)throw i.status==401?new kt("invalid credentials"):new Error(`${i.status}: ${i.statusText}`);return i.status==200||i.status==201?i.json():null})}}var Q;(function(n){n.READ="read",n.UNREAD="unread",n.REMOVED="removed"})(Q||(Q={}));var Le;(function(n){n.ID="id",n.STATUS="status",n.PUBLISHED_AT="published_at",n.CATEGORY_TITLE="category_title",n.CATEGORY_ID="category_id"})(Le||(Le={}));var Ne;(function(n){n.ASCENDING="asc",n.DESCENDING="desc"})(Ne||(Ne={}));var ke,lt;class Dt{constructor(){Oe(this,ke);p(this,"miniflux");this.miniflux=new $t}async connect(e,t,l){return this.miniflux.connect(e,t,l)}get connected(){return this.miniflux.is_connected()}get offline(){return this.miniflux.is_offline()}mark_read(e){this.miniflux.update_entries([e],Q.READ)}async query(e){return e.feed>0?this.miniflux.get_feed_entries(e.feed,{order:"published_at",direction:e.directionDesc?"desc":"asc",limit:100}):this.miniflux.get_entries(Re(this,ke,lt).call(this,e))}async sync(e){let t=[],l=[];for(let s of e)s.status==Q.READ&&t.push(s.id),s.status==Q.REMOVED&&l.push(s.id);t.length>0&&await this.miniflux.update_entries(t,Q.READ),l.length>0&&await this.miniflux.update_entries(l,Q.REMOVED)}async get_feeds(){return this.miniflux.feeds()}}ke=new WeakSet,lt=function(e){return{status:e.status,order:"published_at",direction:e.directionDesc?"desc":"asc",limit:100}};let se=new Dt;function ze(n){let e,t,l;function s(o,u){return se.offline?St:Et}let r=s()(n);return{c(){e=f("br"),t=f("em"),r.c(),l=f("br"),b(t,"class","error")},m(o,u){g(o,e,u),g(o,t,u),r.m(t,null),g(o,l,u)},p(o,u){r.p(o,u)},d(o){o&&m(e),o&&m(t),r.d(),o&&m(l)}}}function Et(n){let e;return{c(){e=$("Login failed")},m(t,l){g(t,e,l)},p:O,d(t){t&&m(e)}}}function St(n){let e,t,l,s;return{c(){e=$("You are offline "),t=f("button"),t.textContent="Go back"},m(i,r){g(i,e,r),g(i,t,r),l||(s=q(t,"click",n[10]),l=!0)},p:O,d(i){i&&m(e),i&&m(t),l=!1,s()}}}function At(n){let e,t,l,s,i,r,o,u,c,h,d,k,C,S,v,x,B,P,z,T,N,V,w=n[4]&&ze(n);return{c(){e=f("main"),t=f("form"),l=f("label"),l.textContent="Server",s=f("input"),i=f("br"),r=A(),o=f("label"),o.textContent="Username",u=f("input"),c=f("br"),h=A(),d=f("label"),d.textContent="Password",k=f("input"),C=f("br"),S=A(),w&&w.c(),v=A(),x=f("input"),B=A(),P=f("input"),z=$(`\xA0Zapamatovat heslo
        `),T=f("br"),b(l,"for","url"),b(l,"class","svelte-9inz0g"),b(s,"type","text"),b(s,"name","url"),b(o,"for","username"),b(o,"class","svelte-9inz0g"),b(u,"type","text"),b(u,"name","username"),b(d,"for","password"),b(d,"class","svelte-9inz0g"),b(k,"type","password"),b(k,"name","password"),b(x,"type","submit"),x.value="Connect",b(P,"type","checkbox"),b(P,"name","remember"),b(t,"method","POST")},m(E,y){g(E,e,y),a(e,t),a(t,l),a(t,s),Z(s,n[0]),a(t,i),a(t,r),a(t,o),a(t,u),Z(u,n[1]),a(t,c),a(t,h),a(t,d),a(t,k),Z(k,n[2]),a(t,C),a(t,S),w&&w.m(t,null),a(t,v),a(t,x),a(t,B),a(t,P),Z(P,n[3]),a(t,z),a(t,T),N||(V=[q(s,"input",n[7]),q(u,"input",n[8]),q(k,"input",n[9]),q(x,"click",_t(fe(n[6]))),q(P,"change",n[11]),q(t,"submit",fe(n[6]))],N=!0)},p(E,[y]){y&1&&s.value!==E[0]&&Z(s,E[0]),y&2&&u.value!==E[1]&&Z(u,E[1]),y&4&&k.value!==E[2]&&Z(k,E[2]),E[4]?w?w.p(E,y):(w=ze(E),w.c(),w.m(t,v)):w&&(w.d(1),w=null),y&8&&Z(P,E[3])},i:O,o:O,d(E){E&&m(e),w&&w.d(),N=!1,K(V)}}}function Ct(n,e,t){let l;Ee(n,$e,v=>t(5,l=v));let s=localStorage.getItem("login_url")||"https://",i=localStorage.getItem("login_username"),r="",o=localStorage.getItem("login_remember")=="yes",u=null;async function c(v){if(s.startsWith("https://")||t(0,s="https://"+s),r==""&&(t(2,r=localStorage.getItem("login_password")),r==""))return;if(await se.connect(s,i,r))return console.log("Successfuly logged in"),localStorage.setItem("login_last",new Date().toISOString()),localStorage.setItem("login_url",s),localStorage.setItem("login_username",i),o?(localStorage.setItem("login_remember","yes"),localStorage.setItem("login_password",r)):localStorage.setItem("login_remember","no"),te.set(l||"Articles");t(4,u=!0)}o&&qe(c);function h(){s=this.value,t(0,s)}function d(){i=this.value,t(1,i)}function k(){r=this.value,t(2,r)}const C=()=>te.set(l||"Articles");function S(){o=this.value,t(3,o)}return[s,i,r,o,u,l,c,h,d,k,C,S]}class Pt extends me{constructor(e){super(),pe(this,e,Ct,At,ie,{})}}function Ve(n){return new Promise((e,t)=>{n.onsuccess=()=>{console.log("PromiseResult resolved: ",n.result),e(n.result)}})}class It{constructor(e){p(this,"dbPromise");p(this,"db",null);p(this,"status","unread");p(this,"index","status-age");p(this,"indexes",["status-age","feed-age"]);this.dbPromise=new Promise((t,l)=>{const s=indexedDB.open(e,1);s.onerror=i=>{},s.onupgradeneeded=i=>{const r=i.target.result,o=r.createObjectStore("articles",{keyPath:"id"});r.createObjectStore("feeds",{keyPath:"id"}),o.createIndex("status-age",["status","published_at"],{unique:!1}),o.createIndex("feed-age",["feed_id","published_at"],{unique:!1}),o.createIndex("updated-age","updated_at",{unique:!1})},s.onsuccess=function(i){t(i.target.result),console.log(`Cache ${e} ready`)}})}async connect(){return this.dbPromise.then(e=>{this.db=e})}async query(e){return this.dbPromise.then(t=>{const l=t.transaction(["articles"]).objectStore("articles");let s="status-age",i=IDBKeyRange.bound([e.status,new Date(0)],[e.status,new Date]);return e.feed>0&&(s="feed-age",i=IDBKeyRange.bound([e.feed,new Date(0)],[e.feed,new Date])),new Promise((r,o)=>{let u=[];l.index(s).openCursor(i,e.directionDesc?"prev":"next").onsuccess=c=>{const h=c.target.result;h?(u.push(h.value),h.continue()):r(u)}})})}async get_entry(e){return Ve(this.db.transaction(["articles"]).objectStore("articles").get(e))}async mark(e,t){if(t!="READ"&&t!="REMOVED")throw new Error("Must be READ or REMOVED");return this.dbPromise.then(l=>{const s=l.transaction(["articles"],"readwrite").objectStore("articles"),i=s.get(e);return console.log(`Marking article ${e} as ${t}`),new Promise((r,o)=>{i.onsuccess=()=>{let u=i.result;u.status=Q[t];let c=s.put(u);c.onsuccess=()=>{r()}}})})}async get_entries(){return this.dbPromise.then(e=>{const l=e.transaction(["articles"]).objectStore("articles").getAll();return new Promise((s,i)=>{l.onsuccess=()=>{s(l.result)}})})}async get_feeds(){return Ve(this.db.transaction(["feeds"]).objectStore("feeds").getAll())}async get_feed_categories(){let e=await this.get_feeds(),t={};for(let l of e)t[l.category.title]||(t[l.category.title]=[]),t[l.category.title].append(l);return t}async next_article(e,t){const l=await this.query(t);let s=!1;for(const i of l.entries){if(s)return i;s=i.id==e.id}return l.entries.at(-1)}async clear(){const t=(await this.dbPromise).transaction(["articles"],"readwrite").objectStore("articles");return new Promise((l,s)=>{t.clear().onsuccess=()=>{localStorage.removeItem("cache_updated"),console.log("Cache cleared")}})}async update(e){const l=(await this.dbPromise).transaction(["articles"],"readwrite").objectStore("articles");console.log("Cache updated");function s(r){let o=r[0];for(let u=1;u<r.length;u++)r[u]>o&&(o=r[u]);return o}let i=new Date;return Promise.all(e.map(r=>new Promise((o,u)=>{r.published_at=new Date(r.published_at),r.changed_at=s([new Date(r.published_at),new Date(r.changed_at),new Date(r.created_at),new Date(r.modified)]),r.updated_at=i,l.add(r).onsuccess=()=>{o()}}))).then(()=>localStorage.setItem("cache_updated",i.toISOString()))}async update_feeds(e){const l=(await this.dbPromise).transaction(["feeds"],"readwrite").objectStore("feeds");return new Promise((s,i)=>{l.clear().onsuccess=s}).then(()=>Promise.all(e.map(s=>new Promise((i,r)=>{l.add(s).onsuccess=()=>{i()}})))).then(()=>localStorage.setItem("feeds_updated",new Date().toISOString()))}get age(){return localStorage.getItem("cache_updated")==null?null:new Date(localStorage.getItem("cache_updated"))}}const I=new It("maxiflux");class qt{constructor(){p(this,"_status","unread");p(this,"_feed",0);p(this,"_desc",!0)}setDirectionDesc(){this._desc=!0}setDirectionAsc(){this._desc=!1}setStatus(e){this._status=e}setFeed(e){this._feed=e}get feed(){return this._feed}get status(){return this._status}get directionDesc(){return this._desc}}let G=new qt;function xt(n){let e,t,l,s,i,r,o;return{c(){e=f("main"),t=f("div"),l=f("button"),l.textContent="\u25B2",s=A(),i=f("button"),i.textContent="\u25BC",b(l,"class","svelte-118eg67"),b(i,"class","svelte-118eg67"),b(t,"class","svelte-118eg67")},m(u,c){g(u,e,c),a(e,t),a(t,l),a(t,s),a(t,i),r||(o=[q(l,"click",fe(n[0])),q(i,"click",fe(n[1]))],r=!0)},p:O,i:O,o:O,d(u){u&&m(e),r=!1,K(o)}}}function Be(n="up"){let e=Math.round(window.window.visualViewport.height*.9);n=="up"?window.scroll(0,window.scrollY-e):window.scroll(0,window.scrollY+e)}function Ot(n){return[()=>Be("up"),()=>Be("down")]}class st extends me{constructor(e){super(),pe(this,e,Ot,xt,ie,{})}}function Ge(n,e,t){const l=n.slice();return l[12]=e[t],l}function Fe(n,e,t){const l=n.slice();return l[15]=e[t],l}function Rt(n){let e,t;function l(r,o){return it(I.age)>0?jt:Tt}let i=l()(n);return{c(){e=$("Last sync: "),i.c(),t=$(" ago |")},m(r,o){g(r,e,o),i.m(r,o),g(r,t,o)},p(r,o){i.p(r,o)},d(r){r&&m(e),i.d(r),r&&m(t)}}}function Tt(n){let e;return{c(){e=$("a moment")},m(t,l){g(t,e,l)},p:O,d(t){t&&m(e)}}}function jt(n){let e=it(I.age)+"",t,l;return{c(){t=$(e),l=$(" days")},m(s,i){g(s,t,i),g(s,l,i)},p:O,d(s){s&&m(t),s&&m(l)}}}function Ue(n){let e,t,l,s,i,r,o=n[1],u=[];for(let c=0;c<o.length;c+=1)u[c]=Ye(Fe(n,o,c));return{c(){e=f("label"),e.textContent="Feeds:",t=A(),l=f("select"),s=f("option"),s.textContent="All";for(let c=0;c<u.length;c+=1)u[c].c();b(e,"for","sort"),s.__value="0",s.value=s.__value,b(l,"name","feed"),b(l,"class","svelte-1qi545v")},m(c,h){g(c,e,h),g(c,t,h),g(c,l,h),a(l,s);for(let d=0;d<u.length;d+=1)u[d].m(l,null);i||(r=q(l,"change",n[5]),i=!0)},p(c,h){if(h&2){o=c[1];let d;for(d=0;d<o.length;d+=1){const k=Fe(c,o,d);u[d]?u[d].p(k,h):(u[d]=Ye(k),u[d].c(),u[d].m(l,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=o.length}},d(c){c&&m(e),c&&m(t),c&&m(l),Xe(u,c),i=!1,r()}}}function Mt(n){let e,t=n[15].title+"",l,s;return{c(){e=f("option"),l=$(t),e.__value=s=n[15].id,e.value=e.__value},m(i,r){g(i,e,r),a(e,l)},p(i,r){r&2&&t!==(t=i[15].title+"")&&H(l,t),r&2&&s!==(s=i[15].id)&&(e.__value=s,e.value=e.__value)},d(i){i&&m(e)}}}function Lt(n){let e,t=n[15].title+"",l,s;return{c(){e=f("option"),l=$(t),e.__value=s=n[15].id,e.value=e.__value,e.selected=!0},m(i,r){g(i,e,r),a(e,l)},p(i,r){r&2&&t!==(t=i[15].title+"")&&H(l,t),r&2&&s!==(s=i[15].id)&&(e.__value=s,e.value=e.__value)},d(i){i&&m(e)}}}function Ye(n){let e;function t(i,r){return i[15].id==G.feed?Lt:Mt}let l=t(n),s=l(n);return{c(){s.c(),e=dt()},m(i,r){s.m(i,r),g(i,e,r)},p(i,r){l===(l=t(i))&&s?s.p(i,r):(s.d(1),s=l(i),s&&(s.c(),s.m(e.parentNode,e)))},d(i){s.d(i),i&&m(e)}}}function He(n){let e,t=n[0].length+"",l,s;return{c(){e=$("("),l=$(t),s=$(")")},m(i,r){g(i,e,r),g(i,l,r),g(i,s,r)},p(i,r){r&1&&t!==(t=i[0].length+"")&&H(l,t)},d(i){i&&m(e),i&&m(l),i&&m(s)}}}function Ke(n){let e,t=n[0],l=[];for(let s=0;s<t.length;s+=1)l[s]=We(Ge(n,t,s));return{c(){e=f("ul");for(let s=0;s<l.length;s+=1)l[s].c();b(e,"class","svelte-1qi545v")},m(s,i){g(s,e,i);for(let r=0;r<l.length;r+=1)l[r].m(e,null)},p(s,i){if(i&1){t=s[0];let r;for(r=0;r<t.length;r+=1){const o=Ge(s,t,r);l[r]?l[r].p(o,i):(l[r]=We(o),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(s){s&&m(e),Xe(l,s)}}}function Je(n){let e;return{c(){e=$("\xA0(read)")},m(t,l){g(t,e,l)},d(t){t&&m(e)}}}function We(n){let e,t,l,s,i,r=n[12].title+"",o,u,c,h,d=n[12].feed.title+"",k,C,S,v=ge(n[12].published_at)+"",x,B,P=ge(n[12].changed_at)+"",z,T,N,V,w;function E(...j){return n[9](n[12],...j)}let y=n[12].status=="read"&&Je();function J(...j){return n[10](n[12],...j)}return{c(){e=f("li"),t=f("button"),t.textContent="x",l=A(),s=f("a"),i=f("h2"),o=$(r),y&&y.c(),u=A(),c=f("em"),h=$("From "),k=$(d),C=$(" published "),S=f("date"),x=$(v),B=$(", changed: "),z=$(P),N=A(),b(t,"class","close svelte-1qi545v"),b(i,"class","svelte-1qi545v"),b(c,"class","svelte-1qi545v"),b(s,"href",T="article/"+n[12].id),b(s,"class","svelte-1qi545v"),b(e,"class","svelte-1qi545v")},m(j,L){g(j,e,L),a(e,t),a(e,l),a(e,s),a(s,i),a(i,o),y&&y.m(i,null),a(s,u),a(s,c),a(c,h),a(c,k),a(c,C),a(c,S),a(S,x),a(S,B),a(S,z),a(e,N),V||(w=[q(t,"click",E),q(s,"click",fe(J))],V=!0)},p(j,L){n=j,L&1&&r!==(r=n[12].title+"")&&H(o,r),n[12].status=="read"?y||(y=Je(),y.c(),y.m(i,null)):y&&(y.d(1),y=null),L&1&&d!==(d=n[12].feed.title+"")&&H(k,d),L&1&&v!==(v=ge(n[12].published_at)+"")&&H(x,v),L&1&&P!==(P=ge(n[12].changed_at)+"")&&H(z,P),L&1&&T!==(T="article/"+n[12].id)&&b(s,"href",T)},d(j){j&&m(e),y&&y.d(),V=!1,K(w)}}}function Nt(n){let e,t,l,s,i,r,o,u,c,h,d,k,C,S,v,x,B,P,z,T,N,V,w,E,y,J,j,L,Y,F=I.age!=null&&Rt(n),M=n[1]&&Ue(n);c=new st({});let _=n[0]&&He(n),D=n[0]&&Ke(n);return{c(){e=f("main"),t=f("nav"),l=f("span"),F&&F.c(),s=A(),i=f("button"),i.textContent="\u{1F5D8}",r=A(),o=f("span"),M&&M.c(),u=A(),_e(c.$$.fragment),h=A(),d=f("h1"),k=$("Articles"),_&&_.c(),C=A(),S=f("nav"),v=f("span"),x=f("button"),x.textContent="Read",B=$(`
            /
            `),P=f("button"),P.textContent="Unread",z=A(),T=f("span"),N=f("label"),N.textContent="Sort:",V=A(),w=f("select"),E=f("option"),E.textContent="Latest",y=f("option"),y.textContent="Oldest",J=A(),D&&D.c(),b(t,"class","svelte-1qi545v"),b(N,"for","sort"),E.__value="latest",E.value=E.__value,y.__value="oldest",y.value=y.__value,b(w,"name","sort"),b(w,"class","svelte-1qi545v"),b(S,"class","svelte-1qi545v")},m(R,ne){g(R,e,ne),a(e,t),a(t,l),F&&F.m(l,null),a(l,s),a(l,i),a(t,r),a(t,o),M&&M.m(o,null),a(e,u),re(c,e,null),a(e,h),a(e,d),a(d,k),_&&_.m(d,null),a(e,C),a(e,S),a(S,v),a(v,x),a(v,B),a(v,P),a(S,z),a(S,T),a(T,N),a(T,V),a(T,w),a(w,E),a(w,y),a(e,J),D&&D.m(e,null),j=!0,L||(Y=[q(i,"click",n[4]),q(x,"click",n[6]),q(P,"click",n[7]),q(w,"change",n[8])],L=!0)},p(R,[ne]){I.age!=null&&F.p(R,ne),R[1]?M?M.p(R,ne):(M=Ue(R),M.c(),M.m(o,null)):M&&(M.d(1),M=null),R[0]?_?_.p(R,ne):(_=He(R),_.c(),_.m(d,null)):_&&(_.d(1),_=null),R[0]?D?D.p(R,ne):(D=Ke(R),D.c(),D.m(e,null)):D&&(D.d(1),D=null)},i(R){j||(U(c.$$.fragment,R),j=!0)},o(R){W(c.$$.fragment,R),j=!1},d(R){R&&m(e),F&&F.d(),M&&M.d(),oe(c),_&&_.d(),D&&D.d(),L=!1,K(Y)}}}function it(n){return Math.round((new Date().getTime()-n.getTime())/1e3/3600/24)}function ge(n){return n.toLocaleDateString("en-GB",{month:"short",day:"numeric",year:"numeric"})}function zt(n,e,t){let l=null,s=null,{force_sync:i=!1}=e;async function r(){if(!se.connected){console.log("Client not connected - redirecting to Connect"),wt("Connect",{force_sync:!0});return}G.feed==0&&(await I.update_feeds(await se.get_feeds()),t(1,s=await I.get_feeds()),await I.clear()),await se.sync(await I.get_entries());let v=await se.query(G);return I.update(v.entries)}async function o(v=!1){(I.age==null||v||i)&&(t(3,i=!1),await r()),s||t(1,s=await I.get_feeds()),t(0,l=await I.query(G))}qe(async()=>{await I.connect(),o()});const u=()=>{o(!0)},c=v=>{G.setFeed(parseInt(v.target.value)),o()},h=v=>{G.setStatus("read"),o()},d=v=>{G.setStatus("unread"),o()},k=v=>{v.target.value=="latest"?G.setDirectionDesc():G.setDirectionAsc(),o()},C=(v,x)=>{I.mark(v.id,"REMOVED"),x.currentTarget.parentElement.remove()},S=(v,x)=>ae("Article",{id:v.id});return n.$$set=v=>{"force_sync"in v&&t(3,i=v.force_sync)},[l,s,o,i,u,c,h,d,k,C,S]}class Vt extends me{constructor(e){super(),pe(this,e,zt,Nt,ie,{force_sync:3})}}function Ze(n){let e,t,l,s,i,r,o,u,c,h,d=n[1].title+"",k,C,S=n[1].status+"",v,x,B,P,z=n[1].content+"",T,N,V,w,E,y,J,j,L,Y,F,M;return e=new st({}),{c(){_e(e.$$.fragment),t=A(),l=f("nav"),s=f("button"),s.textContent="\u{1F519} Articles",i=A(),r=f("button"),r.textContent="\u{1F44B} Delete",o=A(),u=f("button"),u.textContent="Next \u{1F8A5}",c=A(),h=f("h1"),k=$(d),C=$(" ("),v=$(S),x=$(")"),B=A(),P=f("article"),T=A(),N=f("br"),V=A(),w=f("nav"),E=f("button"),E.textContent="\u{1F519} Articles",y=A(),J=f("button"),J.textContent="\u{1F44B} Delete",j=A(),L=f("button"),L.textContent="Next \u{1F8A5}",b(l,"class","svelte-10vigfk"),b(w,"id","nav-bottom"),b(w,"class","svelte-10vigfk")},m(_,D){re(e,_,D),g(_,t,D),g(_,l,D),a(l,s),a(l,i),a(l,r),a(l,o),a(l,u),g(_,c,D),g(_,h,D),a(h,k),a(h,C),a(h,v),a(h,x),g(_,B,D),g(_,P,D),P.innerHTML=z,g(_,T,D),g(_,N,D),g(_,V,D),g(_,w,D),a(w,E),a(w,y),a(w,J),a(w,j),a(w,L),Y=!0,F||(M=[q(s,"click",n[3]),q(r,"click",n[4]),q(u,"click",n[5]),q(E,"click",n[6]),q(J,"click",n[7]),q(L,"click",n[8])],F=!0)},p(_,D){(!Y||D&2)&&d!==(d=_[1].title+"")&&H(k,d),(!Y||D&2)&&S!==(S=_[1].status+"")&&H(v,S),(!Y||D&2)&&z!==(z=_[1].content+"")&&(P.innerHTML=z)},i(_){Y||(U(e.$$.fragment,_),Y=!0)},o(_){W(e.$$.fragment,_),Y=!1},d(_){oe(e,_),_&&m(t),_&&m(l),_&&m(c),_&&m(h),_&&m(B),_&&m(P),_&&m(T),_&&m(N),_&&m(V),_&&m(w),F=!1,K(M)}}}function Bt(n){let e,t,l=n[1]&&Ze(n);return{c(){e=f("main"),l&&l.c()},m(s,i){g(s,e,i),l&&l.m(e,null),t=!0},p(s,[i]){s[1]?l?(l.p(s,i),i&2&&U(l,1)):(l=Ze(s),l.c(),U(l,1),l.m(e,null)):l&&(tt(),W(l,1,1,()=>{l=null}),nt())},i(s){t||(U(l),t=!0)},o(s){W(l),t=!1},d(s){s&&m(e),l&&l.d()}}}function Gt(n,e,t){let{id:l}=e,s=null;async function i(){t(1,s=await I.get_entry(l))}function r(C){window.scroll(0,0),t(1,s=C)}qe(i);const o=()=>ae("Articles"),u=()=>{I.mark(l,"REMOVED"),ae("Articles")},c=()=>{I.next_article(s,G).then(r)},h=()=>{I.mark(s.id,"READ"),ae("Articles")},d=()=>{I.mark(s.id,"REMOVED"),I.next_article(s,G).then(r)},k=()=>{I.mark(s.id,"READ"),I.next_article(s,G).then(r)};return n.$$set=C=>{"id"in C&&t(0,l=C.id)},[l,s,r,o,u,c,h,d,k]}class Ft extends me{constructor(e){super(),pe(this,e,Gt,Bt,ie,{id:0})}}function Ut(n){let e,t;return{c(){e=$("Unknown page "),t=$(n[0])},m(l,s){g(l,e,s),g(l,t,s)},p(l,s){s&1&&H(t,l[0])},i:O,o:O,d(l){l&&m(e),l&&m(t)}}}function Yt(n){let e,t;return e=new Vt({}),{c(){_e(e.$$.fragment)},m(l,s){re(e,l,s),t=!0},p:O,i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){oe(e,l)}}}function Ht(n){let e,t;return e=new Ft({props:{id:n[1].id}}),{c(){_e(e.$$.fragment)},m(l,s){re(e,l,s),t=!0},p(l,s){const i={};s&2&&(i.id=l[1].id),e.$set(i)},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){oe(e,l)}}}function Kt(n){let e,t;return e=new Pt({}),{c(){_e(e.$$.fragment)},m(l,s){re(e,l,s),t=!0},p:O,i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){oe(e,l)}}}function Jt(n){let e,t,l,s;const i=[Kt,Ht,Yt,Ut],r=[];function o(u,c){return u[0]=="Connect"?0:u[0]=="Article"?1:u[0]=="Articles"?2:3}return t=o(n),l=r[t]=i[t](n),{c(){e=f("main"),l.c()},m(u,c){g(u,e,c),r[t].m(e,null),s=!0},p(u,[c]){let h=t;t=o(u),t===h?r[t].p(u,c):(tt(),W(r[h],1,1,()=>{r[h]=null}),nt(),l=r[t],l?l.p(u,c):(l=r[t]=i[t](u),l.c()),U(l,1),l.m(e,null))},i(u){s||(U(l),s=!0)},o(u){W(l),s=!1},d(u){u&&m(e),r[t].d()}}}function Wt(n,e,t){let l,s;return Ee(n,te,i=>t(0,l=i)),Ee(n,Ce,i=>t(1,s=i)),ae("Articles"),[l,s]}class Zt extends me{constructor(e){super(),pe(this,e,Wt,Jt,ie,{})}}new Zt({target:document.getElementById("app")});
