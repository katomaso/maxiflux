var ct=Object.defineProperty;var ut=(n,e,t)=>e in n?ct(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var b=(n,e,t)=>(ut(n,typeof e!="symbol"?e+"":e,t),t),at=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var Ne=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var ze=(n,e,t)=>(at(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function E(){}function ft(n){return n&&typeof n=="object"&&typeof n.then=="function"}function nt(n){return n()}function Ve(){return Object.create(null)}function W(n){n.forEach(nt)}function dt(n){return typeof n=="function"}function oe(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function _t(n){return Object.keys(n).length===0}function pt(n,...e){if(n==null)return E;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Ae(n,e,t){n.$$.on_destroy.push(pt(e,t))}function a(n,e){n.appendChild(e)}function v(n,e,t){n.insertBefore(e,t||null)}function m(n){n.parentNode.removeChild(n)}function lt(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function d(n){return document.createElement(n)}function y(n){return document.createTextNode(n)}function A(){return y(" ")}function ht(){return y("")}function q(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function de(n){return function(e){return e.preventDefault(),n.call(this,e)}}function mt(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function w(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function gt(n){return Array.from(n.childNodes)}function Y(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function X(n,e){n.value=e==null?"":e}let _e;function Q(n){_e=n}function rt(){if(!_e)throw new Error("Function called outside component initialization");return _e}function Re(n){rt().$$.on_mount.push(n)}const ae=[],Be=[],ke=[],Ge=[],bt=Promise.resolve();let Pe=!1;function vt(){Pe||(Pe=!0,bt.then(Te))}function Ie(n){ke.push(n)}const Ee=new Set;let be=0;function Te(){const n=_e;do{for(;be<ae.length;){const e=ae[be];be++,Q(e),kt(e.$$)}for(Q(null),ae.length=0,be=0;Be.length;)Be.pop()();for(let e=0;e<ke.length;e+=1){const t=ke[e];Ee.has(t)||(Ee.add(t),t())}ke.length=0}while(ae.length);for(;Ge.length;)Ge.pop()();Pe=!1,Ee.clear(),Q(n)}function kt(n){if(n.fragment!==null){n.update(),W(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Ie)}}const we=new Set;let le;function je(){le={r:0,c:[],p:le}}function Me(){le.r||W(le.c),le=le.p}function F(n,e){n&&n.i&&(we.delete(n),n.i(e))}function J(n,e,t,l){if(n&&n.o){if(we.has(n))return;we.add(n),le.c.push(()=>{we.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function wt(n,e){const t=e.token={};function l(r,s,i,u){if(e.token!==t)return;e.resolved=u;let c=e.ctx;i!==void 0&&(c=c.slice(),c[i]=u);const o=r&&(e.current=r)(c);let p=!1;e.block&&(e.blocks?e.blocks.forEach((f,_)=>{_!==s&&f&&(je(),J(f,1,1,()=>{e.blocks[_]===f&&(e.blocks[_]=null)}),Me())}):e.block.d(1),o.c(),F(o,1),o.m(e.mount(),e.anchor),p=!0),e.block=o,e.blocks&&(e.blocks[s]=o),p&&Te()}if(ft(n)){const r=rt();if(n.then(s=>{Q(r),l(e.then,1,e.value,s),Q(null)},s=>{if(Q(r),l(e.catch,2,e.error,s),Q(null),!e.hasCatch)throw s}),e.current!==e.pending)return l(e.pending,0),!0}else{if(e.current!==e.then)return l(e.then,1,e.value,n),!0;e.resolved=n}}function yt(n,e,t){const l=e.slice(),{resolved:r}=n;n.current===n.then&&(l[n.value]=r),n.current===n.catch&&(l[n.error]=r),n.block.p(l,t)}function pe(n){n&&n.c()}function ce(n,e,t,l){const{fragment:r,on_mount:s,on_destroy:i,after_update:u}=n.$$;r&&r.m(e,t),l||Ie(()=>{const c=s.map(nt).filter(dt);i?i.push(...c):W(c),n.$$.on_mount=[]}),u.forEach(Ie)}function ue(n,e){const t=n.$$;t.fragment!==null&&(W(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function $t(n,e){n.$$.dirty[0]===-1&&(ae.push(n),vt(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function he(n,e,t,l,r,s,i,u=[-1]){const c=_e;Q(n);const o=n.$$={fragment:null,ctx:null,props:s,update:E,not_equal:r,bound:Ve(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Ve(),dirty:u,skip_bound:!1,root:e.target||c.$$.root};i&&i(o.root);let p=!1;if(o.ctx=t?t(n,e.props||{},(f,_,...D)=>{const g=D.length?D[0]:_;return o.ctx&&r(o.ctx[f],o.ctx[f]=g)&&(!o.skip_bound&&o.bound[f]&&o.bound[f](g),p&&$t(n,f)),_}):[],o.update(),p=!0,W(o.before_update),o.fragment=l?l(o.ctx):!1,e.target){if(e.hydrate){const f=gt(e.target);o.fragment&&o.fragment.l(f),f.forEach(m)}else o.fragment&&o.fragment.c();e.intro&&F(n.$$.fragment),ce(n,e.target,e.anchor,e.customElement),Te()}Q(c)}class me{$destroy(){ue(this,1),this.$destroy=E}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const r=l.indexOf(t);r!==-1&&l.splice(r,1)}}$set(e){this.$$set&&!_t(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const se=[];function De(n,e=E){let t;const l=new Set;function r(u){if(oe(n,u)&&(n=u,t)){const c=!se.length;for(const o of l)o[1](),se.push(o,n);if(c){for(let o=0;o<se.length;o+=2)se[o][0](se[o+1]);se.length=0}}}function s(u){r(u(n))}function i(u,c=E){const o=[u,c];return l.add(o),l.size===1&&(t=e(r)||E),u(n),()=>{l.delete(o),l.size===0&&(t(),t=null)}}return{set:r,update:s,subscribe:i}}const re=De(""),qe=De({}),Se=De(""),Le=De({});let Oe;re.subscribe(n=>{Oe=n,console.log("router.page changed to ",Oe)});let ye;Se.subscribe(n=>{ye=n,console.log("router.next changed to ",ye)});let xe;Le.subscribe(n=>{xe=n,console.log("router._next_params changed to ",xe)});function fe(n,e){if(ye){Se.set(null),Le.set(null),qe.set(xe),re.set(ye);return}qe.set(e),re.set(n)}function Dt(n,e){Se.set(Oe),Le.set(e),re.set(n)}let ne=n=>n!=null?n.replace('"','\\"').replace("'","\\'"):null;class St extends Error{}class Et extends Error{}class Ct{constructor(){b(this,"url");b(this,"username");b(this,"connected",!1);b(this,"offline",!1);b(this,"authorization");b(this,"get",e=>this.request(e,null,"GET"));b(this,"put",(e,t)=>this.request(e,t,"PUT"));b(this,"post",(e,t)=>this.request(e,t,"POST"));b(this,"delete",e=>this.request(e,null,"DELETE"));b(this,"discover",e=>this.post("/v1/discover",`{"url":"${e}"}`));b(this,"feeds",()=>this.get("/v1/feeds"));b(this,"get_feed",e=>this.get(`/v1/feeds/${e}`));b(this,"get_feed_icon",e=>this.get(`/v1/feeds/${e}/icon`));b(this,"create_feed",(e,t)=>{let l=`{"feed_url": "${e}"`;return t!==0&&(l+=', "category_id": ',l+=t),l+="}",this.post("/v1/feeds",l)});b(this,"update_feed",(e,t,l)=>{if(t=ne(t),t==null&&l==null)return new Promise((s,i)=>i("No title or category specified"));let r="{";return t!=null&&(r+=`"title": "${ne(t)}"`),l!=null&&(t!=null&&(r+=","),r+=`"category": {"id": ${l}}`),r+="}",this.put(`/v1/feeds/${e}`,r)});b(this,"refresh_feed",e=>this.put(`/v1/feeds/${e}/refresh`));b(this,"remove_feed",e=>this.delete(`/v1/feeds/${e}`));b(this,"get_feed_entry",(e,t)=>this.get(`/v1/feeds/${e}/entries/${t}`));b(this,"get_entry",e=>this.get(`/v1/entries/${e}`));b(this,"get_feed_entries",(e,t)=>{let l=[];t!=null&&(t.status!=null&&l.push(`status=${t.status}`),t.offset!=null&&l.push(`offset=${t.offset}`),t.limit!=null&&l.push(`limit=${t.limit}`),t.direction!=null&&l.push(`direction=${t.direction}`),t.order!=null&&l.push(`order=${t.order}`));let r=`/v1/feeds/${e}/entries`;return l.length>0&&(r+="?",r+=l.join("&")),this.get(r)});b(this,"get_entries",e=>{let t=[];e!=null&&(e.status!=null&&t.push(`status=${e.status}`),e.offset!=null&&t.push(`offset=${e.offset}`),e.limit!=null&&t.push(`limit=${e.limit}`),e.direction!=null&&t.push(`direction=${e.direction}`),e.order!=null&&t.push(`order=${e.order}`));let l="/v1/entries";return t.length>0&&(l+="?",l+=t.join("&")),this.get(l)});b(this,"update_entries",(e,t)=>this.put("/v1/entries",`{"entry_ids": [${e.join(",")}], "status": "${ne(t)}"}`));b(this,"toggle_bookmark",e=>this.put(`/v1/entries/${e}/bookmark`));b(this,"categories",()=>this.get("/v1/categories"));b(this,"create_category",e=>this.post("/v1/categories",`{"title": "${ne(e)}"}`));b(this,"update_category",(e,t)=>this.put(`/v1/categories/${e}`,`{"title": "${ne(t)}"}`));b(this,"delete_category",e=>this.delete(`/v1/categories/${e}`));b(this,"ompl_export",()=>this.get("/v1/export"));b(this,"create_user",(e,t,l)=>this.post("/v1/users",`{"username":"${ne(e)}", "password:": "${ne(t)}", "is_admin": ${l}}`));b(this,"update_user",(e,t)=>this.put(`/v1/users/${e}`,t));b(this,"users",()=>this.get("/v1/users"));b(this,"get_user",e=>this.get(`/v1/users/${e}`));b(this,"get_me",()=>this.get(`/v1/users/${this.username}`));b(this,"delete_user",e=>this.delete(`/v1/users/${e}`))}async connect(e,t,l){return this.connected?!0:(this.url=e,this.username=t,this.authorization=`Basic ${btoa(t+":"+l)}`,this.connected=await this.get_me().then(r=>r!=null),this.connected)}is_connected(){return this.connected}is_offline(){return this.offline}request(e,t=null,l="GET"){let r={method:l,headers:{Authorization:this.authorization}};return t!=null&&(typeof t=="object"&&(t=JSON.stringify(t)),r.body=t),fetch(new Request(this.url+e,r)).catch(s=>{throw this.offline=!0,new Et("you are offline")}).then(s=>{if(this.offline=!1,!s.ok)throw s.status==401?new St("invalid credentials"):new Error(`${s.status}: ${s.statusText}`);return s.status==200||s.status==201?s.json():null})}}var ee;(function(n){n.READ="read",n.UNREAD="unread",n.REMOVED="removed"})(ee||(ee={}));var Fe;(function(n){n.ID="id",n.STATUS="status",n.PUBLISHED_AT="published_at",n.CATEGORY_TITLE="category_title",n.CATEGORY_ID="category_id"})(Fe||(Fe={}));var Ue;(function(n){n.ASCENDING="asc",n.DESCENDING="desc"})(Ue||(Ue={}));var $e,st;class At{constructor(){Ne(this,$e);b(this,"miniflux");this.miniflux=new Ct}async connect(e,t,l){return this.miniflux.connect(e,t,l)}get connected(){return this.miniflux.is_connected()}get offline(){return this.miniflux.is_offline()}mark_read(e){this.miniflux.update_entries([e],ee.READ)}async query(e){return e.feed>0?this.miniflux.get_feed_entries(e.feed,{order:"published_at",direction:e.directionDesc?"desc":"asc",limit:100}):this.miniflux.get_entries(ze(this,$e,st).call(this,e))}async sync(e){let t=[],l=[];for(let r of e)r.status==ee.READ&&t.push(r.id),r.status==ee.REMOVED&&l.push(r.id);t.length>0&&await this.miniflux.update_entries(t,ee.READ),l.length>0&&await this.miniflux.update_entries(l,ee.REMOVED)}async get_feeds(){return this.miniflux.feeds()}}$e=new WeakSet,st=function(e){return{status:e.status,order:"published_at",direction:e.directionDesc?"desc":"asc",limit:100}};let ie=new At;function Ye(n){let e,t,l;function r(u,c){return ie.offline?It:Pt}let i=r()(n);return{c(){e=d("br"),t=d("em"),i.c(),l=d("br"),w(t,"class","error")},m(u,c){v(u,e,c),v(u,t,c),i.m(t,null),v(u,l,c)},p(u,c){i.p(u,c)},d(u){u&&m(e),u&&m(t),i.d(),u&&m(l)}}}function Pt(n){let e;return{c(){e=y("Login failed")},m(t,l){v(t,e,l)},p:E,d(t){t&&m(e)}}}function It(n){let e,t,l,r;return{c(){e=y("You are offline "),t=d("button"),t.textContent="Go back"},m(s,i){v(s,e,i),v(s,t,i),l||(r=q(t,"click",n[10]),l=!0)},p:E,d(s){s&&m(e),s&&m(t),l=!1,r()}}}function qt(n){let e,t,l,r,s,i,u,c,o,p,f,_,D,g,k,O,B,P,z,T,N,V,$=n[4]&&Ye(n);return{c(){e=d("main"),t=d("form"),l=d("label"),l.textContent="Server",r=d("input"),s=d("br"),i=A(),u=d("label"),u.textContent="Username",c=d("input"),o=d("br"),p=A(),f=d("label"),f.textContent="Password",_=d("input"),D=d("br"),g=A(),$&&$.c(),k=A(),O=d("input"),B=A(),P=d("input"),z=y(`\xA0Zapamatovat heslo
        `),T=d("br"),w(l,"for","url"),w(l,"class","svelte-9inz0g"),w(r,"type","text"),w(r,"name","url"),w(u,"for","username"),w(u,"class","svelte-9inz0g"),w(c,"type","text"),w(c,"name","username"),w(f,"for","password"),w(f,"class","svelte-9inz0g"),w(_,"type","password"),w(_,"name","password"),w(O,"type","submit"),O.value="Connect",w(P,"type","checkbox"),w(P,"name","remember"),w(t,"method","POST")},m(C,S){v(C,e,S),a(e,t),a(t,l),a(t,r),X(r,n[0]),a(t,s),a(t,i),a(t,u),a(t,c),X(c,n[1]),a(t,o),a(t,p),a(t,f),a(t,_),X(_,n[2]),a(t,D),a(t,g),$&&$.m(t,null),a(t,k),a(t,O),a(t,B),a(t,P),X(P,n[3]),a(t,z),a(t,T),N||(V=[q(r,"input",n[7]),q(c,"input",n[8]),q(_,"input",n[9]),q(O,"click",mt(de(n[6]))),q(P,"change",n[11]),q(t,"submit",de(n[6]))],N=!0)},p(C,[S]){S&1&&r.value!==C[0]&&X(r,C[0]),S&2&&c.value!==C[1]&&X(c,C[1]),S&4&&_.value!==C[2]&&X(_,C[2]),C[4]?$?$.p(C,S):($=Ye(C),$.c(),$.m(t,k)):$&&($.d(1),$=null),S&8&&X(P,C[3])},i:E,o:E,d(C){C&&m(e),$&&$.d(),N=!1,W(V)}}}function Ot(n,e,t){let l;Ae(n,Se,k=>t(5,l=k));let r=localStorage.getItem("login_url")||"https://",s=localStorage.getItem("login_username"),i="",u=localStorage.getItem("login_remember")=="yes",c=null;async function o(k){if(r.startsWith("https://")||t(0,r="https://"+r),i==""&&(t(2,i=localStorage.getItem("login_password")),i==""))return;if(await ie.connect(r,s,i))return console.log("Successfuly logged in"),localStorage.setItem("login_last",new Date().toISOString()),localStorage.setItem("login_url",r),localStorage.setItem("login_username",s),u?(localStorage.setItem("login_remember","yes"),localStorage.setItem("login_password",i)):localStorage.setItem("login_remember","no"),re.set(l||"Articles");t(4,c=!0)}u&&Re(o);function p(){r=this.value,t(0,r)}function f(){s=this.value,t(1,s)}function _(){i=this.value,t(2,i)}const D=()=>re.set(l||"Articles");function g(){u=this.value,t(3,u)}return[r,s,i,u,c,l,o,p,f,_,D,g]}class xt extends me{constructor(e){super(),he(this,e,Ot,qt,oe,{})}}function Ce(n){return new Promise((e,t)=>{n.onsuccess=()=>{e(n.result)}})}class Rt{constructor(e){b(this,"dbPromise");b(this,"db",null);b(this,"status","unread");b(this,"index","status-age");b(this,"indexes",["status-age","feed-age"]);this.dbPromise=new Promise((t,l)=>{const r=indexedDB.open(e,1);r.onerror=s=>{},r.onupgradeneeded=s=>{const i=s.target.result,u=i.createObjectStore("articles",{keyPath:"id"});i.createObjectStore("feeds",{keyPath:"id"}),u.createIndex("status-age",["status","published_at"],{unique:!1}),u.createIndex("feed-age",["feed_id","published_at"],{unique:!1}),u.createIndex("updated-age","updated_at",{unique:!1})},r.onsuccess=function(s){t(s.target.result),console.log(`Cache ${e} ready`)}})}async connect(){return this.dbPromise.then(e=>{this.db=e})}async query(e){return this.dbPromise.then(t=>{const l=t.transaction(["articles"]).objectStore("articles");let r="status-age",s=IDBKeyRange.bound([e.status,new Date(0)],[e.status,new Date]);return e.feed>0&&(r="feed-age",s=IDBKeyRange.bound([e.feed,new Date(0)],[e.feed,new Date])),new Promise((i,u)=>{let c=[];l.index(r).openCursor(s,e.directionDesc?"prev":"next").onsuccess=o=>{const p=o.target.result;p?(c.push(p.value),p.continue()):i(c)}})})}async get_entry(e){return Ce(this.db.transaction(["articles"]).objectStore("articles").get(e))}async mark(e,t){if(t!="READ"&&t!="REMOVED")throw new Error("Must be READ or REMOVED");return this.dbPromise.then(l=>{const r=l.transaction(["articles"],"readwrite").objectStore("articles"),s=r.get(e);return console.log(`Marking article ${e} as ${t}`),new Promise((i,u)=>{s.onsuccess=()=>{let c=s.result;c.status=ee[t];let o=r.put(c);o.onsuccess=()=>{i()}}})})}async get_entries(){return this.dbPromise.then(e=>{const l=e.transaction(["articles"]).objectStore("articles").getAll();return new Promise((r,s)=>{l.onsuccess=()=>{r(l.result)}})})}async get_feeds(){return Ce(this.db.transaction(["feeds"]).objectStore("feeds").getAll())}async get_feed_categories(){let e=await this.get_feeds(),t={};for(let l of e)t[l.category.title]||(t[l.category.title]=[]),t[l.category.title].append(l);return t}async next_article(e,t){const l=await this.query(t);let r=!1;for(const s of l.entries){if(r)return s;r=s.id==e.id}return l.entries.at(-1)}async clear(){const t=(await this.dbPromise).transaction(["articles"],"readwrite").objectStore("articles");return new Promise((l,r)=>{t.clear().onsuccess=()=>{localStorage.removeItem("cache_updated"),console.log("Cache cleared")}})}async get_count(){return Ce(this.db.transaction(["articles"],"readwrite").objectStore("articles").count())}async update(e){const l=(await this.dbPromise).transaction(["articles"],"readwrite").objectStore("articles");console.log("Cache updating");function r(i){let u=i[0];for(let c=1;c<i.length;c++)i[c]>u&&(u=i[c]);return u}let s=new Date;return Promise.all(e.map(i=>new Promise((u,c)=>{i.published_at=new Date(i.published_at),i.changed_at=r([new Date(i.published_at),new Date(i.changed_at),new Date(i.created_at),new Date(i.modified)]),i.updated_at=s,l.add(i).onsuccess=()=>{u()}}))).then(i=>{console.log("Cache updated with",i.length,"records"),localStorage.setItem("cache_updated",s.toISOString())})}async update_feeds(e){const l=(await this.dbPromise).transaction(["feeds"],"readwrite").objectStore("feeds");return new Promise((r,s)=>{l.clear().onsuccess=r}).then(()=>Promise.all(e.map(r=>new Promise((s,i)=>{l.add(r).onsuccess=()=>{s()}})))).then(()=>localStorage.setItem("feeds_updated",new Date().toISOString()))}get age(){return localStorage.getItem("cache_updated")==null?null:new Date(localStorage.getItem("cache_updated"))}}const I=new Rt("maxiflux");class Tt{constructor(){b(this,"_status","unread");b(this,"_feed",0);b(this,"_desc",!0)}setDirectionDesc(){this._desc=!0}setDirectionAsc(){this._desc=!1}setStatus(e){this._status=e}setFeed(e){this._feed=e}get feed(){return this._feed}get status(){return this._status}get directionDesc(){return this._desc}}let G=new Tt;function jt(n){let e,t,l,r,s,i,u;return{c(){e=d("main"),t=d("div"),l=d("button"),l.textContent="\u25B2",r=A(),s=d("button"),s.textContent="\u25BC",w(l,"class","svelte-118eg67"),w(s,"class","svelte-118eg67"),w(t,"class","svelte-118eg67")},m(c,o){v(c,e,o),a(e,t),a(t,l),a(t,r),a(t,s),i||(u=[q(l,"click",de(n[0])),q(s,"click",de(n[1]))],i=!0)},p:E,i:E,o:E,d(c){c&&m(e),i=!1,W(u)}}}function He(n="up"){let e=Math.round(window.window.visualViewport.height*.9);n=="up"?window.scroll(0,window.scrollY-e):window.scroll(0,window.scrollY+e)}function Mt(n){return[()=>He("up"),()=>He("down")]}class it extends me{constructor(e){super(),he(this,e,Mt,jt,oe,{})}}function Ke(n,e,t){const l=n.slice();return l[12]=e[t],l}function Je(n,e,t){const l=n.slice();return l[16]=e[t],l}function Lt(n){let e,t;function l(i,u){return ot(I.age)>0?zt:Nt}let s=l()(n);return{c(){e=y("Last sync: "),s.c(),t=y(" ago |")},m(i,u){v(i,e,u),s.m(i,u),v(i,t,u)},p(i,u){s.p(i,u)},d(i){i&&m(e),s.d(i),i&&m(t)}}}function Nt(n){let e;return{c(){e=y("a moment")},m(t,l){v(t,e,l)},p:E,d(t){t&&m(e)}}}function zt(n){let e=ot(I.age)+"",t,l;return{c(){t=y(e),l=y(" days")},m(r,s){v(r,t,s),v(r,l,s)},p:E,d(r){r&&m(t),r&&m(l)}}}function We(n){let e,t,l,r,s,i,u=n[1],c=[];for(let o=0;o<u.length;o+=1)c[o]=Ze(Je(n,u,o));return{c(){e=d("label"),e.textContent="Feeds:",t=A(),l=d("select"),r=d("option"),r.textContent="All";for(let o=0;o<c.length;o+=1)c[o].c();w(e,"for","sort"),r.__value="0",r.value=r.__value,w(l,"name","feed"),w(l,"class","svelte-1qi545v")},m(o,p){v(o,e,p),v(o,t,p),v(o,l,p),a(l,r);for(let f=0;f<c.length;f+=1)c[f].m(l,null);s||(i=q(l,"change",n[5]),s=!0)},p(o,p){if(p&2){u=o[1];let f;for(f=0;f<u.length;f+=1){const _=Je(o,u,f);c[f]?c[f].p(_,p):(c[f]=Ze(_),c[f].c(),c[f].m(l,null))}for(;f<c.length;f+=1)c[f].d(1);c.length=u.length}},d(o){o&&m(e),o&&m(t),o&&m(l),lt(c,o),s=!1,i()}}}function Vt(n){let e,t=n[16].title+"",l,r;return{c(){e=d("option"),l=y(t),e.__value=r=n[16].id,e.value=e.__value},m(s,i){v(s,e,i),a(e,l)},p(s,i){i&2&&t!==(t=s[16].title+"")&&Y(l,t),i&2&&r!==(r=s[16].id)&&(e.__value=r,e.value=e.__value)},d(s){s&&m(e)}}}function Bt(n){let e,t=n[16].title+"",l,r;return{c(){e=d("option"),l=y(t),e.__value=r=n[16].id,e.value=e.__value,e.selected=!0},m(s,i){v(s,e,i),a(e,l)},p(s,i){i&2&&t!==(t=s[16].title+"")&&Y(l,t),i&2&&r!==(r=s[16].id)&&(e.__value=r,e.value=e.__value)},d(s){s&&m(e)}}}function Ze(n){let e;function t(s,i){return s[16].id==G.feed?Bt:Vt}let l=t(n),r=l(n);return{c(){r.c(),e=ht()},m(s,i){r.m(s,i),v(s,e,i)},p(s,i){l===(l=t(s))&&r?r.p(s,i):(r.d(1),r=l(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&m(e)}}}function Qe(n){let e,t=n[0].length+"",l,r;return{c(){e=y("("),l=y(t),r=y(")")},m(s,i){v(s,e,i),v(s,l,i),v(s,r,i)},p(s,i){i&1&&t!==(t=s[0].length+"")&&Y(l,t)},d(s){s&&m(e),s&&m(l),s&&m(r)}}}function Gt(n){let e;return{c(){e=y("No data - please hit sync button")},m(t,l){v(t,e,l)},p:E,d(t){t&&m(e)}}}function Ft(n){let e,t,l=n[0].length+"",r,s,i,u,c,o={ctx:n,current:null,token:null,hasCatch:!1,pending:Ht,then:Yt,catch:Ut,value:15};wt(I.get_count(),o);let p=n[0],f=[];for(let _=0;_<p.length;_+=1)f[_]=et(Ke(n,p,_));return{c(){e=d("em"),t=y("Showing "),r=y(l),s=y(" from "),o.block.c(),i=y(" cached records"),u=A(),c=d("ul");for(let _=0;_<f.length;_+=1)f[_].c();w(c,"class","svelte-1qi545v")},m(_,D){v(_,e,D),a(e,t),a(e,r),a(e,s),o.block.m(e,o.anchor=null),o.mount=()=>e,o.anchor=i,a(e,i),v(_,u,D),v(_,c,D);for(let g=0;g<f.length;g+=1)f[g].m(c,null)},p(_,D){if(n=_,D&1&&l!==(l=n[0].length+"")&&Y(r,l),yt(o,n,D),D&1){p=n[0];let g;for(g=0;g<p.length;g+=1){const k=Ke(n,p,g);f[g]?f[g].p(k,D):(f[g]=et(k),f[g].c(),f[g].m(c,null))}for(;g<f.length;g+=1)f[g].d(1);f.length=p.length}},d(_){_&&m(e),o.block.d(),o.token=null,o=null,_&&m(u),_&&m(c),lt(f,_)}}}function Ut(n){return{c:E,m:E,p:E,d:E}}function Yt(n){let e=n[15]+"",t;return{c(){t=y(e)},m(l,r){v(l,t,r)},p:E,d(l){l&&m(t)}}}function Ht(n){return{c:E,m:E,p:E,d:E}}function Xe(n){let e;return{c(){e=y("\xA0(read)")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function et(n){let e,t,l,r,s,i=n[12].title+"",u,c,o,p,f=n[12].feed.title+"",_,D,g,k=ve(n[12].published_at)+"",O,B,P=ve(n[12].changed_at)+"",z,T,N,V,$;function C(...j){return n[9](n[12],...j)}let S=n[12].status=="read"&&Xe();function Z(...j){return n[10](n[12],...j)}return{c(){e=d("li"),t=d("button"),t.textContent="x",l=A(),r=d("a"),s=d("h2"),u=y(i),S&&S.c(),c=A(),o=d("em"),p=y("From "),_=y(f),D=y(" published "),g=d("date"),O=y(k),B=y(", changed: "),z=y(P),N=A(),w(t,"class","close svelte-1qi545v"),w(s,"class","svelte-1qi545v"),w(o,"class","svelte-1qi545v"),w(r,"href",T="article/"+n[12].id),w(r,"class","svelte-1qi545v"),w(e,"class","svelte-1qi545v")},m(j,L){v(j,e,L),a(e,t),a(e,l),a(e,r),a(r,s),a(s,u),S&&S.m(s,null),a(r,c),a(r,o),a(o,p),a(o,_),a(o,D),a(o,g),a(g,O),a(g,B),a(g,z),a(e,N),V||($=[q(t,"click",C),q(r,"click",de(Z))],V=!0)},p(j,L){n=j,L&1&&i!==(i=n[12].title+"")&&Y(u,i),n[12].status=="read"?S||(S=Xe(),S.c(),S.m(s,null)):S&&(S.d(1),S=null),L&1&&f!==(f=n[12].feed.title+"")&&Y(_,f),L&1&&k!==(k=ve(n[12].published_at)+"")&&Y(O,k),L&1&&P!==(P=ve(n[12].changed_at)+"")&&Y(z,P),L&1&&T!==(T="article/"+n[12].id)&&w(r,"href",T)},d(j){j&&m(e),S&&S.d(),V=!1,W($)}}}function Kt(n){let e,t,l,r,s,i,u,c,o,p,f,_,D,g,k,O,B,P,z,T,N,V,$,C,S,Z,j,L,H,U=I.age!=null&&Lt(n),M=n[1]&&We(n);o=new it({});let h=n[0]&&Qe(n);function R(x,te){return x[0]?Ft:Gt}let ge=R(n),K=ge(n);return{c(){e=d("main"),t=d("nav"),l=d("span"),U&&U.c(),r=A(),s=d("button"),s.textContent="Sync \u2B73",i=A(),u=d("span"),M&&M.c(),c=A(),pe(o.$$.fragment),p=A(),f=d("h1"),_=y("Articles"),h&&h.c(),D=A(),g=d("nav"),k=d("span"),O=d("button"),O.textContent="Read",B=y(`
            /
            `),P=d("button"),P.textContent="Unread",z=A(),T=d("span"),N=d("label"),N.textContent="Sort:",V=A(),$=d("select"),C=d("option"),C.textContent="Latest",S=d("option"),S.textContent="Oldest",Z=A(),K.c(),w(t,"class","svelte-1qi545v"),w(N,"for","sort"),C.__value="latest",C.value=C.__value,S.__value="oldest",S.value=S.__value,w($,"name","sort"),w($,"class","svelte-1qi545v"),w(g,"class","svelte-1qi545v")},m(x,te){v(x,e,te),a(e,t),a(t,l),U&&U.m(l,null),a(l,r),a(l,s),a(t,i),a(t,u),M&&M.m(u,null),a(e,c),ce(o,e,null),a(e,p),a(e,f),a(f,_),h&&h.m(f,null),a(e,D),a(e,g),a(g,k),a(k,O),a(k,B),a(k,P),a(g,z),a(g,T),a(T,N),a(T,V),a(T,$),a($,C),a($,S),a(e,Z),K.m(e,null),j=!0,L||(H=[q(s,"click",n[4]),q(O,"click",n[6]),q(P,"click",n[7]),q($,"change",n[8])],L=!0)},p(x,[te]){I.age!=null&&U.p(x,te),x[1]?M?M.p(x,te):(M=We(x),M.c(),M.m(u,null)):M&&(M.d(1),M=null),x[0]?h?h.p(x,te):(h=Qe(x),h.c(),h.m(f,null)):h&&(h.d(1),h=null),ge===(ge=R(x))&&K?K.p(x,te):(K.d(1),K=ge(x),K&&(K.c(),K.m(e,null)))},i(x){j||(F(o.$$.fragment,x),j=!0)},o(x){J(o.$$.fragment,x),j=!1},d(x){x&&m(e),U&&U.d(),M&&M.d(),ue(o),h&&h.d(),K.d(),L=!1,W(H)}}}function ot(n){return Math.round((new Date().getTime()-n.getTime())/1e3/3600/24)}function ve(n){return n.toLocaleDateString("en-GB",{month:"short",day:"numeric",year:"numeric"})}function Jt(n,e,t){let l=null,r=null,{force_sync:s=!1}=e;async function i(){if(!ie.connected){console.log("Client not connected - redirecting to Connect"),Dt("Connect",{force_sync:!0});return}G.feed==0&&(await I.update_feeds(await ie.get_feeds()),t(1,r=await I.get_feeds()),await I.clear()),await ie.sync(await I.get_entries());let k=await ie.query(G);return I.update(k.entries)}async function u(k=!1){(I.age==null||k||s)&&(t(3,s=!1),await i()),r||t(1,r=await I.get_feeds()),t(0,l=await I.query(G))}Re(async()=>(await I.connect(),u()));const c=()=>{u(!0)},o=k=>{G.setFeed(parseInt(k.target.value)),u()},p=k=>{G.setStatus("read"),u()},f=k=>{G.setStatus("unread"),u()},_=k=>{k.target.value=="latest"?G.setDirectionDesc():G.setDirectionAsc(),u()},D=(k,O)=>{I.mark(k.id,"REMOVED"),O.currentTarget.parentElement.remove()},g=(k,O)=>fe("Article",{id:k.id});return n.$$set=k=>{"force_sync"in k&&t(3,s=k.force_sync)},[l,r,u,s,c,o,p,f,_,D,g]}class Wt extends me{constructor(e){super(),he(this,e,Jt,Kt,oe,{force_sync:3})}}function tt(n){let e,t,l,r,s,i,u,c,o,p,f=n[1].title+"",_,D,g=n[1].status+"",k,O,B,P,z=n[1].content+"",T,N,V,$,C,S,Z,j,L,H,U,M;return e=new it({}),{c(){pe(e.$$.fragment),t=A(),l=d("nav"),r=d("button"),r.textContent="\u{1F519} Articles",s=A(),i=d("button"),i.textContent="\u{1F44B} Delete",u=A(),c=d("button"),c.textContent="Next \u{1F8A5}",o=A(),p=d("h1"),_=y(f),D=y(" ("),k=y(g),O=y(")"),B=A(),P=d("article"),T=A(),N=d("br"),V=A(),$=d("nav"),C=d("button"),C.textContent="\u{1F519} Articles",S=A(),Z=d("button"),Z.textContent="\u{1F44B} Delete",j=A(),L=d("button"),L.textContent="Next \u{1F8A5}",w(l,"class","svelte-10vigfk"),w($,"id","nav-bottom"),w($,"class","svelte-10vigfk")},m(h,R){ce(e,h,R),v(h,t,R),v(h,l,R),a(l,r),a(l,s),a(l,i),a(l,u),a(l,c),v(h,o,R),v(h,p,R),a(p,_),a(p,D),a(p,k),a(p,O),v(h,B,R),v(h,P,R),P.innerHTML=z,v(h,T,R),v(h,N,R),v(h,V,R),v(h,$,R),a($,C),a($,S),a($,Z),a($,j),a($,L),H=!0,U||(M=[q(r,"click",n[3]),q(i,"click",n[4]),q(c,"click",n[5]),q(C,"click",n[6]),q(Z,"click",n[7]),q(L,"click",n[8])],U=!0)},p(h,R){(!H||R&2)&&f!==(f=h[1].title+"")&&Y(_,f),(!H||R&2)&&g!==(g=h[1].status+"")&&Y(k,g),(!H||R&2)&&z!==(z=h[1].content+"")&&(P.innerHTML=z)},i(h){H||(F(e.$$.fragment,h),H=!0)},o(h){J(e.$$.fragment,h),H=!1},d(h){ue(e,h),h&&m(t),h&&m(l),h&&m(o),h&&m(p),h&&m(B),h&&m(P),h&&m(T),h&&m(N),h&&m(V),h&&m($),U=!1,W(M)}}}function Zt(n){let e,t,l=n[1]&&tt(n);return{c(){e=d("main"),l&&l.c()},m(r,s){v(r,e,s),l&&l.m(e,null),t=!0},p(r,[s]){r[1]?l?(l.p(r,s),s&2&&F(l,1)):(l=tt(r),l.c(),F(l,1),l.m(e,null)):l&&(je(),J(l,1,1,()=>{l=null}),Me())},i(r){t||(F(l),t=!0)},o(r){J(l),t=!1},d(r){r&&m(e),l&&l.d()}}}function Qt(n,e,t){let{id:l}=e,r=null;async function s(){t(1,r=await I.get_entry(l))}function i(D){window.scroll(0,0),t(1,r=D)}Re(s);const u=()=>fe("Articles"),c=()=>{I.mark(l,"REMOVED"),fe("Articles")},o=()=>{I.next_article(r,G).then(i)},p=()=>{I.mark(r.id,"READ"),fe("Articles")},f=()=>{I.mark(r.id,"REMOVED"),I.next_article(r,G).then(i)},_=()=>{I.mark(r.id,"READ"),I.next_article(r,G).then(i)};return n.$$set=D=>{"id"in D&&t(0,l=D.id)},[l,r,i,u,c,o,p,f,_]}class Xt extends me{constructor(e){super(),he(this,e,Qt,Zt,oe,{id:0})}}function en(n){let e,t;return{c(){e=y("Unknown page "),t=y(n[0])},m(l,r){v(l,e,r),v(l,t,r)},p(l,r){r&1&&Y(t,l[0])},i:E,o:E,d(l){l&&m(e),l&&m(t)}}}function tn(n){let e,t;return e=new Wt({}),{c(){pe(e.$$.fragment)},m(l,r){ce(e,l,r),t=!0},p:E,i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){J(e.$$.fragment,l),t=!1},d(l){ue(e,l)}}}function nn(n){let e,t;return e=new Xt({props:{id:n[1].id}}),{c(){pe(e.$$.fragment)},m(l,r){ce(e,l,r),t=!0},p(l,r){const s={};r&2&&(s.id=l[1].id),e.$set(s)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){J(e.$$.fragment,l),t=!1},d(l){ue(e,l)}}}function ln(n){let e,t;return e=new xt({}),{c(){pe(e.$$.fragment)},m(l,r){ce(e,l,r),t=!0},p:E,i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){J(e.$$.fragment,l),t=!1},d(l){ue(e,l)}}}function rn(n){let e,t,l,r;const s=[ln,nn,tn,en],i=[];function u(c,o){return c[0]=="Connect"?0:c[0]=="Article"?1:c[0]=="Articles"?2:3}return t=u(n),l=i[t]=s[t](n),{c(){e=d("main"),l.c()},m(c,o){v(c,e,o),i[t].m(e,null),r=!0},p(c,[o]){let p=t;t=u(c),t===p?i[t].p(c,o):(je(),J(i[p],1,1,()=>{i[p]=null}),Me(),l=i[t],l?l.p(c,o):(l=i[t]=s[t](c),l.c()),F(l,1),l.m(e,null))},i(c){r||(F(l),r=!0)},o(c){J(l),r=!1},d(c){c&&m(e),i[t].d()}}}function sn(n,e,t){let l,r;return Ae(n,re,s=>t(0,l=s)),Ae(n,qe,s=>t(1,r=s)),fe("Articles"),[l,r]}class on extends me{constructor(e){super(),he(this,e,sn,rn,oe,{})}}new on({target:document.getElementById("app")});
