var it=Object.defineProperty;var rt=(n,e,t)=>e in n?it(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var m=(n,e,t)=>(rt(n,typeof e!="symbol"?e+"":e,t),t),ot=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var xe=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var Oe=(n,e,t)=>(ot(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function O(){}function Ze(n){return n()}function Re(){return Object.create(null)}function K(n){n.forEach(Ze)}function ut(n){return typeof n=="function"}function se(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function ct(n){return Object.keys(n).length===0}function at(n,...e){if(n==null)return O;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function De(n,e,t){n.$$.on_destroy.push(at(e,t))}function a(n,e){n.appendChild(e)}function b(n,e,t){n.insertBefore(e,t||null)}function h(n){n.parentNode.removeChild(n)}function Qe(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function f(n){return document.createElement(n)}function $(n){return document.createTextNode(n)}function A(){return $(" ")}function ft(){return $("")}function q(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function ae(n){return function(e){return e.preventDefault(),n.call(this,e)}}function dt(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function v(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function _t(n){return Array.from(n.childNodes)}function H(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function W(n,e){n.value=e==null?"":e}function pt(n,e,t,l){t===null?n.style.removeProperty(e):n.style.setProperty(e,t,l?"important":"")}let fe;function ue(n){fe=n}function mt(){if(!fe)throw new Error("Function called outside component initialization");return fe}function Ie(n){mt().$$.on_mount.push(n)}const oe=[],Te=[],ge=[],je=[],ht=Promise.resolve();let Ee=!1;function gt(){Ee||(Ee=!0,ht.then(Xe))}function Se(n){ge.push(n)}const $e=new Set;let me=0;function Xe(){const n=fe;do{for(;me<oe.length;){const e=oe[me];me++,ue(e),bt(e.$$)}for(ue(null),oe.length=0,me=0;Te.length;)Te.pop()();for(let e=0;e<ge.length;e+=1){const t=ge[e];$e.has(t)||($e.add(t),t())}ge.length=0}while(oe.length);for(;je.length;)je.pop()();Ee=!1,$e.clear(),ue(n)}function bt(n){if(n.fragment!==null){n.update(),K(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Se)}}const be=new Set;let X;function et(){X={r:0,c:[],p:X}}function tt(){X.r||K(X.c),X=X.p}function Y(n,e){n&&n.i&&(be.delete(n),n.i(e))}function J(n,e,t,l){if(n&&n.o){if(be.has(n))return;be.add(n),X.c.push(()=>{be.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function de(n){n&&n.c()}function ie(n,e,t,l){const{fragment:s,on_mount:i,on_destroy:r,after_update:o}=n.$$;s&&s.m(e,t),l||Se(()=>{const u=i.map(Ze).filter(ut);r?r.push(...u):K(u),n.$$.on_mount=[]}),o.forEach(Se)}function re(n,e){const t=n.$$;t.fragment!==null&&(K(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function vt(n,e){n.$$.dirty[0]===-1&&(oe.push(n),gt(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function _e(n,e,t,l,s,i,r,o=[-1]){const u=fe;ue(n);const c=n.$$={fragment:null,ctx:null,props:i,update:O,not_equal:s,bound:Re(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:Re(),dirty:o,skip_bound:!1,root:e.target||u.$$.root};r&&r(c.root);let d=!1;if(c.ctx=t?t(n,e.props||{},(g,_,...D)=>{const C=D.length?D[0]:_;return c.ctx&&s(c.ctx[g],c.ctx[g]=C)&&(!c.skip_bound&&c.bound[g]&&c.bound[g](C),d&&vt(n,g)),_}):[],c.update(),d=!0,K(c.before_update),c.fragment=l?l(c.ctx):!1,e.target){if(e.hydrate){const g=_t(e.target);c.fragment&&c.fragment.l(g),g.forEach(h)}else c.fragment&&c.fragment.c();e.intro&&Y(n.$$.fragment),ie(n,e.target,e.anchor,e.customElement),Xe()}ue(u)}class pe{$destroy(){re(this,1),this.$destroy=O}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const s=l.indexOf(t);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!ct(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ne=[];function ke(n,e=O){let t;const l=new Set;function s(o){if(se(n,o)&&(n=o,t)){const u=!ne.length;for(const c of l)c[1](),ne.push(c,n);if(u){for(let c=0;c<ne.length;c+=2)ne[c][0](ne[c+1]);ne.length=0}}}function i(o){s(o(n))}function r(o,u=O){const c=[o,u];return l.add(c),l.size===1&&(t=e(s)||O),o(n),()=>{l.delete(c),l.size===0&&(t(),t=null)}}return{set:s,update:i,subscribe:r}}const ee=ke(""),Ae=ke({}),ye=ke(""),qe=ke({});let Ce;ee.subscribe(n=>{Ce=n,console.log("router.page changed to ",Ce)});let ve;ye.subscribe(n=>{ve=n,console.log("router.next changed to ",ve)});let Pe;qe.subscribe(n=>{Pe=n,console.log("router._next_params changed to ",Pe)});function ce(n,e){if(ve){ye.set(null),qe.set(null),Ae.set(Pe),ee.set(ve);return}Ae.set(e),ee.set(n)}function wt(n,e){ye.set(Ce),qe.set(e),ee.set(n)}let Q=n=>n!=null?n.replace('"','\\"').replace("'","\\'"):null;class kt extends Error{}class yt extends Error{}class $t{constructor(){m(this,"url");m(this,"username");m(this,"connected",!1);m(this,"offline",!1);m(this,"authorization");m(this,"get",e=>this.request(e,null,"GET"));m(this,"put",(e,t)=>this.request(e,t,"PUT"));m(this,"post",(e,t)=>this.request(e,t,"POST"));m(this,"delete",e=>this.request(e,null,"DELETE"));m(this,"discover",e=>this.post("/v1/discover",`{"url":"${e}"}`));m(this,"feeds",()=>this.get("/v1/feeds"));m(this,"get_feed",e=>this.get(`/v1/feeds/${e}`));m(this,"get_feed_icon",e=>this.get(`/v1/feeds/${e}/icon`));m(this,"create_feed",(e,t)=>{let l=`{"feed_url": "${e}"`;return t!==0&&(l+=', "category_id": ',l+=t),l+="}",this.post("/v1/feeds",l)});m(this,"update_feed",(e,t,l)=>{if(t=Q(t),t==null&&l==null)return new Promise((i,r)=>r("No title or category specified"));let s="{";return t!=null&&(s+=`"title": "${Q(t)}"`),l!=null&&(t!=null&&(s+=","),s+=`"category": {"id": ${l}}`),s+="}",this.put(`/v1/feeds/${e}`,s)});m(this,"refresh_feed",e=>this.put(`/v1/feeds/${e}/refresh`));m(this,"remove_feed",e=>this.delete(`/v1/feeds/${e}`));m(this,"get_feed_entry",(e,t)=>this.get(`/v1/feeds/${e}/entries/${t}`));m(this,"get_entry",e=>this.get(`/v1/entries/${e}`));m(this,"get_feed_entries",(e,t)=>{let l=[];t!=null&&(t.status!=null&&l.push(`status=${t.status}`),t.offset!=null&&l.push(`offset=${t.offset}`),t.limit!=null&&l.push(`limit=${t.limit}`),t.direction!=null&&l.push(`direction=${t.direction}`),t.order!=null&&l.push(`order=${t.order}`));let s=`/v1/feeds/${e}/entries`;return l.length>0&&(s+="?",s+=l.join("&")),this.get(s)});m(this,"get_entries",e=>{let t=[];e!=null&&(e.status!=null&&t.push(`status=${e.status}`),e.offset!=null&&t.push(`offset=${e.offset}`),e.limit!=null&&t.push(`limit=${e.limit}`),e.direction!=null&&t.push(`direction=${e.direction}`),e.order!=null&&t.push(`order=${e.order}`));let l="/v1/entries";return t.length>0&&(l+="?",l+=t.join("&")),this.get(l)});m(this,"update_entries",(e,t)=>this.put("/v1/entries",`{"entry_ids": [${e.join(",")}], "status": "${Q(t)}"}`));m(this,"toggle_bookmark",e=>this.put(`/v1/entries/${e}/bookmark`));m(this,"categories",()=>this.get("/v1/categories"));m(this,"create_category",e=>this.post("/v1/categories",`{"title": "${Q(e)}"}`));m(this,"update_category",(e,t)=>this.put(`/v1/categories/${e}`,`{"title": "${Q(t)}"}`));m(this,"delete_category",e=>this.delete(`/v1/categories/${e}`));m(this,"ompl_export",()=>this.get("/v1/export"));m(this,"create_user",(e,t,l)=>this.post("/v1/users",`{"username":"${Q(e)}", "password:": "${Q(t)}", "is_admin": ${l}}`));m(this,"update_user",(e,t)=>this.put(`/v1/users/${e}`,t));m(this,"users",()=>this.get("/v1/users"));m(this,"get_user",e=>this.get(`/v1/users/${e}`));m(this,"get_me",()=>this.get(`/v1/users/${this.username}`));m(this,"delete_user",e=>this.delete(`/v1/users/${e}`))}async connect(e,t,l){return this.connected?!0:(this.url=e,this.username=t,this.authorization=`Basic ${btoa(t+":"+l)}`,this.connected=await this.get_me().then(s=>s!=null),this.connected)}is_connected(){return this.connected}is_offline(){return this.offline}request(e,t=null,l="GET"){let s={method:l,headers:{Authorization:this.authorization}};return t!=null&&(typeof t=="object"&&(t=JSON.stringify(t)),s.body=t),fetch(new Request(this.url+e,s)).catch(i=>{throw this.offline=!0,new yt("you are offline")}).then(i=>{if(this.offline=!1,!i.ok)throw i.status==401?new kt("invalid credentials"):new Error(`${i.status}: ${i.statusText}`);return i.status==200||i.status==201?i.json():null})}}var Z;(function(n){n.READ="read",n.UNREAD="unread",n.REMOVED="removed"})(Z||(Z={}));var Me;(function(n){n.ID="id",n.STATUS="status",n.PUBLISHED_AT="published_at",n.CATEGORY_TITLE="category_title",n.CATEGORY_ID="category_id"})(Me||(Me={}));var Le;(function(n){n.ASCENDING="asc",n.DESCENDING="desc"})(Le||(Le={}));var we,nt;class Dt{constructor(){xe(this,we);m(this,"miniflux");this.miniflux=new $t}async connect(e,t,l){return this.miniflux.connect(e,t,l)}get connected(){return this.miniflux.is_connected()}get offline(){return this.miniflux.is_offline()}mark_read(e){this.miniflux.update_entries([e],Z.READ)}async query(e){return e.feed>0?this.miniflux.get_feed_entries(e.feed,{order:"published_at",direction:e.directionDesc?"desc":"asc",limit:100}):this.miniflux.get_entries(Oe(this,we,nt).call(this,e))}async sync(e){let t=[],l=[];for(let s of e)s.status==Z.READ&&t.push(s.id),s.status==Z.REMOVED&&l.push(s.id);t.length>0&&await this.miniflux.update_entries(t,Z.READ),l.length>0&&await this.miniflux.update_entries(l,Z.REMOVED)}async get_feeds(){return this.miniflux.feeds()}}we=new WeakSet,nt=function(e){return{status:e.status,order:"published_at",direction:e.directionDesc?"desc":"asc",limit:100}};let le=new Dt;function Ne(n){let e,t,l;function s(o,u){return le.offline?St:Et}let r=s()(n);return{c(){e=f("br"),t=f("em"),r.c(),l=f("br"),v(t,"class","error")},m(o,u){b(o,e,u),b(o,t,u),r.m(t,null),b(o,l,u)},p(o,u){r.p(o,u)},d(o){o&&h(e),o&&h(t),r.d(),o&&h(l)}}}function Et(n){let e;return{c(){e=$("Login failed")},m(t,l){b(t,e,l)},p:O,d(t){t&&h(e)}}}function St(n){let e,t,l,s;return{c(){e=$("You are offline "),t=f("button"),t.textContent="Go back"},m(i,r){b(i,e,r),b(i,t,r),l||(s=q(t,"click",n[10]),l=!0)},p:O,d(i){i&&h(e),i&&h(t),l=!1,s()}}}function At(n){let e,t,l,s,i,r,o,u,c,d,g,_,D,C,w,x,G,E,L,B,R,j,k=n[4]&&Ne(n);return{c(){e=f("main"),t=f("form"),l=f("label"),l.textContent="Server",s=f("input"),i=f("br"),r=A(),o=f("label"),o.textContent="Username",u=f("input"),c=f("br"),d=A(),g=f("label"),g.textContent="Password",_=f("input"),D=f("br"),C=A(),k&&k.c(),w=A(),x=f("input"),G=A(),E=f("input"),L=$(`\xA0Zapamatovat heslo
        `),B=f("br"),v(l,"for","url"),v(l,"class","svelte-9inz0g"),v(s,"type","text"),v(s,"name","url"),v(o,"for","username"),v(o,"class","svelte-9inz0g"),v(u,"type","text"),v(u,"name","username"),v(g,"for","password"),v(g,"class","svelte-9inz0g"),v(_,"type","password"),v(_,"name","password"),v(x,"type","submit"),x.value="Connect",v(E,"type","checkbox"),v(E,"name","remember"),v(t,"method","POST")},m(P,S){b(P,e,S),a(e,t),a(t,l),a(t,s),W(s,n[0]),a(t,i),a(t,r),a(t,o),a(t,u),W(u,n[1]),a(t,c),a(t,d),a(t,g),a(t,_),W(_,n[2]),a(t,D),a(t,C),k&&k.m(t,null),a(t,w),a(t,x),a(t,G),a(t,E),W(E,n[3]),a(t,L),a(t,B),R||(j=[q(s,"input",n[7]),q(u,"input",n[8]),q(_,"input",n[9]),q(x,"click",dt(ae(n[6]))),q(E,"change",n[11]),q(t,"submit",ae(n[6]))],R=!0)},p(P,[S]){S&1&&s.value!==P[0]&&W(s,P[0]),S&2&&u.value!==P[1]&&W(u,P[1]),S&4&&_.value!==P[2]&&W(_,P[2]),P[4]?k?k.p(P,S):(k=Ne(P),k.c(),k.m(t,w)):k&&(k.d(1),k=null),S&8&&W(E,P[3])},i:O,o:O,d(P){P&&h(e),k&&k.d(),R=!1,K(j)}}}function Ct(n,e,t){let l;De(n,ye,w=>t(5,l=w));let s=localStorage.getItem("login_url")||"https://",i=localStorage.getItem("login_username"),r="",o=localStorage.getItem("login_remember")=="yes",u=null;async function c(w){if(s.startsWith("https://")||t(0,s="https://"+s),r==""&&(t(2,r=localStorage.getItem("login_password")),r==""))return;if(await le.connect(s,i,r))return console.log("Successfuly logged in"),localStorage.setItem("login_last",new Date().toISOString()),localStorage.setItem("login_url",s),localStorage.setItem("login_username",i),o?(localStorage.setItem("login_remember","yes"),localStorage.setItem("login_password",r)):localStorage.setItem("login_remember","no"),ee.set(l||"Articles");t(4,u=!0)}o&&Ie(c);function d(){s=this.value,t(0,s)}function g(){i=this.value,t(1,i)}function _(){r=this.value,t(2,r)}const D=()=>ee.set(l||"Articles");function C(){o=this.value,t(3,o)}return[s,i,r,o,u,l,c,d,g,_,D,C]}class Pt extends pe{constructor(e){super(),_e(this,e,Ct,At,se,{})}}function ze(n){return new Promise((e,t)=>{n.onsuccess=()=>{console.log("PromiseResult resolved: ",n.result),e(n.result)}})}class It{constructor(e){m(this,"dbPromise");m(this,"db",null);m(this,"status","unread");m(this,"index","status-age");m(this,"indexes",["status-age","feed-age"]);this.dbPromise=new Promise((t,l)=>{const s=indexedDB.open(e,1);s.onerror=i=>{},s.onupgradeneeded=i=>{const r=i.target.result,o=r.createObjectStore("articles",{keyPath:"id"});r.createObjectStore("feeds",{keyPath:"id"}),o.createIndex("status-age",["status","published_at"],{unique:!1}),o.createIndex("feed-age",["feed_id","published_at"],{unique:!1}),o.createIndex("updated-age","updated_at",{unique:!1})},s.onsuccess=function(i){t(i.target.result),console.log(`Cache ${e} ready`)}})}async connect(){return this.dbPromise.then(e=>{this.db=e})}async query(e){return this.dbPromise.then(t=>{const l=t.transaction(["articles"]).objectStore("articles");let s="status-age",i=IDBKeyRange.bound([e.status,new Date(0)],[e.status,new Date]);return e.feed>0&&(s="feed-age",i=IDBKeyRange.bound([e.feed,new Date(0)],[e.feed,new Date])),new Promise((r,o)=>{let u=[];l.index(s).openCursor(i,e.directionDesc?"prev":"next").onsuccess=c=>{const d=c.target.result;d?(u.push(d.value),d.continue()):r(u)}})})}async get_entry(e){return ze(this.db.transaction(["articles"]).objectStore("articles").get(e))}async mark(e,t){if(t!="READ"&&t!="REMOVED")throw new Error("Must be READ or REMOVED");return this.dbPromise.then(l=>{const s=l.transaction(["articles"],"readwrite").objectStore("articles"),i=s.get(e);return console.log(`Marking article ${e} as ${t}`),new Promise((r,o)=>{i.onsuccess=()=>{let u=i.result;u.status=Z[t];let c=s.put(u);c.onsuccess=()=>{r()}}})})}async get_entries(){return this.dbPromise.then(e=>{const l=e.transaction(["articles"]).objectStore("articles").getAll();return new Promise((s,i)=>{l.onsuccess=()=>{s(l.result)}})})}async get_feeds(){return ze(this.db.transaction(["feeds"]).objectStore("feeds").getAll())}async get_feed_categories(){let e=await this.get_feeds(),t={};for(let l of e)t[l.category.title]||(t[l.category.title]=[]),t[l.category.title].append(l);return t}async next_article(e,t){const l=await this.query(t);let s=!1;for(const i of l.entries){if(s)return i;s=i.id==e.id}return l.entries.at(-1)}async clear(){const t=(await this.dbPromise).transaction(["articles"],"readwrite").objectStore("articles");return new Promise((l,s)=>{t.clear().onsuccess=()=>{localStorage.removeItem("cache_updated"),console.log("Cache cleared")}})}async update(e){const l=(await this.dbPromise).transaction(["articles"],"readwrite").objectStore("articles");console.log("Cache updated");function s(r){let o=r[0];for(let u=1;u<r.length;u++)r[u]>o&&(o=r[u]);return o}let i=new Date;return Promise.all(e.map(r=>new Promise((o,u)=>{r.published_at=new Date(r.published_at),r.changed_at=s([new Date(r.published_at),new Date(r.changed_at),new Date(r.created_at),new Date(r.modified)]),r.updated_at=i,l.add(r).onsuccess=()=>{o()}}))).then(()=>localStorage.setItem("cache_updated",i.toISOString()))}async update_feeds(e){const l=(await this.dbPromise).transaction(["feeds"],"readwrite").objectStore("feeds");return new Promise((s,i)=>{l.clear().onsuccess=s}).then(()=>Promise.all(e.map(s=>new Promise((i,r)=>{l.add(s).onsuccess=()=>{i()}})))).then(()=>localStorage.setItem("feeds_updated",new Date().toISOString()))}get age(){return localStorage.getItem("cache_updated")==null?null:new Date(localStorage.getItem("cache_updated"))}}const I=new It("maxiflux");class qt{constructor(){m(this,"_status","unread");m(this,"_feed",0);m(this,"_desc",!0)}setDirectionDesc(){this._desc=!0}setDirectionAsc(){this._desc=!1}setStatus(e){this._status=e}setFeed(e){this._feed=e}get feed(){return this._feed}get status(){return this._status}get directionDesc(){return this._desc}}let F=new qt;function xt(n){let e,t,l,s,i,r,o;return{c(){e=f("main"),t=f("div"),l=f("button"),l.textContent="\u25B2",s=A(),i=f("button"),i.textContent="\u25BC",v(l,"class","svelte-118eg67"),v(i,"class","svelte-118eg67"),v(t,"class","svelte-118eg67")},m(u,c){b(u,e,c),a(e,t),a(t,l),a(t,s),a(t,i),r||(o=[q(l,"click",ae(n[0])),q(i,"click",ae(n[1]))],r=!0)},p:O,i:O,o:O,d(u){u&&h(e),r=!1,K(o)}}}function Ve(n="up"){let e=Math.round(window.window.visualViewport.height*.9);n=="up"?window.scroll(0,window.scrollY-e):window.scroll(0,window.scrollY+e)}function Ot(n){return[()=>Ve("up"),()=>Ve("down")]}class lt extends pe{constructor(e){super(),_e(this,e,Ot,xt,se,{})}}function Be(n,e,t){const l=n.slice();return l[12]=e[t],l}function Ge(n,e,t){const l=n.slice();return l[15]=e[t],l}function Rt(n){let e,t;function l(r,o){return st(I.age)>0?jt:Tt}let i=l()(n);return{c(){e=$("Last sync: "),i.c(),t=$(" ago |")},m(r,o){b(r,e,o),i.m(r,o),b(r,t,o)},p(r,o){i.p(r,o)},d(r){r&&h(e),i.d(r),r&&h(t)}}}function Tt(n){let e;return{c(){e=$("a moment")},m(t,l){b(t,e,l)},p:O,d(t){t&&h(e)}}}function jt(n){let e=st(I.age)+"",t,l;return{c(){t=$(e),l=$(" days")},m(s,i){b(s,t,i),b(s,l,i)},p:O,d(s){s&&h(t),s&&h(l)}}}function Fe(n){let e,t=n[0].length+"",l,s;return{c(){e=$("("),l=$(t),s=$(")")},m(i,r){b(i,e,r),b(i,l,r),b(i,s,r)},p(i,r){r&1&&t!==(t=i[0].length+"")&&H(l,t)},d(i){i&&h(e),i&&h(l),i&&h(s)}}}function Ue(n){let e,t,l,s,i,r,o,u=n[1],c=[];for(let d=0;d<u.length;d+=1)c[d]=Ye(Ge(n,u,d));return{c(){e=$(`\xA0
            `),t=f("label"),t.textContent="Feed:",l=A(),s=f("select"),i=f("option"),i.textContent="All";for(let d=0;d<c.length;d+=1)c[d].c();v(t,"for","sort"),i.__value="0",i.value=i.__value,v(s,"name","feed"),v(s,"class","svelte-1qi545v")},m(d,g){b(d,e,g),b(d,t,g),b(d,l,g),b(d,s,g),a(s,i);for(let _=0;_<c.length;_+=1)c[_].m(s,null);r||(o=q(s,"change",n[8]),r=!0)},p(d,g){if(g&2){u=d[1];let _;for(_=0;_<u.length;_+=1){const D=Ge(d,u,_);c[_]?c[_].p(D,g):(c[_]=Ye(D),c[_].c(),c[_].m(s,null))}for(;_<c.length;_+=1)c[_].d(1);c.length=u.length}},d(d){d&&h(e),d&&h(t),d&&h(l),d&&h(s),Qe(c,d),r=!1,o()}}}function Mt(n){let e,t=n[15].title+"",l,s;return{c(){e=f("option"),l=$(t),e.__value=s=n[15].id,e.value=e.__value},m(i,r){b(i,e,r),a(e,l)},p(i,r){r&2&&t!==(t=i[15].title+"")&&H(l,t),r&2&&s!==(s=i[15].id)&&(e.__value=s,e.value=e.__value)},d(i){i&&h(e)}}}function Lt(n){let e,t=n[15].title+"",l,s;return{c(){e=f("option"),l=$(t),e.__value=s=n[15].id,e.value=e.__value,e.selected=!0},m(i,r){b(i,e,r),a(e,l)},p(i,r){r&2&&t!==(t=i[15].title+"")&&H(l,t),r&2&&s!==(s=i[15].id)&&(e.__value=s,e.value=e.__value)},d(i){i&&h(e)}}}function Ye(n){let e;function t(i,r){return i[15].id==F.feed?Lt:Mt}let l=t(n),s=l(n);return{c(){s.c(),e=ft()},m(i,r){s.m(i,r),b(i,e,r)},p(i,r){l===(l=t(i))&&s?s.p(i,r):(s.d(1),s=l(i),s&&(s.c(),s.m(e.parentNode,e)))},d(i){s.d(i),i&&h(e)}}}function He(n){let e,t=n[0],l=[];for(let s=0;s<t.length;s+=1)l[s]=Je(Be(n,t,s));return{c(){e=f("ul");for(let s=0;s<l.length;s+=1)l[s].c();v(e,"class","svelte-1qi545v")},m(s,i){b(s,e,i);for(let r=0;r<l.length;r+=1)l[r].m(e,null)},p(s,i){if(i&1){t=s[0];let r;for(r=0;r<t.length;r+=1){const o=Be(s,t,r);l[r]?l[r].p(o,i):(l[r]=Je(o),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(s){s&&h(e),Qe(l,s)}}}function Ke(n){let e;return{c(){e=$("\xA0(read)")},m(t,l){b(t,e,l)},d(t){t&&h(e)}}}function Je(n){let e,t,l,s,i,r=n[12].title+"",o,u,c,d,g=n[12].feed.title+"",_,D,C,w=he(n[12].published_at)+"",x,G,E=he(n[12].changed_at)+"",L,B,R,j,k;function P(...N){return n[9](n[12],...N)}let S=n[12].status=="read"&&Ke();function U(...N){return n[10](n[12],...N)}return{c(){e=f("li"),t=f("button"),t.textContent="x",l=A(),s=f("a"),i=f("h2"),o=$(r),S&&S.c(),u=A(),c=f("em"),d=$("From "),_=$(g),D=$(" published "),C=f("date"),x=$(w),G=$(", changed: "),L=$(E),R=A(),v(t,"class","close svelte-1qi545v"),v(i,"class","svelte-1qi545v"),v(c,"class","svelte-1qi545v"),v(s,"href",B="article/"+n[12].id),v(s,"class","svelte-1qi545v"),v(e,"class","svelte-1qi545v")},m(N,z){b(N,e,z),a(e,t),a(e,l),a(e,s),a(s,i),a(i,o),S&&S.m(i,null),a(s,u),a(s,c),a(c,d),a(c,_),a(c,D),a(c,C),a(C,x),a(C,G),a(C,L),a(e,R),j||(k=[q(t,"click",P),q(s,"click",ae(U))],j=!0)},p(N,z){n=N,z&1&&r!==(r=n[12].title+"")&&H(o,r),n[12].status=="read"?S||(S=Ke(),S.c(),S.m(i,null)):S&&(S.d(1),S=null),z&1&&g!==(g=n[12].feed.title+"")&&H(_,g),z&1&&w!==(w=he(n[12].published_at)+"")&&H(x,w),z&1&&E!==(E=he(n[12].changed_at)+"")&&H(L,E),z&1&&B!==(B="article/"+n[12].id)&&v(s,"href",B)},d(N){N&&h(e),S&&S.d(),j=!1,K(k)}}}function Nt(n){let e,t,l,s,i,r,o,u,c,d,g,_,D,C,w,x,G,E,L,B,R,j,k,P,S,U,N,z,V=I.age!=null&&Rt(n);o=new lt({});let T=n[0]&&Fe(n),M=n[1]&&Ue(n),p=n[0]&&He(n);return{c(){e=f("main"),t=f("nav"),l=f("div"),V&&V.c(),s=A(),i=f("button"),i.textContent="\u{1F5D8}",r=A(),de(o.$$.fragment),u=A(),c=f("h1"),d=$("Articles"),T&&T.c(),g=A(),_=f("nav"),D=f("span"),C=f("button"),C.textContent="Read",w=$(`
            /
            `),x=f("button"),x.textContent="Unread",G=A(),E=f("span"),L=f("label"),L.textContent="Sort:",B=A(),R=f("select"),j=f("option"),j.textContent="Latest",k=f("option"),k.textContent="Oldest",P=A(),M&&M.c(),S=A(),p&&p.c(),pt(t,"justify-content","flex-end"),v(t,"class","svelte-1qi545v"),v(L,"for","sort"),j.__value="latest",j.value=j.__value,k.__value="oldest",k.value=k.__value,v(R,"name","sort"),v(R,"class","svelte-1qi545v"),v(_,"class","svelte-1qi545v")},m(y,te){b(y,e,te),a(e,t),a(t,l),V&&V.m(l,null),a(l,s),a(l,i),a(e,r),ie(o,e,null),a(e,u),a(e,c),a(c,d),T&&T.m(c,null),a(e,g),a(e,_),a(_,D),a(D,C),a(D,w),a(D,x),a(_,G),a(_,E),a(E,L),a(E,B),a(E,R),a(R,j),a(R,k),a(E,P),M&&M.m(E,null),a(e,S),p&&p.m(e,null),U=!0,N||(z=[q(i,"click",n[4]),q(C,"click",n[5]),q(x,"click",n[6]),q(R,"change",n[7])],N=!0)},p(y,[te]){I.age!=null&&V.p(y,te),y[0]?T?T.p(y,te):(T=Fe(y),T.c(),T.m(c,null)):T&&(T.d(1),T=null),y[1]?M?M.p(y,te):(M=Ue(y),M.c(),M.m(E,null)):M&&(M.d(1),M=null),y[0]?p?p.p(y,te):(p=He(y),p.c(),p.m(e,null)):p&&(p.d(1),p=null)},i(y){U||(Y(o.$$.fragment,y),U=!0)},o(y){J(o.$$.fragment,y),U=!1},d(y){y&&h(e),V&&V.d(),re(o),T&&T.d(),M&&M.d(),p&&p.d(),N=!1,K(z)}}}function st(n){return Math.round((new Date().getTime()-n.getTime())/1e3/3600/24)}function he(n){return n.toLocaleDateString("en-GB",{month:"short",day:"numeric",year:"numeric"})}function zt(n,e,t){let l=null,s=null,{force_sync:i=!1}=e;async function r(){if(!le.connected){console.log("Client not connected - redirecting to Connect"),wt("Connect",{force_sync:!0});return}F.feed==0&&(await I.update_feeds(await le.get_feeds()),t(1,s=await I.get_feeds()),await I.clear()),await le.sync(await I.get_entries());let w=await le.query(F);return I.update(w.entries)}async function o(w=!1){(I.age==null||w||i)&&(t(3,i=!1),await r()),s||t(1,s=await I.get_feeds()),t(0,l=await I.query(F))}Ie(async()=>{await I.connect(),o()});const u=()=>{o(!0)},c=w=>{F.setStatus("read"),o()},d=w=>{F.setStatus("unread"),o()},g=w=>{w.target.value=="latest"?F.setDirectionDesc():F.setDirectionAsc(),o()},_=w=>{F.setFeed(parseInt(w.target.value)),o()},D=(w,x)=>{I.mark(w.id,"REMOVED"),x.currentTarget.parentElement.remove()},C=(w,x)=>ce("Article",{id:w.id});return n.$$set=w=>{"force_sync"in w&&t(3,i=w.force_sync)},[l,s,o,i,u,c,d,g,_,D,C]}class Vt extends pe{constructor(e){super(),_e(this,e,zt,Nt,se,{force_sync:3})}}function We(n){let e,t,l,s,i,r,o,u,c,d,g=n[1].title+"",_,D,C=n[1].status+"",w,x,G,E,L=n[1].content+"",B,R,j,k,P,S,U,N,z,V,T,M;return e=new lt({}),{c(){de(e.$$.fragment),t=A(),l=f("nav"),s=f("button"),s.textContent="\u{1F519} Articles",i=A(),r=f("button"),r.textContent="\u{1F44B} Delete",o=A(),u=f("button"),u.textContent="Next \u{1F8A5}",c=A(),d=f("h1"),_=$(g),D=$(" ("),w=$(C),x=$(")"),G=A(),E=f("article"),B=A(),R=f("br"),j=A(),k=f("nav"),P=f("button"),P.textContent="\u{1F519} Articles",S=A(),U=f("button"),U.textContent="\u{1F44B} Delete",N=A(),z=f("button"),z.textContent="Next \u{1F8A5}",v(l,"class","svelte-10vigfk"),v(k,"id","nav-bottom"),v(k,"class","svelte-10vigfk")},m(p,y){ie(e,p,y),b(p,t,y),b(p,l,y),a(l,s),a(l,i),a(l,r),a(l,o),a(l,u),b(p,c,y),b(p,d,y),a(d,_),a(d,D),a(d,w),a(d,x),b(p,G,y),b(p,E,y),E.innerHTML=L,b(p,B,y),b(p,R,y),b(p,j,y),b(p,k,y),a(k,P),a(k,S),a(k,U),a(k,N),a(k,z),V=!0,T||(M=[q(s,"click",n[3]),q(r,"click",n[4]),q(u,"click",n[5]),q(P,"click",n[6]),q(U,"click",n[7]),q(z,"click",n[8])],T=!0)},p(p,y){(!V||y&2)&&g!==(g=p[1].title+"")&&H(_,g),(!V||y&2)&&C!==(C=p[1].status+"")&&H(w,C),(!V||y&2)&&L!==(L=p[1].content+"")&&(E.innerHTML=L)},i(p){V||(Y(e.$$.fragment,p),V=!0)},o(p){J(e.$$.fragment,p),V=!1},d(p){re(e,p),p&&h(t),p&&h(l),p&&h(c),p&&h(d),p&&h(G),p&&h(E),p&&h(B),p&&h(R),p&&h(j),p&&h(k),T=!1,K(M)}}}function Bt(n){let e,t,l=n[1]&&We(n);return{c(){e=f("main"),l&&l.c()},m(s,i){b(s,e,i),l&&l.m(e,null),t=!0},p(s,[i]){s[1]?l?(l.p(s,i),i&2&&Y(l,1)):(l=We(s),l.c(),Y(l,1),l.m(e,null)):l&&(et(),J(l,1,1,()=>{l=null}),tt())},i(s){t||(Y(l),t=!0)},o(s){J(l),t=!1},d(s){s&&h(e),l&&l.d()}}}function Gt(n,e,t){let{id:l}=e,s=null;async function i(){t(1,s=await I.get_entry(l))}function r(D){window.scroll(0,0),t(1,s=D)}Ie(i);const o=()=>ce("Articles"),u=()=>{I.mark(l,"REMOVED"),ce("Articles")},c=()=>{I.next_article(s,F).then(r)},d=()=>{I.mark(s.id,"READ"),ce("Articles")},g=()=>{I.mark(s.id,"REMOVED"),I.next_article(s,F).then(r)},_=()=>{I.mark(s.id,"READ"),I.next_article(s,F).then(r)};return n.$$set=D=>{"id"in D&&t(0,l=D.id)},[l,s,r,o,u,c,d,g,_]}class Ft extends pe{constructor(e){super(),_e(this,e,Gt,Bt,se,{id:0})}}function Ut(n){let e,t;return{c(){e=$("Unknown page "),t=$(n[0])},m(l,s){b(l,e,s),b(l,t,s)},p(l,s){s&1&&H(t,l[0])},i:O,o:O,d(l){l&&h(e),l&&h(t)}}}function Yt(n){let e,t;return e=new Vt({}),{c(){de(e.$$.fragment)},m(l,s){ie(e,l,s),t=!0},p:O,i(l){t||(Y(e.$$.fragment,l),t=!0)},o(l){J(e.$$.fragment,l),t=!1},d(l){re(e,l)}}}function Ht(n){let e,t;return e=new Ft({props:{id:n[1].id}}),{c(){de(e.$$.fragment)},m(l,s){ie(e,l,s),t=!0},p(l,s){const i={};s&2&&(i.id=l[1].id),e.$set(i)},i(l){t||(Y(e.$$.fragment,l),t=!0)},o(l){J(e.$$.fragment,l),t=!1},d(l){re(e,l)}}}function Kt(n){let e,t;return e=new Pt({}),{c(){de(e.$$.fragment)},m(l,s){ie(e,l,s),t=!0},p:O,i(l){t||(Y(e.$$.fragment,l),t=!0)},o(l){J(e.$$.fragment,l),t=!1},d(l){re(e,l)}}}function Jt(n){let e,t,l,s;const i=[Kt,Ht,Yt,Ut],r=[];function o(u,c){return u[0]=="Connect"?0:u[0]=="Article"?1:u[0]=="Articles"?2:3}return t=o(n),l=r[t]=i[t](n),{c(){e=f("main"),l.c()},m(u,c){b(u,e,c),r[t].m(e,null),s=!0},p(u,[c]){let d=t;t=o(u),t===d?r[t].p(u,c):(et(),J(r[d],1,1,()=>{r[d]=null}),tt(),l=r[t],l?l.p(u,c):(l=r[t]=i[t](u),l.c()),Y(l,1),l.m(e,null))},i(u){s||(Y(l),s=!0)},o(u){J(l),s=!1},d(u){u&&h(e),r[t].d()}}}function Wt(n,e,t){let l,s;return De(n,ee,i=>t(0,l=i)),De(n,Ae,i=>t(1,s=i)),ce("Articles"),[l,s]}class Zt extends pe{constructor(e){super(),_e(this,e,Wt,Jt,se,{})}}new Zt({target:document.getElementById("app")});
